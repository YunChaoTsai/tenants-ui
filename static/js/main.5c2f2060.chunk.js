(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{142:function(e,t){},143:function(e,t){},144:function(e,t){},145:function(e,t){},154:function(e,t,a){e.exports=a(323)},318:function(e,t,a){},319:function(e,t,a){},320:function(e,t,a){},321:function(e,t,a){},322:function(e,t,a){},323:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"key",function(){return U}),a.d(n,"AuthUserStatus",function(){return j}),a.d(n,"actions",function(){return B}),a.d(n,"reducer",function(){return Q}),a.d(n,"selectors",function(){return G});var r={};a.r(r),a.d(r,"key",function(){return Et}),a.d(r,"actions",function(){return bt}),a.d(r,"reducer",function(){return gt}),a.d(r,"selectors",function(){return vt});var c={};a.r(c),a.d(c,"key",function(){return Bt}),a.d(c,"actions",function(){return Gt}),a.d(c,"reducer",function(){return Wt}),a.d(c,"selectors",function(){return Kt});var l={};a.r(l),a.d(l,"key",function(){return Ea}),a.d(l,"actions",function(){return ha}),a.d(l,"reducer",function(){return ba}),a.d(l,"selectors",function(){return ga});var i={};a.r(i),a.d(i,"key",function(){return Na}),a.d(i,"actions",function(){return Pa}),a.d(i,"reducer",function(){return qa}),a.d(i,"selectors",function(){return Fa});var u={};a.r(u),a.d(u,"key",function(){return Ha}),a.d(u,"actions",function(){return Ua}),a.d(u,"reducer",function(){return Va}),a.d(u,"selectors",function(){return Ba});var o={};a.r(o),a.d(o,"key",function(){return tn}),a.d(o,"actions",function(){return nn}),a.d(o,"reducer",function(){return rn}),a.d(o,"selectors",function(){return cn});var s={};a.r(s),a.d(s,"key",function(){return Dn}),a.d(s,"actions",function(){return Mn}),a.d(s,"reducer",function(){return Rn}),a.d(s,"selectors",function(){return Hn});var m={};a.r(m),a.d(m,"key",function(){return er}),a.d(m,"actions",function(){return ar}),a.d(m,"reducer",function(){return nr}),a.d(m,"selectors",function(){return rr});var d={};a.r(d),a.d(d,"key",function(){return _r}),a.d(d,"actions",function(){return Sr}),a.d(d,"reducer",function(){return jr}),a.d(d,"selectors",function(){return Or});var f={};a.r(f),a.d(f,"key",function(){return Ir}),a.d(f,"actions",function(){return Yr}),a.d(f,"reducer",function(){return Mr}),a.d(f,"selectors",function(){return Rr});var p={};a.r(p),a.d(p,"key",function(){return Zr}),a.d(p,"actions",function(){return tc}),a.d(p,"reducer",function(){return ac}),a.d(p,"selectors",function(){return nc});var E={};a.r(E),a.d(E,"key",function(){return rc}),a.d(E,"actions",function(){return lc}),a.d(E,"reducer",function(){return ic}),a.d(E,"selectors",function(){return uc});var h={};a.r(h),a.d(h,"key",function(){return xc}),a.d(h,"actions",function(){return Nc}),a.d(h,"reducer",function(){return kc}),a.d(h,"selectors",function(){return Pc});var b={};a.r(b),a.d(b,"key",function(){return Jc}),a.d(b,"actions",function(){return Xc}),a.d(b,"reducer",function(){return Zc}),a.d(b,"selectors",function(){return el});var g={};a.r(g),a.d(g,"key",function(){return ol}),a.d(g,"actions",function(){return ml}),a.d(g,"reducer",function(){return dl}),a.d(g,"selectors",function(){return fl});var v={};a.r(v),a.d(v,"key",function(){return ui}),a.d(v,"actions",function(){return si}),a.d(v,"reducer",function(){return mi}),a.d(v,"selectors",function(){return di});var _={};a.r(_),a.d(_,"key",function(){return xi}),a.d(_,"actions",function(){return Ni}),a.d(_,"reducer",function(){return ki}),a.d(_,"selectors",function(){return Pi});var y={};a.r(y),a.d(y,"key",function(){return Vi}),a.d(y,"actions",function(){return Qi}),a.d(y,"reducer",function(){return Gi}),a.d(y,"selectors",function(){return Wi});var S={};a.r(S),a.d(S,"key",function(){return ou}),a.d(S,"actions",function(){return mu}),a.d(S,"reducer",function(){return du}),a.d(S,"selectors",function(){return fu});var j,O=a(16),w=a(0),T=a.n(w),x=a(43),C=a.n(x),N=a(13),k=a(23),P=a(10),q=a.n(P),F=a(5),A=a(1),I=(a(170),a(2)),D=a.n(I),Y=a(7),M=a(6),R=a(4),H=a(3),L=a(12),U="AUTHENTICATED_USER_STATE";!function(e){e.DEFAULT="DEFAULT",e.CHECKING="CHECKING",e.UN_AUTHENTICATED="UN_AUTHENTICATED",e.AUTHENTICATING="AUTHENTICATING",e.AUTHENTICATED="AUTHENTICATED"}(j||(j={}));var V={data:void 0,status:j.DEFAULT},B={checkAuth:Object(L.createAsyncAction)("@AUTH/CHECK_AUTH_REQUEST","@AUTH/CHECK_AUTH_SUCCESS","@AUTH/CHECK_AUTH_FAILED")(),login:Object(L.createAsyncAction)("@AUTH/LOGIN_REQUEST","@AUTH/LOGIN_SUCCESS","@AUTH/LOGIN_FAILED")(),logout:Object(L.createAsyncAction)("@AUTH/LOGOUT_REQUEST","@AUTH/LOGOUT_SUCCESS","@AUTH/LOGOUT_FAILED")()};function Q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(L.getType)(B.checkAuth.request):return Object(H.a)({},e,{status:j.CHECKING});case Object(L.getType)(B.login.request):return Object(H.a)({},e,{status:j.AUTHENTICATING});case Object(L.getType)(B.checkAuth.success):case Object(L.getType)(B.login.success):return Object(H.a)({},e,{status:j.AUTHENTICATED,data:t.payload});case Object(L.getType)(B.checkAuth.failure):case Object(L.getType)(B.login.failure):return Object(H.a)({},e,{status:j.UN_AUTHENTICATED});case Object(L.getType)(B.logout.success):return Object(H.a)({},e,{status:j.UN_AUTHENTICATED,data:void 0});default:return e}}function G(e){return{get state(){return e[U]},get user(){return this.state.data},get status(){return this.state.status},get noRequestYet(){return this.status===j.DEFAULT},get isAuthenticated(){return this.status===j.AUTHENTICATED},get isAuthenticating(){return this.status===j.AUTHENTICATING||this.status===j.CHECKING},get wait(){return this.isAuthenticating||this.noRequestYet}}}var W=a(88),K=a.n(W);function z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"?",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return K.a.parse(e,Object(H.a)({ignoreQueryPrefix:!0},t))}function J(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return K.a.stringify(e,Object(H.a)({addQueryPrefix:!0},t))}function $(e,t){return function(a){function n(n){return T.a.createElement(e.Consumer,null,function(e){var r=Object(H.a)(Object(O.a)({},t,e),n);return T.a.createElement(a,r)})}n.WrappedComponent=a;var r=a.displayName||a.name||"Component",c=e.Consumer.name||"Context.Consumer";return n.displayName=r+"("+c+"."+t+")",n}}function X(e){if(null===e||void 0===e)return"";var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function Z(){return Object(N.b)()}function ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Please enter a valid number";return R.number().transform(function(e,t){return this.isType(e)?e:t&&t.trim()?t:null}).nullable(!0).typeError(e)}function te(e){return{getUser:function(){var t=Object(Y.a)(D.a.mark(function t(){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/me").then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}}var ae=function(){return function(){var e=Object(Y.a)(D.a.mark(function e(t,a,n){var r;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.xhr,t(B.checkAuth.request()),e.abrupt("return",te(r).getUser().then(function(e){return t(B.checkAuth.success(e)),e}).catch(function(e){return t(B.checkAuth.failure(e)),Promise.reject(e)}));case 3:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}()};function ne(){var e=Z();return Object(w.useCallback)(function(){return e(ae())},[e])}function re(){return Object(H.a)({},Object(N.c)(function(e){var t=G(e);return{user:t.user,wait:t.wait,isAuthenticating:t.isAuthenticating,isAuthenticated:t.isAuthenticated}}),{fetchUser:ne()})}function ce(e){var t=e.children,a=void 0===t?null:t,n=re(),r=n.wait,c=n.user;return r?null:c?T.a.createElement(w.Fragment,null,a):T.a.createElement(F.b,null,function(e){var t=e.location;return T.a.createElement(F.d,{to:"/login?next=".concat(t.pathname),noThrow:!0})})}function le(e){var t=e.children,a=void 0===t?null:t,n=e.to,r=void 0===n?"/":n,c=re(),l=c.wait,i=c.user;return l?null:i?T.a.createElement(F.d,{to:r,noThrow:!0}):T.a.createElement(w.Fragment,null,a)}var ie=a(11),ue=a(14),oe=a.n(ue);function se(e){var t=e.className,a=void 0===t?"":t,n=Object(ie.a)(e,["className"]);return T.a.createElement(M.a,Object.assign({component:A.g,className:"".concat(a)},n))}function me(e){var t=e.as,a=void 0===t?"input":t,n=e.id,r=e.name,c=e.className,l=Object(ie.a)(e,["as","id","name","className"]);return T.a.createElement(a,Object.assign({className:oe()("input",c),name:r,id:n||r},l))}function de(e){var t=e.name,a=e.render,n=e.children,r=(e.ref,Object(ie.a)(e,["name","render","children","ref"]));return T.a.createElement(M.b,{name:t,render:function(e){var t=e.field.name,c=e.form,l=c.touched,i=c.errors,u=Object(M.g)(l,t),o=Object(M.g)(i,t);return T.a.createElement(A.h,Object.assign({hasError:!(!u||!o),"aria-errormessage":o},r),n||a(e),T.a.createElement(se,{name:t}))}})}function fe(e){var t=e.label,a=e.name,n=e.type,r=void 0===n?"text":n,c=e.className,l=e.labelPlacement,i=e.noGroup,u=Object(ie.a)(e,["label","name","type","className","labelPlacement","noGroup"]);l=l||("checkbox"===r||"radio"===r?"after":"before");var o=t?T.a.createElement("label",{htmlFor:a},t):null;function s(e){var t=e.field;return T.a.createElement(w.Fragment,null,"before"===l?o:null,T.a.createElement(me,Object.assign({type:r},t,u)),"after"===l?o:null)}return i?T.a.createElement(M.b,{name:a,render:s}):T.a.createElement(de,{name:a,className:c,render:s})}var pe=Object(M.f)(function(e){var t=e.onChange,a=e.formik,n=e.debounce,r=void 0===n?300:n,c=a.values,l=Object(w.useRef)(-1);return Object(w.useEffect)(function(){if("undefined"!==typeof window)return l.current=window.setTimeout(function(){t(a)},r),function(){l.current&&window.clearTimeout(l.current)}},[c]),null}),Ee={publicUrl:"",appEnv:"production",appUrl:Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_SERVER_BASE:"https://testadminapi.tourepedia.com",REACT_APP_PUSHER_APP_KEY:"42270f95b41435aa79e3",REACT_APP_API_BASE_URL:"https://testadminapi.tourepedia.com/api",REACT_APP_PUSHER_APP_CLUSTER:"ap2",REACT_APP_APPLICATION_NAME:"Tourepedia Admin Dashboard",REACT_APP_VERSION:"1.14.0"}).APP_URL,appVersion:"1.14.0",appName:"Tourepedia Admin Dashboard",serverBase:"https://testadminapi.tourepedia.com",apiBaseUrl:"https://testadminapi.tourepedia.com/api",pusher:{key:"42270f95b41435aa79e3",cluster:"ap2",authEndpoint:"https://testadminapi.tourepedia.com/broadcasting/auth"}},he=R.object().shape({email:R.string().email("Invalid email address").required("Email field is required"),password:R.string().required("Password field is required")}),be={email:"",password:""};function ge(e){return{login:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/login",a).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),refresh:function(){var t=Object(Y.a)(D.a.mark(function t(){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.patch("/refresh").then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}}var ve=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,B.login.request(),t.abrupt("return",ge(c).login(e).then(function(){return a(ae())}).catch(function(e){return B.login.failure(e),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function _e(e){var t=e.location,a=z(t&&t.search),n=a.next;be.email=a.email||"";var r=function(){var e=Z();return Object(w.useCallback)(function(t){return e(ve(t))},[e])}();return T.a.createElement(le,{to:n},T.a.createElement(q.a,null,T.a.createElement("title",null,"Sign in to TAD")),T.a.createElement("div",{className:"min-h-screen"},T.a.createElement("div",{className:"text-center"},T.a.createElement("img",{src:Ee.publicUrl+"/logo.png",className:"inline-block mt-16 w-20 rounded-full shadow"})),T.a.createElement("h1",{className:"text-center my-4"},"Sign in to TAD"),T.a.createElement("div",{className:"max-w-sm mx-auto"},T.a.createElement(M.e,{initialValues:be,onSubmit:function(e,t){t.setStatus(),r(e).catch(function(e){t.setStatus(e.message),t.setSubmitting(!1)})},validationSchema:he,render:function(e){var t=e.isSubmitting,a=e.status;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,a?T.a.createElement("p",{className:"text-red-700",role:"alert"},a):null,T.a.createElement(fe,{label:"Email",name:"email",type:"email",autoFocus:!be.email,id:"email",placeholder:"username@domain.com",autoComplete:"username email",required:!0,tabIndex:1}),T.a.createElement(F.a,{to:"/forgot-password",className:"float-right text-blue-600 hover:text-blue-800 text-sm"},"Forgot Password ?"),T.a.createElement(fe,{label:"Password",name:"password",type:"password",id:"password",required:!0,autoComplete:"current-password",autoFocus:!!be.email,tabIndex:2}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,tabIndex:3,type:"submit",className:"w-full",disabled:t},"Sign in"))))}}))))}function ye(e){return{logout:function(){var t=Object(Y.a)(D.a.mark(function t(){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.delete("/logout").then(function(e){return localStorage.removeItem("access_token"),e}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}}var Se=function(){return function(){var e=Object(Y.a)(D.a.mark(function e(t,a,n){var r;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.xhr,e.abrupt("return",ye(r).logout().then(function(){t(B.logout.success())}));case 2:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}()};var je=function(e){var t=e.navigate,a=e.location,n=z(a&&a.search).from,r=function(){var e=Z();return Object(w.useCallback)(function(){return e(Se())},[e])}();return Object(w.useEffect)(function(){r().then(function(){t&&t(n||"/")})},[]),T.a.createElement("div",null,"Logging out")},Oe=a(44),we=a.n(Oe);function Te(){return localStorage.getItem("access_token")}we.a.defaults.baseURL=Ee.apiBaseUrl,we.a.interceptors.request.use(Object(k.compose)(function(e){return e.headers.Authorization="Bearer ".concat(Te()),e},function(e){var t=e.data,a=e.params;return"multipart/form-data"!==e.headers["Content-Type"]&&(e.headers["Content-Type"]="application/x-www-form-urlencoded"),t instanceof FormData?e:(e.data=J(t,{addQueryPrefix:!1}),e.url=e.url+J(a),e.params=void 0,e)},function(e){var t=(e.method||"").toUpperCase(),a=e.data||{};switch(t){case"DELETE":case"PATCH":case"PUT":a instanceof FormData?a.append("_method",t):a._method=t,e.method="POST"}return e.data=a,e})),we.a.interceptors.response.use(Object(k.compose)(function(e){var t,a=e.data;return a.access_token&&(t=a.access_token,localStorage.setItem("access_token",t)),e}),Object(k.compose)(function(e){var t=e.response&&e.response.data;if(!t)return Promise.reject(e);if(t.errors){var a=Object.keys(t.errors).reduce(function(e,a){return e[a]=t.errors[a].join(", "),e},{});t.formikErrors=a}return Promise.reject(t)},function(e){var t=e.response;if(t){var a=t.data&&t.data;if(503===a.status_code){if(t.headers&&t.headers["retry-after"]){var n=t.headers["retry-after"];setTimeout(function(){window.location=window.location},1e3*parseInt(n))}alert(a.message)}}return e},function(e){var t=e.response;if(t){var a=t.data&&t.data;if(429===a.status_code){if(t.headers&&t.headers["retry-after"]){var n=t.headers["retry-after"];setTimeout(function(){window.location=window.location},1e3*parseInt(n))}alert(a.message)}}return e}));var xe=T.a.createContext(we.a),Ce=$(xe,"xhr");var Ne=we.a,ke=R.object().shape({name:R.string().required("Name field is required").max(191,"Max 191 Characters allowed"),email:R.string().email("Please provide a valid email address").required("Name field is required"),password:R.string().required("Password field is required"),password_confirmation:R.string().required("Password Confirmation field is required")}),Pe={name:"",email:"",password:"",password_confirmation:"",invite_token:""};var qe=Ce(function(e){var t=e.location,a=e.xhr,n=e.navigate,r=z(t&&t.search),c=r.ref||"",l=r.email||"",i=r.name||"";return Pe.invite_token=c,Pe.email=l,Pe.name=i,T.a.createElement(le,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Invited on TAD")),T.a.createElement("div",null,T.a.createElement("div",{className:"text-center"},T.a.createElement(F.a,{to:"/"},T.a.createElement("img",{src:Ee.publicUrl+"/logo.png",className:"inline-block mt-4 w-20 rounded-full shadow"}))),T.a.createElement("h1",{className:"text-center my-4"},"Complete Signup for TAD"),T.a.createElement("div",{className:"max-w-sm mx-auto"},T.a.createElement(M.e,{initialValues:Pe,validationSchema:ke,onSubmit:function(e,t){t.setStatus(),function(e){return{signup:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.patch("/invited-users",a).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}(a).signup(e).then(function(t){alert(t.message||"Registered Successfully. You can now login."),n&&n("../login?email=".concat(e.email))}).catch(function(e){t.setStatus(e.message),e.formikErrors&&t.setErrors(e.formikErrors),t.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status,n=e.values;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,a?T.a.createElement("p",{className:"text-red-700",role:"alert"},a):null,T.a.createElement(fe,{label:"Name",name:"name",autoFocus:!0,placeholder:"John Ana",autoComplete:"full-name",required:!0}),T.a.createElement(fe,{label:"Email",name:"email",type:"email",placeholder:"username@domain.com",autoComplete:"username email",readOnly:!0,required:!0}),T.a.createElement(fe,{label:"Password",type:"password",name:"password",autoComplete:"new-password",required:!0}),T.a.createElement(fe,{label:"Retype Password",type:"password",name:"password_confirmation",autoComplete:"new-password",required:!0}),T.a.createElement("input",{hidden:!0,type:"hidden",name:"invite_token",value:n.invite_token}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,tabIndex:3,type:"submit",className:"w-full",disabled:t},"Complete Signup"))))}}))))}),Fe=R.object().shape({company_name:R.string().required(" field is required").max(191,"Max 191 Characters allowed"),name:R.string().required("Name field is required").max(191,"Max 191 Characters allowed"),email:R.string().email("Please provide a valid email address").required("Email address is required").max(191,"Max 191 Characters allowed"),password:R.string().required("Password field is required"),password_confirmation:R.string().required("Password Confirmation field is required")}),Ae={company_name:"",name:"",email:"",password:"",password_confirmation:"",invite_token:"",address_email:"",email_verified_url:""};var Ie=Ce(function(e){var t=e.location,a=e.xhr,n=e.navigate,r=z(t&&t.search),c=r.ref||"",l=r.email||"",i=r.name||"",u=r["tenant-name"]||"";return Ae.company_name=u,Ae.invite_token=c,Ae.name=i,Ae.email=l,Ae.address_email=l,Ae.email_verified_url=t?"".concat(t.origin,"/email-verified"):"",T.a.createElement(le,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Invited on TAD")),T.a.createElement("div",null,T.a.createElement("h1",{className:"flex justify-center items-center mt-4"},T.a.createElement(F.a,{to:"/"},T.a.createElement("img",{src:Ee.publicUrl+"/logo.png",className:"inline-blockw-20 w-8 rounded-full shadow"})),T.a.createElement("div",{className:"px-4 text-gray-400"},"+"),T.a.createElement("div",null,u)),T.a.createElement("p",{className:"text-center max-w-sm mx-auto text-sm text-gray-700"},"Please provide following details to complete your registraion for Tourepedia Admin Dashboard"),T.a.createElement("div",{className:"max-w-sm mx-auto"},T.a.createElement(M.e,{initialValues:Ae,onSubmit:function(e,t){t.setStatus(),function(e){return{signup:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/tenants/signup",a).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}(a).signup(e).then(function(t){alert(t.message||"Registered Successfully. You can now login."),n&&n("../login?email=".concat(e.email))}).catch(function(e){t.setStatus(e.message),e.formikErrors&&t.setErrors(e.formikErrors),t.setSubmitting(!1)})},validationSchema:Fe,render:function(e){var t=e.isSubmitting,a=e.status,n=e.values;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,a?T.a.createElement("p",{className:"text-red-700",role:"alert"},a):null,T.a.createElement(fe,{label:"Company Name",name:"company_name",placeholder:"Tourepedia Holidays",required:!0}),T.a.createElement(fe,{label:"Your Name",name:"name",placeholder:"John Ana",autoComplete:"full-name",required:!0}),T.a.createElement(fe,{label:"Email",name:"email",type:"email",placeholder:"username@domain.com",autoComplete:"username email",required:!0}),T.a.createElement(fe,{label:"Password",type:"password",name:"password",autoComplete:"new-password",required:!0}),T.a.createElement(fe,{label:"Retype Password",type:"password",name:"password_confirmation",autoComplete:"new-password",required:!0}),T.a.createElement("input",{hidden:!0,type:"hidden",name:"invite_token",value:n.invite_token}),T.a.createElement("input",{hidden:!0,type:"hidden",name:"address_email",value:n.address_email}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,tabIndex:3,type:"submit",className:"w-full",disabled:t},"Complete Registration"))))}}))))}),De="manage_roles",Ye="manage_tenants",Me="manage_trip_owners",Re="manage_trip_plan_requests",He="manage_users",Le="view_trip_plan_requests";function Ue(){var e=re().user,t=Object(w.useMemo)(function(){return e?e.permissions.reduce(function(e,t){return e[t]=t,e},{}):{}},[e]);return{hasPermission:function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];return"string"===typeof a&&(a=[a]),a.every(function(e){return t[e]})},hasAnyPermission:function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];return a.some(function(e){return t[e]})}}}function Ve(e){var t=e.to,a=e.children,n=e.className,r=void 0===n?"":n;return T.a.createElement(F.c,{path:t},function(e){var n=e.match;return T.a.createElement("li",{className:oe()(r,n?"active":void 0)},T.a.createElement(F.a,{to:t},a))})}var Be=Ve,Qe=a(9),Ge=a(8),We=a.n(Ge);function Ke(e){return{getConvertedTripAnalytics:function(){var t=Object(Y.a)(D.a.mark(function t(){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/converted-trips").then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),getDuePayments:function(){var t=Object(Y.a)(D.a.mark(function t(){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/instalments").then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),getTransactions:function(){var t=Object(Y.a)(D.a.mark(function t(){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/payment-transactions").then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}}function ze(e){var t=e.xhr,a=Object(w.useState)([]),n=Object(Qe.a)(a,2),r=n[0],c=n[1];return Object(w.useEffect)(function(){Ke(t).getConvertedTripAnalytics().then(c)},[]),T.a.createElement("section",null,T.a.createElement("h2",null,"Converted trips over time"),T.a.createElement(A.m,{responsive:!0,bordered:!0,striped:!0,headers:["ID","Dates","Stages","Destinations","Traveler","Pax"],rows:r.map(function(e){var t=e.id,a=e.trip_source,n=e.trip_id,r=e.start_date,c=e.end_date,l=e.locations,i=e.no_of_adults,u=e.children,o=e.contact,s=e.latest_stage;return[T.a.createElement(F.a,{to:"/trips/"+t.toString()},a.short_name,"-",n||t),"".concat(We.a.utc(r).local().format("DD/MM/YYYY")," to ").concat(We.a.utc(c).local().format("DD/MM/YYYY")),s?s.name:"Initiated",l.map(function(e){return e.short_name}).join(" \u2022\xa0"),o?T.a.createElement("div",null,o.name,T.a.createElement("br",null),T.a.createElement("a",{href:"tel:".concat(o.phone_number),className:"btn--icon"},T.a.createElement(A.i.PhoneIcon,{title:"Call to ".concat(o.name," on ").concat(o.phone_number)})),T.a.createElement("a",{href:"mailto:".concat(o.email),className:"btn--icon"},T.a.createElement(A.i.MailIcon,{title:"Send Email to ".concat(o.name," at ").concat(o.email)}))):null,"".concat(i," Adults").concat(u?" with "+u:"")]})}))}function Je(e){var t=e.xhr,a=Object(w.useState)([]),n=Object(Qe.a)(a,2),r=n[0],c=n[1];return Object(w.useEffect)(function(){Ke(t).getDuePayments().then(c)},[]),T.a.createElement("section",null,T.a.createElement("h2",null,"Due payments"),T.a.createElement(A.m,{bordered:!0,responsive:!0},T.a.createElement("thead",null,T.a.createElement("tr",null,T.a.createElement("th",null,"Due Date"),r.map(function(e,t){return T.a.createElement("th",{key:t},We.a.utc(e.due_date).local().format("DD/MM/YYYY"))}))),T.a.createElement("tbody",null,T.a.createElement("tr",null,T.a.createElement("th",null,"Amount"),r.map(function(e,t){return T.a.createElement("td",{key:t},e.is_credit?"+":"-",e.due_amount)})))))}function $e(e){var t=e.xhr,a=Object(w.useState)({data:[],debited:0,credited:0}),n=Object(Qe.a)(a,2),r=n[0],c=n[1];return Object(w.useEffect)(function(){Ke(t).getTransactions().then(function(e){var t=e.data,a=e.meta;return c(Object(H.a)({data:t},a))})},[]),T.a.createElement("section",null,T.a.createElement("h2",null,"Transactions"),T.a.createElement("div",null,"Credited: ",r.credited," \u2022 Debited: ",r.debited),T.a.createElement(A.m,{responsive:!0,bordered:!0},T.a.createElement("thead",null,T.a.createElement("tr",null,T.a.createElement("th",null,"Date"),r.data.map(function(e,t){return T.a.createElement("th",{key:t},We.a.utc(e.date).local().format("DD/MM/YYYY"))}))),T.a.createElement("tbody",null,T.a.createElement("tr",null,T.a.createElement("th",null,"Amount"),r.data.map(function(e,t){return T.a.createElement("td",{key:t},e.is_credited?"+":"-",e.amount)})))))}var Xe=Ce(function(e){var t=e.xhr;return T.a.createElement(ce,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Dashboard")),T.a.createElement(ze,{xhr:t}),T.a.createElement(Je,{xhr:t}),T.a.createElement($e,{xhr:t}))});function Ze(e){return T.a.createElement("div",null,T.a.createElement("h2",null,"Not Found"),T.a.createElement(F.a,{to:"/"},"Visit Dashboard"))}var et=R.object().shape({current:R.string().required("Current password field is required"),password:R.string().required("Password field is required"),password_confirmation:R.string().required("Password confirmation field is required")});var tt={current:"",password:"",password_confirmation:""};var at=Ce(function(e){var t=e.xhr,a=e.navigate,n=re().user;return T.a.createElement(ce,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Change Password")),T.a.createElement(M.e,{initialValues:tt,validationSchema:et,onSubmit:function(e,n){n.setStatus(),function(e){return{changePassword:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.patch("/passwords",a));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}(t).changePassword(e).then(function(){alert("Password updated successfully"),a&&a("/")}).catch(function(e){e.formikErrors&&n.setErrors(e.formikErrors),n.setStatus(e.message),n.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Change Password"),n?T.a.createElement("input",{type:"email",name:"email",value:n.email,hidden:!0,readOnly:!0,autoComplete:"username"}):null,T.a.createElement(fe,{label:"Current Password",name:"current",type:"password",required:!0,id:"current",autoComplete:"current-password"}),T.a.createElement(fe,{name:"password",label:"New Password",type:"password",required:!0,id:"password",autoComplete:"new-password"}),T.a.createElement(fe,{label:"Confirm new password",name:"password_confirmation",type:"password",required:!0,id:"password_confirmation",autoComplete:"new-password"}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Update"))))}}))});a(318);function nt(e){var t=e.fluid,a=e.className,n=e.as,r=void 0===n?"div":n,c=Object(ie.a)(e,["fluid","className","as"]);return T.a.createElement(r,Object.assign({className:"container".concat(t?"-fluid":""," ").concat(a||"")},c))}function rt(e){var t=e.className,a=e.noGutters,n=e.as,r=void 0===n?"div":n,c=Object(ie.a)(e,["className","noGutters","as"]);return T.a.createElement(r,Object.assign({className:"row ".concat(a?"no-gutters":""," ").concat(t||"")},c))}function ct(e){var t=e.className,a=e.xs,n=e.sm,r=e.md,c=e.lg,l=e.xl,i=e.as,u=void 0===i?"div":i,o=Object(ie.a)(e,["className","xs","sm","md","lg","xl","as"]),s=[],m=[];return[["xs",a],["sm",n],["md",r],["lg",c],["xl",l]].forEach(function(e){var t,a,n,r=Object(Qe.a)(e,2),c=r[0],l=r[1];null!==l&&"object"===typeof l?(t=l.span,a=l.offset,n=l.order):t=l;var i="xs"!==c?"-".concat(c):"";null!=t&&m.push(!0===t?"".concat("col").concat(i):"".concat("col").concat(i,"-").concat(t)),null!=n&&s.push("order".concat(i,"-").concat(n)),null!=a&&s.push("offset".concat(i,"-").concat(a))}),m.length||m.push("col"),T.a.createElement(u,Object.assign({className:oe.a.apply(void 0,[t].concat(s,m))},o))}var lt=function(e){return T.a.createElement(ce,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Settings")),T.a.createElement("h2",null,"Settings"),T.a.createElement(nt,{fluid:!0},T.a.createElement(rt,null,T.a.createElement(ct,{as:"fieldset",sm:2},T.a.createElement("ul",{className:"list"},T.a.createElement("li",null,T.a.createElement(F.a,{to:"change-password"},"Change Password")))),T.a.createElement(ct,{className:"col-sm"},T.a.createElement(F.e,null,T.a.createElement(at,{path:"change-password"}),T.a.createElement(at,{path:"/"}))))))},it=R.object().shape({email:R.string().email("Invalid email address").required("Email field is required")});var ut=Ce(function(e){var t=e.xhr,a=e.navigate,n=e.location,r=z(n&&n.search).email||"";return T.a.createElement(le,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Forgot Password")),T.a.createElement("div",{className:"text-center mt-16"},T.a.createElement("h1",null,"Forgot Your Password?"),T.a.createElement("p",null,"No problem. Just enter your email address and we will send instructions to reset your password. ",T.a.createElement("br",null),"Or"," ",T.a.createElement(F.a,{to:"/login",className:"text-blue-600 hover:text-blue-800"},"Login")," ","if you remember your password!")),T.a.createElement("div",{className:"max-w-sm mx-auto"},T.a.createElement(M.e,{initialValues:{email:r,reset_password_link:"".concat(n&&n.origin,"/reset-password")},validationSchema:it,onSubmit:function(e,n){n.setStatus(),function(e){return{forgotPassword:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/passwords/reset",a));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}(t).forgotPassword(e).then(function(){alert("Please check your inbox for password reset instructions."),n.setSubmitting(!1),a&&a("/login")}).catch(function(e){n.setStatus(e.message),n.setSubmitting(!1)})},render:function(e){var t=e.status,a=e.isSubmitting,n=e.values;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,t?T.a.createElement("p",{role:"alert",className:"text-red-700"},t):null,T.a.createElement(fe,{name:"email",label:"Email",placeholder:"username@domain.com",autoComplete:"username email",required:!0,autoFocus:!0,type:"email",id:"email",tabIndex:1}),T.a.createElement("input",{type:"hidden",name:"reset_password_link",hidden:!0,value:n.reset_password_link}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,tabIndex:2,type:"submit",disabled:a},"Get Instructions"))))}})))}),ot=R.object().shape({email:R.string().required("Email field is required").email("Invalid email address"),token:R.string().required("Missing token to reset values. Please check for valid url from sent email"),password:R.string().required("Password field is required"),password_confirmation:R.string().required("Password confirmation field is required")});var st=Ce(function(e){var t=e.navigate,a=e.location,n=e.xhr,r=z(a&&a.search),c=r.email,l=r.token;return c&&l||t&&t("/"),T.a.createElement("div",null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Reset Password")),T.a.createElement("div",{className:"text-center mt-16"},T.a.createElement("h1",null,"Reset Password"),T.a.createElement("p",null,"Just enter your new password to reset the password for your email address (",c,")")),T.a.createElement("div",{className:"max-w-sm mx-auto"},T.a.createElement(M.e,{initialValues:{email:c,token:l,password:"",password_confirmation:""},validationSchema:ot,onSubmit:function(e,a){a.setStatus(),function(e){return{resetPassword:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.delete("/passwords/reset",{data:a}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}(n).resetPassword(e).then(function(){alert("Your passwords updated successfully. You can now log in with the new password"),t&&t("/login")}).catch(function(e){e.formikErrors&&a.setErrors(e.formikErrors),a.setStatus(e.message),a.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,a?T.a.createElement("p",{className:"text-red-700",role:"alert"},a):null,T.a.createElement(M.b,{name:"email",render:function(e){var t=e.field,a=t.value,n=t.name;return T.a.createElement("input",{type:"hidden",hidden:!0,name:n,value:a})}}),T.a.createElement(M.b,{name:"token",render:function(e){var t=e.field,a=t.value,n=t.name;return T.a.createElement("input",{type:"hidden",value:a,name:n})}}),T.a.createElement(fe,{label:"Password",name:"password",type:"password",id:"password",autoFocus:!0,autoComplete:"new-password",required:!0}),T.a.createElement(fe,{label:"Confirm Password",name:"password_confirmation",type:"password",id:"password_confirmation",autoComplete:"new-password",required:!0}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Reset Password"))))}}),T.a.createElement("div",{className:"text-center"},"Get instructions"," ",T.a.createElement(F.a,{to:"/forgot-password?email=".concat(c),className:"text-blue-600 hover:text-blue-800"},"again")," ",T.a.createElement("br",null),"OR",T.a.createElement("br",null),T.a.createElement(F.a,{to:"/login",className:"text-blue-600 hover:text-blue-800"},"Login")," ","if you remember your password!")))}),mt=a(153);function dt(e){return ft({items:[],byId:{},meta:{from:0,to:0,total:0,current_page:1,last_page:1},links:{}}).insert(e)}function ft(e){var t=e||dt();return{insert:function(e,a){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e?e.reduce(function(e,t){var r=e.byId,c=e.items,l=e.meta;return r[t.id]||(c=n?[t.id].concat(c):c.concat(t.id)),r[t.id]=t,Object(H.a)({},e,{byId:Object(H.a)({},r),items:Object(mt.a)(c),meta:Object(H.a)({},l,a||{})})},t):t},get:function(){return t.items.map(function(e){return t.byId[e]})},getItem:function(e){if(e)return t.byId[e]},getMeta:function(){return t.meta},get total(){return this.getMeta().total||0},get currentPage(){return this.getMeta().current_page||1},get lastPage(){return this.getMeta().last_page||1},get from(){return this.getMeta().from||0},get to(){return this.getMeta().to||0},get meta(){return{total:this.total,lastPage:this.lastPage,currentPage:this.currentPage,from:this.from,to:this.to}}}}function pt(e,t,a){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,r=arguments.length>1?arguments[1]:void 0;if(t.list)switch(r.type){case Object(L.getType)(t.list.request):return Object(H.a)({},n,{isFetching:!0});case Object(L.getType)(t.list.success):return Object(H.a)({},n,{state:ft(dt()).insert(r.payload.data,r.payload.meta),isFetching:!1});case Object(L.getType)(t.list.failure):return Object(H.a)({},n,{isFetching:!1})}if(t.item)switch(r.type){case Object(L.getType)(t.item.request):return Object(H.a)({},n,{isFetching:!0});case Object(L.getType)(t.item.success):return Object(H.a)({},n,{state:ft(n.state).insert([r.payload]),isFetching:!1});case Object(L.getType)(t.item.failure):return Object(H.a)({},n,{isFetching:!1})}return a?a(n,r):n}}var Et="USER_LIST_STATE",ht={isFetching:!0,state:dt()},bt={list:Object(L.createAsyncAction)("@USERS/LIST_FETCH_REQUEST","@USERS/LIST_FETCH_SUCCESS","@USERS/LIST_FETCH_FAILED")(),item:Object(L.createAsyncAction)("@USERS/ITEM_FETCH_REQUEST","@USERS/ITEM_FETCH_SUCCESS","@USERS/ITEM_FETCH_FAILED")()},gt=pt(ht,bt);function vt(e){var t=e[Et];return Object(H.a)({},ft(t.state),{get state(){return e[Et]},get isFetching(){return this.state.isFetching}})}a(319);var _t=function(){return T.a.createElement("span",{className:"spin"},T.a.createElement(A.i.SpinnerIcon,null))};function yt(e){return{getUser:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/users/".concat(a)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var St=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(bt.item.request()),t.abrupt("return",yt(c).getUser(e).then(function(e){return a(bt.item.success(e)),e}).catch(function(e){return a(bt.item.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function jt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(e){return Object(N.c)(function(t){var a=vt(t);return{isFetching:a.isFetching,user:a.getItem(e)}})}(e),n=function(){var e=Z();return Object(w.useCallback)(function(t){return e(St(t))},[e])}();return Object(w.useEffect)(function(){t&&e&&n(e)},[t,e,n]),Object(H.a)({},a,{fetchUser:n})}function Ot(e){var t=e.navigate,a=e.userId,n=jt(a,!0),r=n.user,c=n.isFetching;return a?T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,r?r.name:""," | User")),T.a.createElement(F.a,{to:".."},"Back to list"),c?T.a.createElement("div",{className:"text-center"},T.a.createElement(_t,null)):r?T.a.createElement("div",null,T.a.createElement("h3",null,r.name," ",T.a.createElement(F.a,{to:"edit",title:"Edit Name"},"\u270e")),T.a.createElement("p",null,"Roles:"," ",(r.roles||[]).map(function(e,t,a){return T.a.createElement("span",{key:e.id},e.name,t!==a.length-1?" \u2022 ":"")}),T.a.createElement(F.a,{to:"edit-roles",title:"Edit Roles"},"\u270e")),"Email Verified on:"," ",r.email_verified_at?We.a.utc(r.email_verified_at).local().format("Do MMM, YYYY \\at hh:mm A"):"Not verified yet",T.a.createElement("br",null),"Invited on:"," ",We.a.utc(r.created_at).local().format("Do MMM, YYYY \\at hh:mm A")):T.a.createElement(F.d,{noThrow:!0,to:"/users"})):(t&&t("/users"),null)}var wt=a(19);function Tt(e){var t=e.isFetching,a=e.total,n=e.items,r=e.render,c=e.children;return T.a.createElement(w.Fragment,null,t?T.a.createElement("div",{className:"text-center"},T.a.createElement(_t,null)):0===a?T.a.createElement("div",{className:"text-center"},"No item in the list"):c||(r?r(n):null))}var xt=Tt;function Ct(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(w.useState)(e),a=Object(Qe.a)(t,2);return[a[0],a[1]]}var Nt={q:""};function kt(e){var t=e.initialParams,a=void 0===t?Nt:t,n=e.onSearch,r=e.placeholder,c=void 0===r?"Search...":r;return T.a.createElement(M.e,{initialValues:a,onSubmit:function(e){return n(e)},render:function(){return T.a.createElement(M.d,{noValidate:!0,style:{marginBottom:"1em"}},T.a.createElement(A.j,null,T.a.createElement(fe,{name:"q",noGroup:!0,placeholder:c,type:"search"}),T.a.createElement(A.d,{type:"submit"},T.a.createElement(A.i.SearchIcon,null))))}})}var Pt=kt,qt=a(15);function Ft(e){return{getUsers:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/users",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var At=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(bt.list.request()),t.abrupt("return",Ft(c).getUsers(e).then(function(e){var t=e.data,n=e.meta;return a(bt.list.success({data:t,meta:n})),t}).catch(function(e){return a(bt.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function It(){var e=Z();return Object(w.useCallback)(function(t){return e(At(t))},[e])}function Dt(){return Object(H.a)({},Object(N.c)(function(e){var t=vt(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,users:t.get()})}),{fetchUsers:It()})}function Yt(e){Object(wt.a)(e);var t=Ct(),a=Object(Qe.a)(t,2),n=a[0],r=a[1],c=Dt(),l=c.fetchUsers,i=c.users,u=c.total,o=c.from,s=c.to,m=c.currentPage,d=c.lastPage,f=c.isFetching;return Object(w.useEffect)(function(){l({page:m})},[l]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Users")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(kt,{onSearch:function(e){r(e),l(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:u,from:o,to:s,isFetching:f,currentPage:m,lastPage:d,onChange:function(e){return l(Object(H.a)({},n,{page:e}))}}))),T.a.createElement(Tt,{isFetching:f,total:u},T.a.createElement(A.m,{striped:!0,bordered:!0,responsive:!0,headers:["Name","Email","Roles","Email Verified At"],rows:i.map(function(e){return[T.a.createElement(F.a,{to:e.id.toString()},e.name),T.a.createElement("span",null,e.email),T.a.createElement("span",null,e.roles.map(function(e){return e.name}).join(" \u2022 ")),T.a.createElement("span",null,e.email_verified_at?We.a.utc(e.email_verified_at).local().format("Do MMM, YYYY \\at hh:mm A"):"Not Verified Yet")]})})))}var Mt=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return Ft(t).getUsers({q:e}).then(function(e){return e.data})}}))}),Rt=R.object().shape({name:R.string().required("Name is required").min(4,"Minimum 4 characters required").max(199,"Maximum 199 characters allowed"),email:R.string().email("Email must be a valid email address").required("Email field is required")}),Ht={name:"",email:"",invited_signup_link:""};var Lt=Ce(function(e){var t=e.xhr,a=e.navigate,n=e.location;return Ht.invited_signup_link=n?"".concat(n.origin,"/invited-signup"):"",T.a.createElement("div",null,T.a.createElement(M.e,{initialValues:Ht,validationSchema:Rt,onSubmit:function(e,n){n.setStatus(),t.post("/invited-users",e).then(function(e){var t=e.data.data;a&&a("../".concat(t.id)),n.setSubmitting(!1)}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status,n=e.values;return T.a.createElement(M.d,{noValidate:!0},a?T.a.createElement("div",null,a):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Invite New User"),T.a.createElement(fe,{label:"Name",name:"name",required:!0,placeholder:"John Tourepedia",autoComplete:"name"}),T.a.createElement(fe,{label:"Email",type:"email",name:"email",autoComplete:"username",placeholder:"username@tourepedia.com",required:!0}),T.a.createElement("input",{hidden:!0,type:"hidden",name:"invited_signup_link",value:n.invited_signup_link}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Submit"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))}),Ut=R.object().shape({name:R.string().required("Name is required").min(4,"Minimum 4 characters required").max(199,"Maximum 199 characters allowed")});var Vt=Ce(function(e){var t=e.xhr,a=e.navigate,n=e.userId,r=jt(n,!0),c=r.user,l=r.isFetching;if(!n)return a&&a("/users"),null;if(l)return T.a.createElement("div",{className:"text-center"},T.a.createElement(_t,null));if(!c)return a&&a("/users"),null;var i={name:c.name};return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Edit User")),T.a.createElement(M.e,{initialValues:i,validationSchema:Ut,onSubmit:function(e,r){r.setStatus(),t.patch("/users/".concat(n),e).then(function(e){var t=e.data.data;a&&a("../../".concat(t.id)),r.setSubmitting(!1)}).catch(function(e){r.setStatus(e.message),e.formikErrors&&r.setErrors(e.formikErrors),r.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Edit User Details"),a?T.a.createElement("div",null,a):null,T.a.createElement(fe,{label:"Name",name:"name",placeholder:"Manager",required:!0}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Submit"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))}),Bt="ROLE_LIST_STATE",Qt={isFetching:!0,state:dt()},Gt={list:Object(L.createAsyncAction)("@ROLES/LIST_FETCH_REQUEST","@ROLES/LIST_FETCH_SUCCESS","@ROLES/LIST_FETCH_FAILED")(),item:Object(L.createAsyncAction)("@ROLES/ITEM_FETCH_REQUEST","@ROLES/ITEM_FETCH_SUCCESS","@ROLES/ITEM_FETCH_FAILED")()},Wt=pt(Qt,Gt);function Kt(e){var t=e[Bt];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function zt(e){return{getRole:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/roles/".concat(a)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Jt=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Gt.item.request()),t.abrupt("return",zt(c).getRole(e).then(function(e){return a(Gt.item.success(e)),e}).catch(function(e){return a(Gt.item.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function $t(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(e){return Object(N.c)(function(t){var a=Kt(t);return{isFetching:a.isFetching,role:a.getItem(e)}})}(e),n=function(){var e=Z();return Object(w.useCallback)(function(t){return e(Jt(t))},[e])}();return Object(w.useEffect)(function(){t&&e&&n(e)},[t,e]),Object(H.a)({},a,{fetchRole:n})}function Xt(e){var t=e.roleId,a=e.navigate,n=$t(t,!0),r=n.role,c=n.isFetching;return t?T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,r?r.name:""," Role")),T.a.createElement(F.a,{to:".."},"Back to list"),c?T.a.createElement("div",{className:"text-center"},T.a.createElement(_t,null)):r?T.a.createElement("div",null,T.a.createElement("h3",null,r.name," ",T.a.createElement(F.a,{to:"edit",title:"Edit Role"},"\u270e")),"Created at:"," ",We.a.utc(r.created_at).local().format("Do MMM YYYY \\at hh:mm A"),T.a.createElement("br",null),T.a.createElement("p",null,T.a.createElement("b",null,"Permissions"),":"," ",(r.permissions||[]).map(function(e,t,a){return T.a.createElement("span",{key:e.id},e.name,t!==a.length-1?" \u2022 ":"")})," ",T.a.createElement(F.a,{to:"edit-permissions",title:"Edit Permissions"},"\u270e"))):T.a.createElement(F.d,{noThrow:!0,to:"/users"})):(a&&a("/roles"),null)}function Zt(e){return{getRoles:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/roles",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getPermissions:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/permissions",{params:a}).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var ea=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Gt.list.request()),t.abrupt("return",Zt(c).getRoles(e).then(function(e){return a(Gt.list.success(e)),e.data}).catch(function(e){return a(Gt.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function ta(){var e=Z();return Object(w.useCallback)(function(t){return e(ea(t))},[e])}function aa(){return Object(H.a)({},Object(N.c)(function(e){var t=Kt(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,roles:t.get()})}),{fetchRoles:ta()})}function na(e){Object(wt.a)(e);var t=aa(),a=t.roles,n=t.total,r=t.from,c=t.to,l=t.isFetching,i=t.currentPage,u=t.lastPage,o=t.fetchRoles,s=Ct(),m=Object(Qe.a)(s,2),d=m[0],f=m[1];return Object(w.useEffect)(function(){o({page:i})},[o]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Roles")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(Pt,{onSearch:function(e){f(e),o(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:n,from:r,to:c,currentPage:i,lastPage:u,isFetching:l,onChange:function(e){return o(Object(H.a)({},d,{page:e}))}}))),T.a.createElement(xt,{total:n,isFetching:l},T.a.createElement(A.m,{headers:["Name","Permissions"],striped:!0,bordered:!0,rows:a.map(function(e){return[T.a.createElement(F.a,{to:e.id.toString()},e.name),(e.permissions||[]).map(function(e){return e.name}).join(" \u2022\xa0")]})})))}var ra=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0,fetch:function(e){return Zt(t).getRoles({q:e}).then(function(e){return e.data})}},a))}),ca=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0,fetch:function(e){return Zt(t).getPermissions({q:e})}},a))}),la=R.object().shape({name:R.string().required("Name is required").min(4,"Minimum 4 characters required").max(199,"Maximum 199 characters allowed")}),ia={name:""};var ua=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement("div",null,T.a.createElement(M.e,{initialValues:ia,validationSchema:la,onSubmit:function(e,n){return n.setStatus(),t.post("/roles",e).then(function(e){var t=e.data.data;a&&a("../".concat(t.id)),n.setSubmitting(!1)}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status;return T.a.createElement(M.d,{noValidate:!0},a?T.a.createElement("div",null,a):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add New Role"),T.a.createElement(fe,{label:"Name",name:"name",required:!0,placeholder:"Manager"}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Submit"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))}),oa=R.object().shape({name:R.string().required("Name is required").min(4,"Minimum 4 characters required").max(199,"Maximum 199 characters allowed")});var sa=Ce(function(e){var t=e.xhr,a=e.navigate,n=e.roleId,r=$t(n,!0),c=r.role,l=r.isFetching;if(!n)return a&&a("/roles"),null;if(l)return T.a.createElement("div",{className:"text-center"},T.a.createElement(_t,null));if(!c)return null;var i=c.id,u=c.name,o={name:u};return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Editing ",u," Role")),T.a.createElement(M.e,{initialValues:o,validationSchema:oa,onSubmit:function(e,n){n.setStatus(),t.put("/roles/".concat(i),e).then(function(e){var t=e.data.data;a&&a("../../".concat(t.id)),n.setSubmitting(!1)}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status;return T.a.createElement(M.d,{noValidate:!0},a?T.a.createElement("div",null,a):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Edit Role"),T.a.createElement(fe,{label:"Name",name:"name",placeholder:"Manager",required:!0}),T.a.createElement(A.d,{type:"submit",disabled:t},"Save")),T.a.createElement(F.a,{to:".."},"Cancel"))}}))});var ma=Ce(function(e){var t=e.xhr,a=e.navigate,n=e.roleId,r=$t(n,!0),c=r.role,l=r.isFetching;if(!n)return a&&a("/roles"),null;if(l)return T.a.createElement("div",{className:"text-center"},T.a.createElement(_t,null));if(!c)return a&&a("/roles"),null;var i=c.name,u=c.permissions,o={permissions:void 0===u?[]:u};return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Edit ",i,"'s permissions")),T.a.createElement(M.e,{initialValues:o,onSubmit:function(e,r){r.setStatus(),t.post("/roles/".concat(n,"/permissions"),{permissions:e.permissions.map(function(e){return{name:e.name}})}).then(function(e){a&&a("../../".concat(c.id)),r.setSubmitting(!1)}).catch(function(e){r.setStatus(e.message),e.formikErrors&&r.setErrors(e.formikErrors),r.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status,n=(e.values,e.setFieldValue);return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Editing ",i,"'s permissions"),a?T.a.createElement("div",null,a):null,T.a.createElement(de,{name:"permissions",render:function(e){var t=e.field;return T.a.createElement(ca,Object.assign({},t,{label:"Select permission(s)",onChange:function(e,t){return n(t,e)}}))}}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function da(e){return T.a.createElement(ce,null,T.a.createElement(F.a,{to:"new",className:"btn float-right"},"New Role"),T.a.createElement("h2",null,"Roles"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(Xt,{path:":roleId"}),T.a.createElement(sa,{path:":roleId/edit"}),T.a.createElement(ma,{path:":roleId/edit-permissions"}),T.a.createElement(ua,{path:"/new"}),T.a.createElement(na,{path:"/"})))}var fa=Ce(function(e){var t=e.xhr,a=e.navigate,n=e.userId,r=jt(n,!0),c=r.user,l=r.isFetching;if(!n)return a&&a("/users"),null;if(l)return T.a.createElement("div",{className:"text-center"},T.a.createElement(_t,null));if(!c)return a&&a("/users"),null;var i=c.name,u=c.roles,o={roles:void 0===u?[]:u};return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Edit ",i,"'s Roles")),T.a.createElement(M.e,{initialValues:o,onSubmit:function(e,r){r.setStatus(),t.post("/users/".concat(n,"/roles"),{roles:e.roles.map(function(e){return{name:e.internal_name}})}).then(function(e){a&&a("../../".concat(c.id)),r.setSubmitting(!1)}).catch(function(e){r.setStatus(e.message),e.formikErrors&&r.setErrors(e.formikErrors),r.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status,n=(e.values,e.setFieldValue);return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Editing ",i,"'s roles"),a?T.a.createElement("div",null,a):null,T.a.createElement(de,{name:"roles",render:function(e){var t=e.field;return T.a.createElement(ra,Object.assign({},t,{label:"Select Role(s)",onChange:function(e,t){return n(t,e)}}))}}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function pa(e){return T.a.createElement(ce,null,T.a.createElement(F.a,{to:"new",className:"btn float-right"},"New User"),T.a.createElement("h2",null,"Users"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(Ot,{path:":userId"}),T.a.createElement(Vt,{path:":userId/edit"}),T.a.createElement(fa,{path:":userId/edit-roles"}),T.a.createElement(Lt,{path:"/new"}),T.a.createElement(Yt,{path:"/"})))}var Ea="HOTELS_STATE",ha={list:Object(L.createAsyncAction)("@HOTELS/LIST_FETCH_REQUEST","@HOTELS/LIST_FETCH_SUCCESS","@HOTELS/LIST_FETCH_FAILED")(),item:Object(L.createAsyncAction)("@HOTELS/ITEM_FETCH_REQUEST","@HOTELS/ITEM_FETCH_SUCCESS","@HOTELS/ITEM_FETCH_FAILED")()},ba=pt({isFetching:!0,state:dt()},ha);function ga(e){var t=e[Ea];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function va(e){return{getHotels:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/hotels",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var _a=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(ha.list.request()),t.abrupt("return",va(c).getHotels(e).then(function(e){var t=e.data,n=e.meta;return a(ha.list.success({data:t,meta:n})),t}).catch(function(e){return a(ha.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function ya(){var e=Z();return Object(w.useCallback)(function(t){return e(_a(t))},[e])}function Sa(){return Object(H.a)({},Object(N.c)(function(e){var t=ga(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,hotels:t.get()})}),{fetchHotels:ya()})}function ja(e){Object(wt.a)(e);var t=Sa(),a=t.hotels,n=t.total,r=t.from,c=t.to,l=t.lastPage,i=t.currentPage,u=t.isFetching,o=t.fetchHotels,s=Ct(),m=Object(Qe.a)(s,2),d=m[0],f=m[1];return Object(w.useEffect)(function(){o({page:i})},[o]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Hotels List")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(kt,{onSearch:function(e){f(e),o(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:n,isFetching:u,currentPage:i,from:r,to:c,lastPage:l,onChange:function(e){return o(Object(H.a)({},d,{page:e}))}}))),T.a.createElement(Tt,{isFetching:u,total:n},T.a.createElement(A.m,{responsive:!0,striped:!0,bordered:!0,headers:["Name","Meal Plans","Room Type","Child extra bed age"],rows:a.map(function(e){return[T.a.createElement(w.Fragment,null,T.a.createElement("h4",{className:"text-base"},T.a.createElement(F.a,{to:e.id.toString()},e.name)),e.location.short_name," \u2022 ",e.stars," stars"),e.meal_plans.map(function(e){return e.name}).join(" \u2022 "),e.room_types.map(function(e){return e.name}).join(" \u2022 "),T.a.createElement(w.Fragment,null,e.extra_bed_child_age_start,"-",e.extra_bed_child_age_end,"yo")]})})))}var Oa=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return va(t).getHotels({q:e}).then(function(e){return e.data})}}))}),wa=a(28),Ta=(a(142),R.object().shape({name:R.string().required("Contact name is required"),email:R.string().email("Email should be a valid email address"),phone_number:R.number().positive("Phone number should be a positive integer").typeError("Invalid number")}).required("Contact data is required")),xa={name:"",email:""};function Ca(e){var t=e.onCreate,a=e.onCancel;return T.a.createElement(M.e,{initialValues:xa,validationSchema:Ta,onSubmit:function(e,n){n.setStatus(),t(e).then(function(){n.setSubmitting(!1),a()}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})},render:function(e){e.setFieldValue;var t=e.isSubmitting;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement(fe,{name:"name",label:"Name",required:!0,placeholder:"Johhny Dep"}),T.a.createElement(fe,{name:"email",label:"Email",type:"email",placeholder:"user@domain.com"}),T.a.createElement(fe,{name:"phone_number",label:"Phone Number",type:"number",placeholder:"9911929399"}),T.a.createElement("hr",null),T.a.createElement("footer",null,T.a.createElement(A.d,{disabled:t,primary:!0,type:"submit"},"Save")," ",T.a.createElement(A.d,{onClick:a},"Cancel")))}})}var Na="HOTEL_PRICES_STATE",ka={isFetching:!0,state:dt()},Pa={list:Object(L.createAsyncAction)("@HOTEL_PRICES/LIST_FETCH_REQUEST","@HOTEL_PRICES/LIST_FETCH_SUCCESS","@HOTEL_PRICES/LIST_FETCH_FAILED")()},qa=pt(ka,Pa);function Fa(e){var t=e[Na];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function Aa(e){return{getPrices:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/hotel-prices",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Ia=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Pa.list.request()),t.abrupt("return",Aa(c).getPrices(e).then(function(e){return a(Pa.list.success(e)),e.data}).catch(function(e){return a(Pa.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Da(e){var t=e.hotelId,a=Ct(),n=Object(Qe.a)(a,2),r=n[0],c=n[1],l=Z(),i=Object(w.useCallback)(function(e){return l(Ia(Object(H.a)({},e,t?{hotels:[t]}:{})))},[l,t]);Object(w.useEffect)(function(){i({page:f})},[i]);var u=Object(N.c)(function(e){var t=Fa(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,prices:t.get()})}),o=u.prices,s=u.total,m=u.from,d=u.to,f=u.currentPage,p=u.lastPage,E=u.isFetching;return T.a.createElement(w.Fragment,null,T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(Pt,{initialParams:r,onSearch:function(e){c(e),i(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:s,from:m,to:d,currentPage:f,lastPage:p,isFetching:E,onChange:function(e){return i({page:e})}}))),T.a.createElement(xt,{isFetching:E,total:s},T.a.createElement(A.m,{responsive:!0,bordered:!0,striped:!0,headers:["Start Date","End Date"].concat(t?[]:["Hotel"]).concat(["Meal Plan","Room Type","Base Price","Persons","A.W.E.B.","C.W.E.B.","C.Wo.E.B"]),alignCols:{5:"right",6:"right",7:"right",8:"right",9:"right"},rows:o.map(function(e){var a=e.base_price,n=e.persons,r=e.start_date,c=e.end_date,l=e.hotel,i=e.adult_with_extra_bed_price,u=e.child_with_extra_bed_price,o=e.child_without_extra_bed_price,s=e.meal_plan,m=e.room_type;return[We.a.utc(r).local().format("DD/MM/YYYY"),We.a.utc(c).local().format("DD/MM/YYYY")].concat(t?[]:[T.a.createElement("span",null,l.name," ",T.a.createElement("small",null,"(",l.location.short_name," - ",l.stars," Star)"))]).concat([s.name,m.name,X(a),n.toString(),X(i),X(u),X(o)])})})))}var Ya={timezone_offset:(new Date).getTimezoneOffset(),file:"",file_name:""},Ma=R.object().shape({timezone_offset:R.string().required(),file:R.mixed().required("File field is required"),file_name:R.string().required("File field is required")}),Ra=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement("div",null,T.a.createElement(M.e,{initialValues:Ya,validationSchema:Ma,onSubmit:function(e,n){var r=new FormData;r.set("timezone_offset",e.timezone_offset.toString()),r.set("file",e.file),t.post("/hotel-prices",r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){a&&a("..")}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)}).then(function(){n.setSubmitting(!1)})},render:function(e){var t=e.setFieldValue,a=e.isSubmitting,n=e.status;return T.a.createElement(M.d,{noValidate:!0,encType:"multipart/form-data"},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Upload file to add hotel prices"),n?T.a.createElement("p",{className:"text-red-700"},n):null,T.a.createElement(fe,{label:"Select a csv file",name:"file_name",type:"file",accept:".csv",onChange:function(e){var a=e.currentTarget;t("file",a.files?a.files[0]:""),t(a.name,a.value)}}),T.a.createElement("footer",null,T.a.createElement(A.d,{type:"submit",disabled:a,primary:!0},"Upload"),T.a.createElement(F.a,{className:"btn",to:".."},"Cancel"))))}}))}),Ha="MEAL_PLANS_STATE",La={isFetching:!0,state:dt()},Ua={list:Object(L.createAsyncAction)("@MEAL_PLANS/LIST_FETCH_REQUEST","@MEAL_PLANS/LIST_FETCH_SUCCESS","@MEAL_PLANS/LIST_FETCH_FAILED")()},Va=pt(La,Ua);function Ba(e){var t=e[Ha];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function Qa(e){return{getMealPlans:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/meal-plans",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Ga=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Ua.list.request()),t.abrupt("return",Qa(c).getMealPlans(e).then(function(e){var t=e.data,n=e.meta;return a(Ua.list.success({data:t,meta:n})),t}).catch(function(e){return a(Ua.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Wa(){var e=Z();return Object(w.useCallback)(function(t){return e(Ga(t))},[e])}function Ka(){return Object(H.a)({},Object(N.c)(function(e){var t=Ba(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,mealPlans:t.get()})}),{fetchMealPlans:Wa()})}function za(e){Object(wt.a)(e);var t=Ka(),a=t.mealPlans,n=t.total,r=t.from,c=t.to,l=t.isFetching,i=t.currentPage,u=t.lastPage,o=t.fetchMealPlans,s=Ct(),m=Object(Qe.a)(s,2),d=m[0],f=m[1];return Object(w.useEffect)(function(){o({page:i})},[o]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Meal Plans")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(Pt,{onSearch:function(e){f(e),o(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:n,from:r,to:c,currentPage:i,lastPage:u,isFetching:l,onChange:function(e){return o(Object(H.a)({},d,{page:e}))}}))),T.a.createElement(xt,{total:n,isFetching:l},T.a.createElement(A.m,{striped:!0,bordered:!0,headers:["Name","Description"],rows:a.map(function(e){return[e.name,e.description]})})))}var Ja=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return Qa(t).getMealPlans({q:e}).then(function(e){return e.data})}}))}),$a=R.object().shape({name:R.string().required("Name field is required"),description:R.string().required("Description field is required")}),Xa={name:"",description:""};var Za=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"New Meal Plan")),T.a.createElement(M.e,{initialValues:Xa,validationSchema:$a,onSubmit:function(e,n){return n.setStatus(),t.post("/meal-plans",e).then(function(e){e.data,a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status;return T.a.createElement(M.d,{noValidate:!0},a?T.a.createElement("div",null,a):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add New Meal Plan"),T.a.createElement(fe,{label:"Name",name:"name",placeholder:"MAP",required:!0}),T.a.createElement(fe,{label:"Description",name:"description",placeholder:"Modified American Plan (Two meals: Breakfast and one of Lunch or Dinner)",required:!0}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function en(e){return T.a.createElement(ce,null,T.a.createElement(F.a,{to:"new",className:"float-right btn"},"New Meal Plan"),T.a.createElement("h2",null,"Meal Plans"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(Za,{path:"/new"}),T.a.createElement(za,{path:"/"})))}var tn="ROOM_TYPES_STATE",an={isFetching:!0,state:dt()},nn={list:Object(L.createAsyncAction)("@ROOM_TYPES/LIST_FETCH_REQUEST","@ROOM_TYPES/LIST_FETCH_SUCCESS","@ROOM_TYPES/LIST_FETCH_FAILED")()},rn=pt(an,nn);function cn(e){var t=e[tn];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function ln(e){return{getRoomTypes:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/room-types",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var un=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(nn.list.request()),t.abrupt("return",ln(c).getRoomTypes(e).then(function(e){return a(nn.list.success(e)),e.data}).catch(function(e){return a(nn.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function on(){var e=Object(N.c)(function(e){var t=cn(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,roomTypes:t.get()})}),t=function(){var e=Z();return Object(w.useCallback)(function(t){return e(un(t))},[e])}();return Object(H.a)({},e,{fetchRoomTypes:t})}function sn(e){var t=Ct(),a=Object(Qe.a)(t,2),n=a[0],r=a[1],c=on(),l=c.fetchRoomTypes,i=c.roomTypes,u=c.total,o=c.from,s=c.to,m=c.currentPage,d=c.lastPage,f=c.isFetching;return Object(w.useEffect)(function(){l({page:m})},[l]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Room Types")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(Pt,{onSearch:function(e){r(e),l(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:u,from:o,to:s,isFetching:f,currentPage:m,lastPage:d,onChange:function(e){return l(Object(H.a)({},n,{page:e}))}}))),T.a.createElement(xt,{total:u,isFetching:f},T.a.createElement(A.m,{bordered:!0,striped:!0,headers:["Name","Description"],rows:i.map(function(e){return[e.name,e.description]})})))}var mn=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return ln(t).getRoomTypes({q:e}).then(function(e){return e.data})}}))}),dn=R.object().shape({name:R.string().required("Name field is required"),description:R.string().required("Description field is required")}),fn={name:"",description:""};var pn=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"New Room Type")),T.a.createElement(M.e,{initialValues:fn,validationSchema:dn,onSubmit:function(e,n){return n.setStatus(),t.post("/room-types",e).then(function(e){e.data,a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status;return T.a.createElement(M.d,{noValidate:!0},a?T.a.createElement("div",null,a):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add New Room Type"),T.a.createElement(fe,{label:"Name",name:"name",placeholder:"Delux",required:!0}),T.a.createElement(fe,{label:"Description",name:"description",placeholder:"Luxury room",required:!0}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function En(e){return T.a.createElement(ce,null,T.a.createElement(F.a,{to:"new",className:"btn float-right"},"New Room Type"),T.a.createElement("h2",null,"Room Types"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(pn,{path:"/new"}),T.a.createElement(sn,{path:"/"})))}function hn(e){return T.a.createElement(fe,Object.assign({type:"date",placeholder:"dd/mm/yyyy"},e))}var bn={prices:[{start_date:"",end_date:"",base_price:0,persons:2,adult_with_extra_bed_price:0,child_with_extra_bed_price:0,child_without_extra_bed_price:0,hotel:void 0,meal_plan:void 0,room_type:void 0}]},gn=R.object().shape({prices:R.array().of(R.object().shape({hotel:R.object().required("Hotel is required"),start_date:R.string().required("Start date field is required"),end_date:R.string().required("End date field is required"),base_price:R.number().required("Base price field is required").positive("Price should be positive"),persons:R.number().required("Persons field is required").integer().positive("Persons should be positive number"),adult_with_extra_bed_price:R.number().required("Price for adult with extra bed is required").min(0,"Price should not be negative"),child_with_extra_bed_price:R.number().required("Price for child with extra bed is required").min(0,"Price should not be negative"),child_without_extra_bed_price:R.number().nullable(!0).min(0,"Price should not be negative").required("Price for child without extra bed is required"),meal_plan:R.object().required("Meal plan should be selected"),room_type:R.object().required("Room type should be selected")}))});var vn=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Add Prices")),T.a.createElement(M.e,{initialValues:bn,validationSchema:gn,onSubmit:function(){var e=Object(Y.a)(D.a.mark(function e(n,r){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setStatus(),e.abrupt("return",t.post("/hotel-prices",{prices:n.prices.reduce(function(e,t){var a=t.meal_plan,n=t.room_type,r=t.hotel,c=t.start_date,l=t.end_date,i=Object(ie.a)(t,["meal_plan","room_type","hotel","start_date","end_date"]),u=[];return u.push(Object(H.a)({},i,{start_date:We()(c).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),end_date:We()(l).hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),hotel_id:r&&r.id,meal_plan_id:a&&a.id,room_type_id:n&&n.id})),e.concat(u)},[])}).then(function(){a&&a(".."),r.setSubmitting(!1)}).catch(function(e){r.setStatus(e.message),e.formikErrors&&r.setErrors(e.formikErrors),r.setSubmitting(!1)}));case 2:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),render:function(e){var t=e.isSubmitting,a=e.setFieldValue,n=e.values;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",{style:{minInlineSize:"auto"}},T.a.createElement("legend",null,"Add Hotel Price"),T.a.createElement(M.c,{name:"prices",render:function(e){var t=e.name,r=e.remove,c=e.push;return T.a.createElement("ol",{className:"list"},n.prices.map(function(e,l){return T.a.createElement("li",{key:l},T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(hn,{label:"Start Date",name:"".concat(t,".").concat(l,".start_date")})),T.a.createElement(ct,null,T.a.createElement(hn,{label:"End Date",name:"".concat(t,".").concat(l,".end_date")})),T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(t,".").concat(l,".hotel"),render:function(e){var t=e.field;return T.a.createElement(Oa,Object.assign({},t,{multiple:!1,label:"Hotel",onChange:function(e,t){return a(t,e)}}))}})),T.a.createElement(ct,null,T.a.createElement(de,{name:"prices.".concat(l,".meal_plan"),render:function(t){var n=t.field;return T.a.createElement(Ja,Object.assign({label:"Meal Plan"},n,{searchable:!1,multiple:!1,options:e.hotel&&e.hotel.meal_plans,onChange:function(e,t){return a(t,e)}}))}})),T.a.createElement(ct,null,T.a.createElement(de,{name:"prices.".concat(l,".room_type"),render:function(t){var n=t.field;return T.a.createElement(mn,Object.assign({},n,{label:"Room Type",searchable:!1,multiple:!1,options:e.hotel&&e.hotel.room_types,onChange:function(e,t){a(t,e),e&&e.allowed_extra_beds||(a("prices.".concat(l,".adult_with_extra_bed_price"),0),a("prices.".concat(l,".child_with_extra_bed_price"),0))}}))}}))),T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Prices"),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(fe,{label:"Number of persons",name:"".concat(t,".").concat(l,".persons"),type:"number"})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Base Price",name:"".concat(t,".").concat(l,".base_price"),type:"number"})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Adult with extra bed price",name:"".concat(t,".").concat(l,".adult_with_extra_bed_price"),type:"number",title:e.room_type?e.room_type.allowed_extra_beds?void 0:"No extra bed allowed":"Please select a room type",disabled:!e.room_type||!e.room_type.allowed_extra_beds})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Child with extra bed price",name:"".concat(t,".").concat(l,".child_with_extra_bed_price"),type:"number",title:e.room_type?e.room_type.allowed_extra_beds?void 0:"No extra bed allowed":"Please select a room type",disabled:!e.room_type||!e.room_type.allowed_extra_beds})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Child without extra bed price",name:"".concat(t,".").concat(l,".child_without_extra_bed_price"),type:"number"})))),T.a.createElement("hr",null),T.a.createElement("div",{className:"button-group form-group"},T.a.createElement(A.d,{className:"btn--secondary",onClick:function(t){return c(e)}},"+ Duplicate"),n.prices.length>1?T.a.createElement(A.d,{className:"btn--secondary",onClick:function(e){return r(l)}},"\xd7 Remove"):null))}),T.a.createElement("div",{className:"form-group"},T.a.createElement("hr",null),T.a.createElement(A.d,{onClick:function(e){return c(bn.prices[0])}},"+ Add More")))}}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function _n(e){return{getPrice:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/prices",{params:{hotels:a}}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var yn=R.object().shape({hotels:R.array().of(R.object().shape({start_date:R.string().required("Start Date field is required."),no_of_nights:ee().required("Number of nights field is required").integer("Number of nights should be an integer").positive("Number of nights should be a positive number"),hotel:R.object().required("Hotel field is required"),meal_plan:R.object().required("Meal Plan field is required"),rooms_detail:R.object().shape({room_type:R.object().required("Room type field is required"),adults_with_extra_bed:ee().integer("Adult with extra bed should be an interger").required("Adult with extra bed is required"),children_with_extra_bed:ee().integer("Child with extra bed should be an integer").required("Child with extra bed is required"),children_without_extra_bed:ee().integer("Child without extra bed should be an integer").required("Child without extra bed is required"),no_of_rooms:ee().positive("Number of rooms should be a positive number").integer("Number of room should be an integer").required("Number of rooms is required")})}))}),Sn={hotels:[{start_date:"",no_of_nights:1,hotel:void 0,meal_plan:void 0,rooms_detail:{room_type:void 0,adults_with_extra_bed:0,children_with_extra_bed:0,children_without_extra_bed:0,no_of_rooms:1},calculated_price:void 0,given_price:0,edited_given_price:!1,comments:""}]},jn=Ce(function(e){var t=e.initialValues,a=e.shouldEmptyInitialValues,n=void 0!==a&&a,r=e.xhr,c=e.onChange,l=e.bookingFrom,i=e.bookingTo,u=t||(n?{hotels:[]}:Sn),o=Object(w.useCallback)(function(e){c&&c(e.hotels.reduce(function(e,t){return e+parseFloat((t.given_price?t.given_price:0).toString())},0),e.hotels.map(function(e){var t=e.start_date,a=e.no_of_nights,n=e.rooms_detail,r=e.hotel,c=e.meal_plan,l=Object(ie.a)(e,["start_date","no_of_nights","rooms_detail","hotel","meal_plan"]),i=n||{room_type:void 0},u=i.room_type,o=Object(ie.a)(i,["room_type"]);return Object(H.a)({},l,{checkin:We()(t).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),checkout:We()(t).add(a-1,"days").hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),hotel_id:r&&r.id,meal_plan_id:c&&c.id},o,{room_type_id:u&&u.id})}))},[c]);Object(A.o)(function(){o(u)});var s=Object(w.useMemo)(function(){for(var e=[],t=We()(i).diff(We()(l),"days"),a=0;a<=t;a++)e.push({id:a,name:We()(l).add(a,"day").format("YYYY-MM-DD")});return e},[l,i]),m=Object(w.useCallback)(function(){var e=Object(Y.a)(D.a.mark(function e(t,a){var n,c;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setStatus(),n=[],c={hotels:[]},t.hotels.forEach(function(e){var t=e.start_date,a=e.no_of_nights,r=e.hotel,l=e.meal_plan,i=e.rooms_detail;if(r&&t&&a&&l&&i&&i.room_type){var u=i.room_type,o=i.adults_with_extra_bed,s=i.children_with_extra_bed,m=i.children_without_extra_bed,d=i.no_of_rooms;c.hotels.push(Object(H.a)({},e,{start_date:We()(t).format("YYYY-MM-DD"),no_of_nights:a})),n.push({checkin:We()(t).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),checkout:We()(t).add(a-1,"days").hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),hotel_id:r.id,meal_plan_id:l.id,room_type_id:u.id,adults_with_extra_bed:o,children_with_extra_bed:s,children_without_extra_bed:m,no_of_rooms:d})}}),e.abrupt("return",_n(r).getPrice(n).then(function(e){c.hotels=c.hotels.map(function(t,a){return Object(H.a)({},t,{calculated_price:e.hotels[a].price,price_calculation_string:e.hotels[a].price_calculation_string,given_price:t.edited_given_price?t.given_price:e.hotels[a].price,no_price_for_dates:e.hotels[a].no_price_for_dates})}),a.setValues(c),o(c)}).catch(function(e){a.setStatus(e.message),e.formikErrors&&a.setErrors(e.formikErrors)}));case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),[r,o]),d=Object(w.useRef)(!0);return T.a.createElement(M.e,{initialValues:u,validationSchema:yn,onSubmit:function(e,t){return m(e,t).then(function(){t.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.values,n=e.setFieldValue;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement(M.c,{name:"hotels",render:function(e){var r=e.name,c=e.push,u=e.remove;return T.a.createElement("div",null,a.hotels.map(function(e,a){return T.a.createElement("div",{key:a,className:"border-gray-300 border-b-4"},T.a.createElement(rt,null,T.a.createElement(ct,{md:7,className:"py-3"},T.a.createElement(rt,null,T.a.createElement(ct,{md:12},T.a.createElement(rt,null,T.a.createElement(ct,null,l&&i?T.a.createElement(de,{name:"".concat(r,".").concat(a,".start_date"),render:function(t){var a=t.field;return T.a.createElement(A.l,Object.assign({},a,{label:"Checkin Date",options:s,searchable:!1,placeholder:"Select a date...",required:!0,onQuery:function(){},value:s.find(function(t){return t.name===e.start_date}),onChange:function(e,t){n(t,e.name)}}))}}):T.a.createElement(hn,{label:"Checkin Date",name:"".concat(r,".").concat(a,".start_date"),required:!0})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Stay Nights",name:"".concat(r,".").concat(a,".no_of_nights"),type:"number",min:1,max:1e3})),T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(r,".").concat(a,".hotel"),render:function(e){var t=e.field;return T.a.createElement(Oa,Object.assign({},t,{label:"Hotel",multiple:!1,onChange:function(e,t){return n(t,e)}}))}})),T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(r,".").concat(a,".meal_plan"),render:function(t){var a=t.field;return T.a.createElement(Ja,Object.assign({},a,{label:"Meal Plan",multiple:!1,searchable:!1,options:e.hotel?e.hotel.meal_plans:[],onChange:function(e,t){return n(t,e)}}))}})))),T.a.createElement(ct,{md:12},T.a.createElement("div",null,T.a.createElement(M.b,{name:"".concat(r,".").concat(a,".rooms_detail"),render:function(t){var r=t.field,c=r.name,l=r.value;return T.a.createElement(rt,{key:a},T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(c,".room_type"),render:function(t){var a=t.field;return T.a.createElement(mn,Object.assign({},a,{label:"Room Type",options:e.hotel?e.hotel.room_types:[],searchable:!1,multiple:!1,onChange:function(e,t){n(t,e),e&&e.allowed_extra_beds||(n("".concat(c,".adults_with_extra_bed"),0),n("".concat(c,".children_with_extra_bed"),0))}}))}})),T.a.createElement(ct,null,T.a.createElement(fe,{name:"".concat(c,".no_of_rooms"),label:"No. of rooms",type:"number",min:1,max:1e3,onChange:function(e){var t=parseInt(e.currentTarget.value,10),a=l.room_type,r=l.adults_with_extra_bed,i=l.children_with_extra_bed;if(!isNaN(t)&&a){n(e.currentTarget.name,t);var u=a.allowed_extra_beds*t;r+i>u&&(n("".concat(c,".adults_with_extra_bed"),Math.min(u,r)),n("".concat(c,".children_with_extra_bed"),Math.min(u-Math.min(u,r),i)))}}})),T.a.createElement(ct,null,T.a.createElement(fe,{name:"".concat(c,".adults_with_extra_bed"),label:"AWEB",type:"number",min:0,max:100,disabled:!l.room_type||!l.room_type.allowed_extra_beds,onChange:function(e){var t=e.currentTarget.name,a=parseInt(e.currentTarget.value,10),r=l.room_type,c=l.no_of_rooms,i=l.children_with_extra_bed;if(!isNaN(a)&&r){var u=r.allowed_extra_beds;n(t,Math.min(u*c-i,a))}}})),T.a.createElement(ct,null,T.a.createElement(fe,{name:"".concat(c,".children_with_extra_bed"),label:"CWEB",type:"number",min:0,max:100,disabled:!l.room_type||!l.room_type.allowed_extra_beds,onChange:function(e){var t=e.currentTarget.name,a=parseInt(e.currentTarget.value,10),r=l.room_type,c=l.no_of_rooms,i=l.adults_with_extra_bed;if(!isNaN(a)&&r){var u=r.allowed_extra_beds;n(t,Math.min(u*c-i,a))}}})),T.a.createElement(ct,null,T.a.createElement(fe,{name:"".concat(c,".children_without_extra_bed"),label:"CWoEB",min:0,max:100,type:"number"})))}}))))),T.a.createElement(ct,{md:4,className:"md:border-l py-3"},T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(A.h,null,T.a.createElement("div",{className:"mb-1 white-space-pre"},"Calculated Price"),t?T.a.createElement(_t,null):void 0!==e.calculated_price?T.a.createElement(A.b,{primary:!0},T.a.createElement(A.i.RupeeIcon,null)," ",e.calculated_price):T.a.createElement(A.d,{type:"submit",disabled:t},"Get Price"),e.no_price_for_dates&&e.no_price_for_dates.length?T.a.createElement("p",{className:"text-yellow-800"},"No prices available for"," ",e.no_price_for_dates.map(function(e){return We.a.utc(e).local().format("Do MMM")}).join(", ")):null)),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Given Price",name:"".concat(r,".").concat(a,".given_price"),type:"number",value:e.given_price,onChange:function(e){var t=parseInt(e.target.value,10);isNaN(t)&&(t=void 0),d.current=!1,n("".concat(r,".").concat(a,".edited_given_price"),!0),n(e.target.name,t)},min:0})),e.price_calculation_string&&e.price_calculation_string.length?T.a.createElement(ct,{sm:12,className:"mb-2"},e.price_calculation_string.map(function(e,t){var a=e.date,n=e.price,r=e.how;return T.a.createElement("div",{key:t},T.a.createElement(A.b,null,T.a.createElement(A.i.RupeeIcon,null)," ",n),T.a.createElement("b",null,We.a.utc(a).local().format(" DD/MM/YYYY ")),"(",r,")")})):null,T.a.createElement(ct,{sm:12},T.a.createElement(fe,{label:"Comments",name:"".concat(r,".").concat(a,".comments"),maxLength:191,value:e.comments,placeholder:"Regarding pricing difference or any other",className:"w-full",onChange:function(e){var t=e.target.value;d.current=!1,n(e.target.name,t)}})))),T.a.createElement(ct,{md:1,className:"text-right md:border-l py-3"},T.a.createElement(A.d,{className:"btn--secondary w-full",onClick:function(){return c(e)}},"+ Duplicate"),T.a.createElement("br",null),T.a.createElement(A.d,{className:"btn--secondary w-full",onClick:function(){return u(a)}},"\xd7 Remove"))))}),T.a.createElement("div",{className:"pt-4"},T.a.createElement(A.d,{onClick:function(){return c(Sn.hotels[0])}},"+ Add ",a.hotels.length?"Another":""," Hotel Query")))}}),T.a.createElement(pe,{onChange:function(e){o(e.values),d.current?e.isSubmitting||yn.validate(e.values).then(Object(Y.a)(D.a.mark(function t(){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSubmitting){t.next=2;break}return t.abrupt("return");case 2:return e.setSubmitting(!0),t.abrupt("return",m(e.values,e).then(function(){e.setSubmitting(!1)}));case 4:case"end":return t.stop()}},t)}))).catch(function(){}):d.current=!0}}))}})});function On(e){var t=Object(w.useState)(0),a=Object(Qe.a)(t,2),n=a[0],r=a[1];return T.a.createElement("div",null,T.a.createElement("div",{className:"flex align-items-center mb-8"},T.a.createElement(F.a,{to:"..",className:"mr-4 text-blue-600 hover:text-blue-800 text-lg px-2 border rounded-full"},T.a.createElement(A.i.ChevronDownIcon,{className:"rotate-90"})),T.a.createElement("h3",{className:"m-0"},"Calculate Hotel Prices")),T.a.createElement("p",null,"Please enter the desired hotel configuration query and press get price to get the prices."),T.a.createElement("div",{className:"bg-white px-4 pb-4 rounded shadow"},T.a.createElement(jn,{onChange:function(e){return r(e)}})),T.a.createElement("footer",{className:"mt-4"},T.a.createElement("mark",{className:"inilne-block text-xl font-bold rounded px-4 py-2"},"Total Price: ",X(n))))}function wn(e){return T.a.createElement(ce,null,T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement("h2",{className:"white-space-pre"},"Hotel Prices")),T.a.createElement(ct,{className:"text-right d-flex align-items-center justify-content-end"},T.a.createElement("div",{className:"button-group"},T.a.createElement(F.a,{to:"upload-prices",className:"btn"},"Upload Prices"),T.a.createElement(F.a,{to:"new",className:"btn"},"Add Prices"),T.a.createElement(F.a,{to:"calculate-price",className:"btn"},"Calculate Price")))),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(vn,{path:"/new"}),T.a.createElement(Ra,{path:"/upload-prices"}),T.a.createElement(On,{path:"/calculate-price"}),T.a.createElement(Da,{path:"/"})))}a(143);var Tn=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(A.a,Object.assign({},a,{fetch:function(e){return t.get("/hotel-extra-services",{params:{q:e}}).then(function(e){return e.data.data})}}))}),xn=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(A.a,Object.assign({},a,{fetch:function(e){return t.get("/transport-extra-services",{params:{q:e}}).then(function(e){return e.data.data})}}))}),Cn=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(A.a,Object.assign({},a,{fetch:function(e){return t.get("/other-extra-services",{params:{q:e}}).then(function(e){return e.data.data})}}))});var Nn=R.object().shape({hotel_extras:R.array().of(R.object().shape({service:R.object().typeError("Service field is required").required("Service field is required"),date:R.string(),hotel:R.object(),price:ee().positive("Price should be positive"),comments:R.string()}))}),kn={hotel_extras:[{service:void 0,date:"",hotel:void 0,price:void 0,comments:""}]},Pn=Ce(function(e){var t=e.initialValues,a=e.shouldEmptyInitialValues,n=void 0===a||a,r=e.xhr,c=e.onChange,l=e.bookingFrom,i=e.bookingTo,u=t||(n?{hotel_extras:[]}:kn),o=Object(w.useCallback)(function(e){c&&c(e.hotel_extras.reduce(function(e,t){return e+parseFloat((t.price?t.price:0).toString())},0),e.hotel_extras.map(function(e){var t=e.service,a=e.date,n=e.hotel,r=e.price,c=Object(ie.a)(e,["service","date","hotel","price"]);return Object(H.a)({},c,{service:t?t.name:void 0,date:a?We()(a).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"):"",hotel_id:n&&n.id,price:r})}))},[c]);Object(A.o)(function(){o(u)});var s=Object(w.useMemo)(function(){for(var e=[],t=We()(i).diff(We()(l),"days"),a=0;a<=t;a++)e.push({id:a,name:We()(l).add(a,"day").format("YYYY-MM-DD")});return e},[l,i]),m=Object(w.useCallback)(function(){var e=Object(Y.a)(D.a.mark(function e(t,a){var n,r;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setStatus(),n=[],r={hotel_extras:[]},t.hotel_extras.forEach(function(e){var t=e.date,a=e.service,c=e.hotel,l=Object(ie.a)(e,["date","service","hotel"]);a&&(r.hotel_extras.push(Object(H.a)({},e,{date:t?We()(t).format("YYYY-MM-DD"):""})),n.push(Object(H.a)({},l,{date:t?We()(t).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"):"",hotel_id:c&&c.id,service:a&&a.name})))}),e.abrupt("return",function(){var e=Object(Y.a)(D.a.mark(function e(t){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({hotel_extras:t}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(n).then(function(e){r.hotel_extras=r.hotel_extras.map(function(t,a){return Object(H.a)({},t,{price:e.hotel_extras[a].price})}),a.setValues(r),o(r)}).catch(function(e){a.setStatus(e.message),e.formikErrors&&a.setErrors(e.formikErrors)}));case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),[r,o]),d=Object(w.useRef)(!0);return T.a.createElement(M.e,{initialValues:u,validationSchema:Nn,onSubmit:function(e,t){return m(e,t).then(function(){t.setSubmitting(!1)})},render:function(e){var t=e.values,a=e.setFieldValue;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement(M.c,{name:"hotel_extras",render:function(e){var n=e.name,r=e.push,c=e.remove;return T.a.createElement("div",null,t.hotel_extras.map(function(e,t){return T.a.createElement("div",{key:t,className:"border-gray-300 border-b-4"},T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(n,".").concat(t,".service"),render:function(e){var t=e.field;return T.a.createElement(Tn,Object.assign({},t,{label:"Service",placeholder:"Select or add a service...",required:!0,creatable:!0,fetchOnMount:!0,onChange:function(e,t){a(t,e)}}))}})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Price",name:"".concat(n,".").concat(t,".price"),type:"number",placeholder:"3000",min:0})),T.a.createElement(ct,null,l&&i?T.a.createElement(de,{name:"".concat(n,".").concat(t,".date"),render:function(t){var n=t.field;return T.a.createElement(A.l,Object.assign({},n,{label:"Date",options:s,searchable:!1,placeholder:"Select a date...",required:!0,value:s.find(function(t){return t.name===e.date}),onChange:function(e,t){a(t,e.name)}}))}}):T.a.createElement(hn,{label:"Date",name:"".concat(n,".").concat(t,".date"),required:!0})),T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(n,".").concat(t,".hotel"),render:function(e){var t=e.field;return T.a.createElement(Oa,Object.assign({},t,{label:"Hotel",multiple:!1,onChange:function(e,t){return a(t,e)}}))}})),T.a.createElement(ct,null,T.a.createElement(fe,{name:"".concat(n,".").concat(t,".comments"),label:"Comments",placeholder:"Any comments regarding service"})),T.a.createElement(ct,{className:"pt-4 border-l text-right"},T.a.createElement(A.e,null,T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){return r(e)}},"+ Duplicate"),T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){return c(t)}},"\xd7 Remove")))))}),T.a.createElement("div",{className:"mt-4"},T.a.createElement(A.d,{onClick:function(){return r(kn.hotel_extras[0])}},"+ Add ",t.hotel_extras.length?"Another":""," Hotel Extra Service")))}}),T.a.createElement(pe,{onChange:function(e){o(e.values),d.current?e.isSubmitting||Nn.validate(e.values).then(Object(Y.a)(D.a.mark(function t(){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSubmitting){t.next=2;break}return t.abrupt("return");case 2:return e.setSubmitting(!0),t.abrupt("return",m(e.values,e).then(function(){e.setSubmitting(!1)}));case 4:case"end":return t.stop()}},t)}))).catch(function(){}):d.current=!0}}),T.a.createElement("button",{type:"submit",className:"invisible"},"Get Price"))}})});function qn(e){return{getHotel:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/hotels/".concat(a)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),createContact:function(){var t=Object(Y.a)(D.a.mark(function t(a,n){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/hotel-contacts",Object(H.a)({hotel_id:a},n)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()}}var Fn=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(ha.item.request()),t.abrupt("return",qn(c).getHotel(e).then(function(e){return a(ha.item.success(e)),e}).catch(function(e){return a(ha.item.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function An(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(e){return Object(N.c)(function(t){var a=ga(t);return{isFetching:a.isFetching,hotel:a.getItem(e)}})}(e),n=function(){var e=Z();return Object(w.useCallback)(function(t){return e(Fn(t))},[e])}();return Object(w.useEffect)(function(){t&&e&&n(e)},[n,e,t]),Object(H.a)({},a,{fetchHotel:n})}var In=Ce(function(e){var t=e.hotelId,a=e.navigate,n=e.xhr,r=Object(wa.c)(),c=Object(Qe.a)(r,3),l=c[0],i=c[1],u=c[2],o=An(t,!0),s=o.hotel,m=o.isFetching,d=o.fetchHotel;if(!t)return a&&a("/hotels"),null;if(m)return T.a.createElement("div",{className:"text-center"},T.a.createElement(_t,null));if(!s)return null;var f=s.name,p=s.stars,E=s.extra_bed_child_age_start,h=s.extra_bed_child_age_end,b=s.meal_plans,g=s.room_types,v=s.location,_=s.contacts,y=s.payment_preference;return T.a.createElement("div",null,T.a.createElement(F.a,{to:".."},"Back"),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement("h3",null,f," \u2022 ",v.short_name," \u2022 ",p," Star"),T.a.createElement("dl",null,T.a.createElement("dt",null,"Meal Plans:"),T.a.createElement("dd",null,b.map(function(e){return e.name}).join(" \u2022 ")),T.a.createElement("dt",null,"Room Types:"),T.a.createElement("dd",null,g.map(function(e){return"".concat(e.name,"(").concat(e.allowed_extra_beds," AEBs)")}).join(" \u2022 ")),T.a.createElement("dt",null,"Payment Preference"),T.a.createElement("dd",null,y?y.name:"NOT SET"),T.a.createElement("dt",null,"Extra bed child ages:"),T.a.createElement("dd",null,"From ",E," to ",h," ","years"))),T.a.createElement(ct,{sm:"auto",xs:12},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Contacts"),T.a.createElement("ul",null,(_||[]).map(function(e){return T.a.createElement("li",{key:e.id},e.name," ",e.phone_number,"<",e.email,">")})),T.a.createElement(wa.a,{open:l,onClose:u,closeButton:!0},T.a.createElement(wa.a.Header,null,T.a.createElement(wa.a.Title,null,"Add Contact")),T.a.createElement(wa.a.Body,null,T.a.createElement(Ca,{onCancel:u,onCreate:function(){var e=Object(Y.a)(D.a.mark(function e(a){var r,c,l,i;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.name,c=a.email,l=a.phone_number,i=a.country,e.abrupt("return",qn(n).createContact(t,{name:r,email:c,phone_number:l,country_id:i?i.id:void 0}).then(function(e){return d(t),e}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}))),T.a.createElement(A.d,{onClick:i,"data-testid":"add_contact"},"Add Contact")))),T.a.createElement("div",{className:"mt-4"},T.a.createElement(F.a,{to:"/hotel-prices/new?id=".concat(s.id),className:"btn float-right"},"Add Prices"),T.a.createElement("h3",null,"Prices"),T.a.createElement(F.e,null,T.a.createElement(Da,{hotelId:s.id,path:"/"}))))}),Dn="LOCATIONS_STATE",Yn={isFetching:!0,state:dt()},Mn={list:Object(L.createAsyncAction)("@LOCATIONS/LIST_FETCH_REQUEST","@LOCATIONS/LIST_FETCH_SUCCESS","@LOCATIONS/LIST_FETCH_FAILED")()},Rn=pt(Yn,Mn);function Hn(e){var t=e[Dn];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function Ln(e){return{getLocations:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/locations",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getCountries:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/locations/countries",{params:a}).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getStates:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/locations/states",{params:a}).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getCities:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/locations/cities",{params:a}).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Un=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Mn.list.request()),t.abrupt("return",Ln(c).getLocations(e).then(function(e){return a(Mn.list.success(e)),e.data}).catch(function(e){return a(Mn.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Vn(){var e=Z();return Object(w.useCallback)(function(t){return e(Un(t))},[e])}function Bn(){return Object(H.a)({},Object(N.c)(function(e){var t=Hn(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,locations:t.get()})}),{fetchLocations:Vn()})}function Qn(e){var t=Bn(),a=t.locations,n=t.total,r=t.from,c=t.to,l=t.isFetching,i=t.currentPage,u=t.lastPage,o=t.fetchLocations,s=Ct(),m=Object(Qe.a)(s,2),d=m[0],f=m[1];return Object(w.useEffect)(function(){o({page:i})},[o]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Locations")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(Pt,{onSearch:function(e){f(e),o(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:n,from:r,to:c,currentPage:i,lastPage:u,isFetching:l,onChange:function(e){return o(Object(H.a)({},d,{page:e}))}}))),T.a.createElement(xt,{total:n,isFetching:l},T.a.createElement(A.m,{striped:!0,bordered:!0,headers:["Name","Latitude","Longitude"],responsive:!0,rows:a.map(function(e){return[e.name,e.latitude,e.longitude]})})))}var Gn=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return Ln(t).getLocations({q:e}).then(function(e){return e.data})}}))}),Wn=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return Ln(t).getCountries({q:e})}}))}),Kn=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return Ln(t).getStates({q:e})}}))}),zn=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return Ln(t).getCities({q:e})}}))}),Jn=R.object().shape({country:R.object().required("Country field is required"),latitue:R.string(),longitude:R.string()}),$n={city:void 0,state:void 0,country:void 0,latitude:"",longitude:""};var Xn=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"New Location")),T.a.createElement(M.e,{initialValues:$n,validationSchema:Jn,onSubmit:function(e,n){n.setStatus();var r=e.country,c=e.state,l=e.city,i=e.latitude,u=e.longitude;t.post("/locations",{country:r?r.id:void 0,state:c?c.name:void 0,city:l?l.name:void 0,latitude:i,longitude:u}).then(function(){a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status,n=(e.values,e.setFieldValue);return T.a.createElement(M.d,{noValidate:!0},a?T.a.createElement("div",null,a):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add New Location"),T.a.createElement(de,{name:"country",render:function(e){var t=e.field;return T.a.createElement(Wn,Object.assign({},t,{multiple:!1,label:"Country",placeholder:"Type to search.. (e.g. India)",onChange:function(e,t){n(t,e)}}))}}),T.a.createElement(de,{name:"state",render:function(e){var t=e.field;return T.a.createElement(Kn,Object.assign({},t,{multiple:!1,label:"State",onChange:function(e,t){return n(t,e)},placeholder:"Type to search.. (e.g. Rajasthan)",creatable:!0}))}}),T.a.createElement(de,{name:"city",render:function(e){var t=e.field;return T.a.createElement(zn,Object.assign({},t,{multiple:!1,label:"City",onChange:function(e,t){return n(t,e)},placeholder:"Type to search.. (e.g. Jaipur)",creatable:!0}))}}),T.a.createElement(fe,{name:"latitude",label:"Latitude",placeholder:"27\xb0 2' 9.6252'' N"}),T.a.createElement(fe,{name:"longitude",label:"Longitude",placeholder:"88\xb0 15' 45.6192'' E"}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function Zn(e){return T.a.createElement(ce,null,T.a.createElement(F.a,{to:"new",className:"float-right btn"},"New Location"),T.a.createElement("h2",null,"Locations"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(Xn,{path:"/new"}),T.a.createElement(Qn,{path:"/"})))}var er="HOTEL_PAYMENT_PREFERENCES_STATE",tr={isFetching:!0,state:dt()},ar={list:Object(L.createAsyncAction)("@HOTEL_PAYMENT_PREFERENCES/LIST_FETCH_REQUEST","@HOTEL_PAYMENT_PREFERENCES/LIST_FETCH_SUCCESS","@HOTEL_PAYMENT_PREFERENCES/LIST_FETCH_FAILED")()},nr=pt(tr,ar);function rr(e){var t=e[er];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function cr(e){return{getHotelPaymentPreferences:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/hotel-payment-preferences",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getHotelPaymentReferences:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/hotel-payment-preferences/references",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var lr=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(ar.list.request()),t.abrupt("return",cr(c).getHotelPaymentPreferences(e).then(function(e){return a(ar.list.success(e)),e.data}).catch(function(e){return a(ar.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function ir(){var e=Z();return Object(w.useCallback)(function(t){return e(lr(t))},[e])}function ur(){return Object(H.a)({},Object(N.c)(function(e){var t=rr(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,hotelPaymentPreferences:t.get()})}),{fetchHotelPaymentPreferences:ir()})}function or(e){var t=Ct(),a=Object(Qe.a)(t,2),n=a[0],r=a[1],c=ur(),l=c.hotelPaymentPreferences,i=c.fetchHotelPaymentPreferences,u=c.total,o=c.from,s=c.to,m=c.isFetching,d=c.currentPage,f=c.lastPage;return Object(w.useEffect)(function(){i({page:d})},[i]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Hotel Payment Preferences List")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(Pt,{onSearch:function(e){r(e),i(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:u,from:o,to:s,currentPage:d,lastPage:f,isFetching:m,onChange:function(e){return i(Object(H.a)({},n,{page:e}))}}))),T.a.createElement(xt,{total:u,isFetching:m},T.a.createElement(A.m,{headers:["Description"],bordered:!0,striped:!0,rows:l.map(function(e){return[e.name]})})))}var sr=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return cr(t).getHotelPaymentPreferences({q:e}).then(function(e){return e.data})}}))}),mr=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return cr(t).getHotelPaymentReferences({q:e}).then(function(e){return e.data})}}))}),dr=R.object().shape({breakdowns:R.array().of(R.object().shape({reference:R.object().required("Reference field is required"),day_offset:R.number().integer().required("Day offset field is required"),amount_share:R.number().integer().positive("Amount share should be positive integer").max(100,"Amount share can not be greater then 100").required("Amount share field is required")})).min(1,"Atleast on breakdown is required.")}),fr={breakdowns:[{reference:void 0,day_offset:0,amount_share:100}]};var pr=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"New Trip Stage")),T.a.createElement(M.e,{initialValues:fr,validationSchema:dr,onSubmit:function(e,n){n.setStatus();var r=e.breakdowns.reduce(function(e,t){return e+t.amount_share},0);return 100!==r?(n.setStatus("Total amount share(".concat(r,") should be 100%")),void n.setSubmitting(!1)):t.post("/hotel-payment-preferences",{breakdowns:e.breakdowns.map(function(e){return Object(H.a)({},e,{reference:e.reference?e.reference.id:null})})}).then(function(e){e.data,a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status,n=e.values,r=e.setFieldValue;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add new Hotel Payment Preferences"),T.a.createElement(M.c,{name:"breakdowns",render:function(e){var t=e.name,a=e.push,c=e.remove;return T.a.createElement("ul",{className:"list"},n.breakdowns.map(function(e,a,n){return T.a.createElement(rt,{as:"li",key:a},T.a.createElement(ct,{md:3},T.a.createElement(de,{name:"".concat(t,".").concat(a,".reference"),render:function(e){var t=e.field;return T.a.createElement(mr,Object.assign({},t,{label:"Reference Event",required:!0,fetchOnMount:!0,multiple:!1,onChange:function(e,t){return r(t,e)}}))}})),T.a.createElement(ct,{md:3},T.a.createElement(fe,{label:"Day offset from reference",name:"".concat(t,".").concat(a,".day_offset"),required:!0,type:"number"})),T.a.createElement(ct,{md:3},T.a.createElement(fe,{label:T.a.createElement("span",{className:"whitespace-pre"},"Amount share from total amount"),name:"".concat(t,".").concat(a,".amount_share"),required:!0,type:"number",min:1,max:100})),T.a.createElement(ct,{md:3,className:"d-flex align-items-center"},n.length>1?T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){return c(a)}},"\xd7 Remove"):null))}),T.a.createElement("li",{key:"add_more"},T.a.createElement(A.d,{onClick:function(){return a({amount_share:100-n.breakdowns[0].amount_share})}},"+ Add More")))}}),a?T.a.createElement("div",{className:"text--error"},a):null,T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function Er(e){return T.a.createElement(ce,null,T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement("h2",{className:"white-space-pre"},"Hotel Payment Preferences")),T.a.createElement(ct,{className:"d-flex align-items-center justify-content-end"},T.a.createElement(F.a,{to:"new",className:"btn"},"New Hotel Payment Preference"))),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(pr,{path:"/new"}),T.a.createElement(or,{path:"/"})))}var hr=R.object().shape({name:R.string().required("Name field is required"),stars:R.number().positive("Star rating field should a positive integer.").integer("Star rating field should be positive integer").required("Stars rating field is required"),extra_bed_child_age_start:R.number().positive("Child start age should be a positive number").integer("Child start age should be an integer").required("Child start age is required"),extra_bed_child_age_end:R.number().positive("Child end age should be a positive number").integer("Child end age should be an integer").required("Child end age is required"),meal_plans:R.array().min(1,"Please select atleast one meal plan"),room_types:R.array().of(R.object().shape({room_types:R.array().min(1,"Please select atleast one room type").required("Please select a room type"),allowed_extra_beds:R.number().typeError("Allowed extra bed must be a number").integer("Allowed extra beds should be an integer").min(0,"Allowed extra beds should not be negative").required("Allowed extra beds field is required")})).min(1,"Please select atleast one room type"),location:R.object().required("Location field is required")}),br={name:"",stars:1,extra_bed_child_age_start:6,extra_bed_child_age_end:12,meal_plans:[],room_types:[{room_types:[],allowed_extra_beds:1}],location:void 0};var gr=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"New Hotel")),T.a.createElement(M.e,{initialValues:br,validationSchema:hr,onSubmit:function(e,n){n.setStatus(),t.post("/hotels",Object(H.a)({},e,{meal_plans:e.meal_plans.map(function(e){return e.id}),room_types:e.room_types.reduce(function(e,t){var a=t.room_types,n=t.allowed_extra_beds;return e.concat(a.map(function(e){return{room_type_id:e.id,allowed_extra_beds:n}}))},[]),location_id:e.location?e.location.id:void 0,payment_preference_id:e.payment_preference?e.payment_preference.id:void 0})).then(function(e){var t=e.data.data;a&&a("../".concat(t.id)),n.setSubmitting(!1)}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.setFieldValue,n=e.values,r=e.status;return T.a.createElement(M.d,{noValidate:!0},r?T.a.createElement("div",null,r):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add Hotel"),T.a.createElement(rt,null,T.a.createElement(ct,{lg:!0,md:4,sm:6,xs:12},T.a.createElement(fe,{label:"Name",name:"name",placeholder:"Taj Hotel",required:!0})),T.a.createElement(ct,{lg:!0,md:4,sm:6,xs:12},T.a.createElement(de,{name:"location",render:function(e){var t=e.field;return T.a.createElement(Gn,Object.assign({},t,{label:"Location",multiple:!1,onChange:function(e,t){return a(t,e)}}))}})),T.a.createElement(ct,{lg:!0,md:4,sm:6},T.a.createElement(de,{name:"payment_preference",render:function(e){var t=e.field;return T.a.createElement(sr,Object.assign({},t,{label:"Payment Preference",multiple:!1,onChange:function(e,t){return a(t,e)},fetchOnMount:!0}))}})),T.a.createElement(ct,{lg:!0,md:4,sm:4,xs:8},T.a.createElement(de,{name:"meal_plans",render:function(e){var t=e.field;return T.a.createElement(Ja,Object.assign({},t,{label:"Meal Plan(s) served",onChange:function(e,t){return a(t,e)},fetchOnMount:!0}))}})),T.a.createElement(ct,{lg:1,md:4,sm:2,xs:4},T.a.createElement(fe,{label:"Stars",name:"stars",type:"number",required:!0,max:5,min:1}))),T.a.createElement(M.c,{name:"room_types",render:function(e){var t=e.name,r=e.push,c=e.remove;return T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Room Type(s) Available"),T.a.createElement("ul",{className:"list"},n.room_types.map(function(e,n,r){return T.a.createElement("li",{key:n},T.a.createElement(rt,null,T.a.createElement(ct,{xs:"auto"},T.a.createElement(de,{name:"".concat(t,".").concat(n,".room_types"),render:function(e){var t=e.field;return T.a.createElement(mn,Object.assign({},t,{label:"Room Types",fetchOnMount:!0,onChange:function(e,t){return a(t,e)}}))}})),T.a.createElement(ct,{xs:"auto"},T.a.createElement(fe,{label:"Allowed extra bed(s)",type:"number",name:"".concat(t,".").concat(n,".allowed_extra_beds"),value:e.allowed_extra_beds,min:0})),T.a.createElement(ct,{xs:"auto",className:"d-flex align-items-center"},r.length>1?T.a.createElement(A.d,{onClick:function(e){return c(n)},className:"btn--secondary"},"\xd7 Remove"):null)))}),T.a.createElement("li",null,T.a.createElement(A.d,{onClick:function(e){return r(n.room_types[0])}},"+ Add More Room Types"))))}}),T.a.createElement(rt,null,T.a.createElement(ct,{sm:"auto"},T.a.createElement(fe,{label:"Extra bed child start age",name:"extra_bed_child_age_start",required:!0,type:"number",min:1})),T.a.createElement(ct,{sm:"auto"},T.a.createElement(fe,{label:"Extra bed child end age",name:"extra_bed_child_age_end",required:!0,type:"number",min:1}))),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function vr(e){return T.a.createElement(ce,null,T.a.createElement("div",{className:"float-right button-group"},T.a.createElement(F.a,{to:"/hotel-prices",className:"btn"},"Hotel Prices"),T.a.createElement(F.a,{to:"/hotel-prices/upload-prices",className:"btn"},"Upload Prices"),T.a.createElement(F.a,{to:"new",className:"btn"},"New Hotel")),T.a.createElement("h2",null,"Hotels"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(gr,{path:"new"}),T.a.createElement(In,{path:":hotelId/*"}),T.a.createElement(ja,{path:"/"})))}var _r="CAB_TYPES_STATE",yr={isFetching:!0,state:dt()},Sr={list:Object(L.createAsyncAction)("@CAB_TYPES/LIST_FETCH_REQUEST","@CAB_TYPES/LIST_FETCH_SUCCESS","@CAB_TYPES/LIST_FETCH_FAILED")()},jr=pt(yr,Sr);function Or(e){var t=e[_r];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function wr(e){return{getCabTypes:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/cab-types",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Tr=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Sr.list.request()),t.abrupt("return",wr(c).getCabTypes(e).then(function(e){var t=e.data,n=e.meta;return a(Sr.list.success({data:t,meta:n})),t}).catch(function(e){return a(Sr.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function xr(){var e=Z();return Object(w.useCallback)(function(t){return e(Tr(t))},[e])}function Cr(){return Object(H.a)({},Object(N.c)(function(e){var t=Or(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,cabTypes:t.get()})}),{fetchCabTypes:xr()})}function Nr(e){var t=Cr(),a=t.cabTypes,n=t.isFetching,r=t.total,c=t.currentPage,l=t.lastPage,i=t.from,u=t.to,o=t.fetchCabTypes,s=Ct(),m=Object(Qe.a)(s,2),d=m[0],f=m[1];return Object(w.useEffect)(function(){o({page:c})},[o]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Cab Types")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(Pt,{onSearch:function(e){f(e),o(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:r,from:i,to:u,currentPage:c,lastPage:l,isFetching:n,onChange:function(e){return o(Object(H.a)({},d,{page:e}))}}))),T.a.createElement(xt,{isFetching:n,total:r},T.a.createElement(A.m,{headers:["Name","Capacity"],alignCols:{1:"right"},bordered:!0,striped:!0,rows:a.map(function(e){return[e.name,e.capacity]})})))}var kr=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return wr(t).getCabTypes({q:e}).then(function(e){return e.data})}}))}),Pr=R.object().shape({name:R.string().required("Name field is required"),capacity:R.number().positive("Capacity should be a positive integer").integer("Capacity should be a positive integer").required("Capacity field is required")}),qr={name:"",capacity:4};var Fr=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"New Cab Type")),T.a.createElement(M.e,{initialValues:qr,validationSchema:Pr,onSubmit:function(e,n){n.setStatus(),t.post("/cab-types",e).then(function(){a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status;return T.a.createElement(M.d,{noValidate:!0},a?T.a.createElement("div",null,a):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add Cab Type"),T.a.createElement(fe,{label:"Name",name:"name",placeholder:"Medium",required:!0}),T.a.createElement(fe,{label:"Capacity",name:"capacity",required:!0,type:"number",min:1}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function Ar(e){return T.a.createElement(ce,null,T.a.createElement(F.a,{to:"new",className:"btn float-right"},"New Cab Type"),T.a.createElement("h2",null,"Cab Types"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(Fr,{path:"/new"}),T.a.createElement(Nr,{path:"/"})))}var Ir="CAB_LIST_STATE",Dr={isFetching:!0,state:dt()},Yr={list:Object(L.createAsyncAction)("@CABS/LIST_FETCH_REQUEST","@CABS/LIST_FETCH_SUCCESS","@CABS/LIST_FETCH_FAILED")(),item:Object(L.createAsyncAction)("@CABS/ITEM_FETCH_REQUEST","@CABS/ITEM_FETCH_SUCCESS","@CABS/ITEM_FETCH_FAILED")()},Mr=pt(Dr,Yr);function Rr(e){var t=e[Ir];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function Hr(e){return{getCab:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/cabs/".concat(a)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Lr=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Yr.item.request()),t.abrupt("return",Hr(c).getCab(e).then(function(e){return a(Yr.item.success(e)),e}).catch(function(e){return a(Yr.item.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Ur(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(e){return Object(N.c)(function(t){var a=Rr(t);return{isFetching:a.isFetching,cab:a.getItem(e)}})}(e),n=function(){var e=Z();return Object(w.useCallback)(function(t){return e(Lr(t))},[e])}();return Object(w.useEffect)(function(){t&&e&&n(e)},[e,t,n]),Object(H.a)({},a,{fetchCab:n})}function Vr(e){var t=e.cabId,a=e.navigate,n=Ur(t,!0),r=n.cab,c=n.isFetching;return t?T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,r?r.number_plate:""," Cab")),T.a.createElement(F.a,{to:".."},"Back to list"),c?"Loading...":r?T.a.createElement("div",null,r.name," - ",r.cab_type.name," - ",r.number_plate,T.a.createElement("br",null),"Created at:"," ",We.a.utc(r.created_at).local().toLocaleString(),T.a.createElement("br",null)):T.a.createElement(F.d,{noThrow:!0,to:"/cabs"})):(a&&a("/cabs"),null)}function Br(e){return{getCabs:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/cabs",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Qr=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Yr.list.request()),t.abrupt("return",Br(c).getCabs(e).then(function(e){var t=e.data,n=e.meta;return a(Yr.list.success({data:t,meta:n})),t}).catch(function(e){return a(Yr.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Gr(){var e=Object(N.b)();return Object(w.useCallback)(function(t){return e(Qr(t))},[e])}function Wr(){return Object(H.a)({},Object(N.c)(function(e){var t=Rr(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,cabs:t.get()})}),{fetchCabs:Gr()})}function Kr(e){var t=Wr(),a=t.cabs,n=t.total,r=t.from,c=t.to,l=t.currentPage,i=t.lastPage,u=t.isFetching,o=t.fetchCabs,s=Ct(),m=Object(Qe.a)(s,2),d=m[0],f=m[1];return Object(w.useEffect)(function(){o({page:l})},[o]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Cabs")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(kt,{onSearch:function(e){f(e),o(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:n,from:r,to:c,currentPage:l,lastPage:i,isFetching:u,onChange:function(e){return o(Object(H.a)({},d,{page:e}))}}))),T.a.createElement(Tt,{isFetching:u,total:n},T.a.createElement(A.m,{headers:["Name","Number Plate"],striped:!0,bordered:!0,rows:a.map(function(e){return[T.a.createElement(F.a,{to:e.id.toString()},e.name),e.number_plate]})})))}Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0,fetch:function(e){return Br(t).getCabs({q:e}).then(function(e){return e.data})}},a))});var zr=R.object().shape({name:R.string().required("Name for the cab is required."),number_plate:R.string().required("Number Plate is required").max(299,"Maximum 299 characters allowed"),cab_type:R.object().required("Cab type is required")}),Jr={name:"",number_plate:"",cab_type:void 0};var $r=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement("div",null,T.a.createElement(M.e,{initialValues:Jr,validationSchema:zr,onSubmit:function(e,n){var r=e.number_plate,c=e.cab_type,l=e.name;if(r&&c&&l)return n.setStatus(),t.post("/cabs",{name:l,number_plate:r,cab_type_id:c.id}).then(function(e){var t=e.data.data;a&&a("../".concat(t.id)),n.setSubmitting(!1)}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)});n.setStatus("Please fill the required fields")},render:function(e){var t=e.isSubmitting,a=e.status,n=e.setFieldValue;return T.a.createElement(M.d,{noValidate:!0},a?T.a.createElement("div",null,a):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add New Cab"),T.a.createElement(fe,{label:"Name",name:"name",required:!0,placeholder:"Suzuki Wagon R"}),T.a.createElement(de,{name:"cab_type",render:function(e){var t=e.field;return T.a.createElement(kr,Object.assign({},t,{label:"Cab Type",multiple:!1,placeholder:"Type to search... (e.g. Wagon)",onChange:function(e,t){return n(t,e)}}))}}),T.a.createElement(fe,{label:"Number Plate",name:"number_plate",required:!0,placeholder:"RJ18 CC 7838"}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Submit"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function Xr(e){return T.a.createElement(ce,null,T.a.createElement(F.a,{to:"new",className:"btn float-right"},"Add New Cab"),T.a.createElement("h2",null,"Cabs"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement($r,{path:"/new"}),T.a.createElement(Vr,{path:":cabId"}),T.a.createElement(Kr,{path:"/"})))}var Zr="TRIP_LIST_STATE",ec={isFetching:!0,state:dt()},tc={list:Object(L.createAsyncAction)("@TRIPS/LIST_FETCH_REQUEST","@TRIPS/LIST_FETCH_SUCCESS","@TRIPS/LIST_FETCH_FAILED")(),item:Object(L.createAsyncAction)("@TRIPS/ITEM_FETCH_REQUEST","@TRIPS/ITEM_FETCH_SUCCESS","@TRIPS/ITEM_FETCH_FAILED")()},ac=pt(ec,tc);function nc(e){var t=e[Zr];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}var rc="TRIP_STAGES_STATE",cc={isFetching:!0,state:dt()},lc={list:Object(L.createAsyncAction)("@TRIP_STAGES/LIST_FETCH_REQUEST","@TRIP_STAGES/LIST_FETCH_SUCCESS","@TRIP_STAGES/LIST_FETCH_FAILED")()},ic=pt(cc,lc);function uc(e){var t=e[rc];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function oc(e){return{getTripStages:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/trip-stages",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var sc=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(lc.list.request()),t.abrupt("return",oc(c).getTripStages(e).then(function(e){return a(lc.list.success(e)),e.data}).catch(function(e){return a(lc.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function mc(){var e=Z();return Object(w.useCallback)(function(t){return e(sc(t))},[e])}function dc(){return Object(H.a)({},Object(N.c)(function(e){var t=uc(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,tripStages:t.get()})}),{fetchTripStages:mc()})}function fc(e){Object(wt.a)(e);var t=Ct(),a=Object(Qe.a)(t,2),n=a[0],r=a[1],c=dc(),l=c.fetchTripStages,i=c.tripStages,u=c.total,o=c.from,s=c.to,m=c.currentPage,d=c.lastPage,f=c.isFetching;return Object(w.useEffect)(function(){l({page:m})},[l]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Trip Stages")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(Pt,{onSearch:function(e){r(e),l(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:u,from:o,to:s,currentPage:m,lastPage:d,isFetching:f,onChange:function(e){return l(Object(H.a)({},n,{page:e}))}}))),T.a.createElement(xt,{total:u,isFetching:f},T.a.createElement(A.m,{striped:!0,bordered:!0,headers:["Name","Description"],rows:i.map(function(e){return[e.name,e.description]})})))}var pc=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return oc(t).getTripStages({q:e}).then(function(e){return e.data})}}))}),Ec=R.object().shape({name:R.string().required("Name field is required"),description:R.string().required("Description field is required")}),hc={name:"",description:""};var bc=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"New Trip Stage")),T.a.createElement(M.e,{initialValues:hc,validationSchema:Ec,onSubmit:function(e,n){return n.setStatus(),t.post("/trip-stages",e).then(function(e){e.data,a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status;return T.a.createElement(M.d,{noValidate:!0},a?T.a.createElement("div",null,a):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add new Trip Stage"),T.a.createElement(fe,{label:"Name",name:"name",placeholder:"Converted",required:!0}),T.a.createElement(fe,{label:"Description",name:"description",placeholder:"Trip Converted",required:!0}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function gc(e){return T.a.createElement(ce,null,T.a.createElement(F.a,{to:"new",className:"float-right btn"},"New Trip Stage"),T.a.createElement("h2",null,"Trip Stages"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(bc,{path:"/new"}),T.a.createElement(fc,{path:"/"})))}a(144);function vc(e,t){return{getTags:function(){var a=Object(Y.a)(D.a.mark(function a(n){return D.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",e.get("/".concat(t,"-tags"),{params:n}).then(function(e){return e.data}));case 1:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}(),storeTags:function(){var a=Object(Y.a)(D.a.mark(function a(n,r){return D.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",e.post("/".concat(t,"-tags"),{items:n,tags:r}).then(function(e){return e.data}));case 1:case"end":return a.stop()}},a)}));return function(e,t){return a.apply(this,arguments)}}()}}var _c=Ce(function(e){var t=e.xhr,a=e.type,n=Object(ie.a)(e,["xhr","type"]);return T.a.createElement(A.a,Object.assign({multiple:!0,creatable:!0},n,{fetch:function(e){return vc(t,a).getTags({q:e}).then(function(e){return e.data})}}))});function yc(e){return{getTrips:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/trips",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Sc=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(tc.list.request()),t.abrupt("return",yc(c).getTrips(e).then(function(e){return a(tc.list.success(e)),e.data}).catch(function(e){return a(tc.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function jc(){var e=Z();return Object(w.useCallback)(function(t){return e(Sc(t))},[e])}function Oc(){return Object(H.a)({},Object(N.c)(function(e){var t=nc(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,trips:t.get()})}),{fetchTrips:jc()})}function wc(e){Object(wt.a)(e);var t=Ct(),a=Object(Qe.a)(t,2),n=a[0],r=a[1],c=Oc(),l=c.trips,i=c.fetchTrips,u=c.total,o=c.from,s=c.to,m=c.currentPage,d=c.lastPage,f=c.isFetching;return Object(w.useEffect)(function(){i({page:m})},[i]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"List of trips")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(Pt,{placeholder:"Search by id, destination...",onSearch:function(e){r(e),i(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:u,from:o,to:s,currentPage:m,lastPage:d,isFetching:f,onChange:function(e){return i(Object(H.a)({},n,{page:e}))}}))),T.a.createElement(rt,null,T.a.createElement(ct,{md:"auto"},T.a.createElement(Tc,{onChange:function(e){var t=e.stages,a=void 0===t?[]:t,r=e.tags,c=void 0===r?[]:r;i(Object(H.a)({stages:a.map(function(e){return e.name}),tags:c.map(function(e){return e.name})},n,{page:1}))}})),T.a.createElement(ct,null,T.a.createElement(xt,{total:u,isFetching:f},T.a.createElement(A.m,{striped:!0,bordered:!0,responsive:!0,headers:["Destinations","Dates","Traveler","Stage","Teams"],rows:l.map(function(e){var t=e.id,a=e.trip_source,n=e.trip_id,r=e.start_date,c=e.end_date,l=e.locations,i=e.no_of_adults,u=e.children,o=e.contact,s=e.latest_stage,m=e.created_by,d=e.created_at,f=e.latest_given_quote,p=e.sales_team,E=void 0===p?[]:p,h=e.operations_team,b=void 0===h?[]:h;return[T.a.createElement("div",null,T.a.createElement("div",null,T.a.createElement(F.a,{to:t.toString()},n||t,"-",a.short_name)),T.a.createElement("div",null,l.map(function(e){return e.short_name}).join(" \u2022\xa0"),f?T.a.createElement("small",null," ","(",f.locations.map(function(e){return e.short_name}).join("-"),")"):null)),T.a.createElement("div",null,T.a.createElement("div",null,We.a.utc(r).local().format("Do MMM, YYYY")," ","\u2022 ",We()(c).diff(r,"days")," Nights"),T.a.createElement("small",null,"(",We.a.utc().isBefore(r)?"".concat(We.a.utc(r).local().diff(We()(),"days")," days remaining"):We.a.utc().isAfter(c)?"".concat(We.a.utc().diff(c,"days")," days ago"):"On Trip",")")),o?T.a.createElement("div",null,T.a.createElement("div",null,o.name),T.a.createElement("small",null,i," Adults",u?" with "+u:"",o.phone_number||o.email?" \u2022 ":"",o.phone_number?T.a.createElement("a",{href:"tel:".concat(o.phone_number)},o.phone_number):null,o.phone_number&&o.email?" \u2022 ":"",o.email?T.a.createElement("a",{href:"mailto:".concat(o.email)},o.email):null)):null,T.a.createElement("div",null,T.a.createElement("div",null,s?s.name:"Initiated"),T.a.createElement("small",null,f?T.a.createElement("span",null,T.a.createElement(A.b,{primary:!0},T.a.createElement(A.i.RupeeIcon,null)," ",X(f.given_price))," ","by ",f.created_by.name," \u2022 ",We.a.utc(d).local().fromNow()):T.a.createElement("span",null,"Initiated by ",m.name," \u2022"," ",We.a.utc(d).local().fromNow()))),T.a.createElement("div",null,T.a.createElement("div",null,"Sales Team:"," ",E.map(function(e){return e.name}).join(" \u2022 ")),T.a.createElement("div",null,"Ops Team:"," ",b.map(function(e){return e.name}).join(" \u2022 ")))]})})))))}function Tc(e){var t=e.label,a=void 0===t?"Filters":t,n=e.onChange;return T.a.createElement(M.e,{initialValues:{},onSubmit:function(e){n(e)},render:function(e){var t=e.setFieldValue;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("h5",{className:"mb-4 border-b"},a),T.a.createElement(de,{name:"stages",render:function(e){var a=e.field;return T.a.createElement(pc,Object.assign({},a,{label:"Trip Stage",fetchOnMount:!0,placeholder:"Select stage(s)...",onChange:function(e,a){return t(a,e)}}))}}),T.a.createElement(de,{name:"tags",render:function(e){var a=e.field;return T.a.createElement(_c,Object.assign({},a,{type:"trip",label:"Tags",placeholder:"Search and select tag(s)...",onChange:function(e,a){return t(a,e)}}))}}),T.a.createElement(pe,{onChange:function(e){var t=e.values;n(t)}}),T.a.createElement(A.d,{type:"submit"},"Filter"))}})}var xc="HOTEL_BOOKING_STAGES_STATE",Cc={isFetching:!0,state:dt()},Nc={list:Object(L.createAsyncAction)("@HOTEL_BOOKING_STAGES/LIST_FETCH_REQUEST","@HOTEL_BOOKING_STAGES/LIST_FETCH_SUCCESS","@HOTEL_BOOKING_STAGES/LIST_FETCH_FAILED")()},kc=pt(Cc,Nc);function Pc(e){var t=e[xc];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function qc(e){return{getHotelBookingStages:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/hotel-booking-stages",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Fc=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Nc.list.request()),t.abrupt("return",qc(c).getHotelBookingStages(e).then(function(e){var t=e.data,n=e.meta;return a(Nc.list.success({data:t,meta:n})),t}).catch(function(e){return a(Nc.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Ac(){var e=Z();return Object(w.useCallback)(function(t){return e(Fc(t))},[e])}function Ic(){return Object(H.a)({},Object(N.c)(function(e){var t=Pc(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,hotelBookingStages:t.get()})}),{fetchHotelBookingStages:Ac()})}function Dc(e){var t=Ic(),a=t.hotelBookingStages,n=t.total,r=t.from,c=t.to,l=t.isFetching,i=t.currentPage,u=t.lastPage,o=t.fetchHotelBookingStages,s=Ct(),m=Object(Qe.a)(s,2),d=m[0],f=m[1];return Object(w.useEffect)(function(){o({page:i})},[o]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Hotel Booking Stages")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(Pt,{onSearch:function(e){f(e),o(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:n,from:r,to:c,currentPage:i,lastPage:u,isFetching:l,onChange:function(e){return o(Object(H.a)({},d,{page:e}))}}))),T.a.createElement(xt,{total:n,isFetching:l},T.a.createElement(A.m,{bordered:!0,striped:!0,headers:["Name","Description"],rows:a.map(function(e){return[e.name,e.description]})})))}var Yc=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return qc(t).getHotelBookingStages({q:e}).then(function(e){return e.data})}}))}),Mc=R.object().shape({name:R.string().required("Name field is required"),description:R.string().required("Description field is required")}),Rc={name:"",description:""};var Hc=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"New Hotel Booking Stage")),T.a.createElement(M.e,{initialValues:Rc,validationSchema:Mc,onSubmit:function(e,n){n.setStatus(),t.post("/hotel-booking-stages",e).then(function(){a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status;return T.a.createElement(M.d,{noValidate:!0},a?T.a.createElement("div",null,a):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add New Hotel Booking Stage"),T.a.createElement(fe,{label:"Name",name:"name",placeholder:"Booked",required:!0}),T.a.createElement(fe,{label:"Description",name:"description",placeholder:"Hotel Booked",required:!0}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function Lc(e){return T.a.createElement(ce,null,T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement("h2",{className:"white-space-pre"},"Hotel Booking Stages")),T.a.createElement(ct,{className:"d-flex align-items-center justify-content-end"},T.a.createElement(F.a,{to:"new",className:"btn"},"New Hotel Booking Stage"))),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(Hc,{path:"/new"}),T.a.createElement(Dc,{path:"/"})))}function Uc(e){return{getQuotes:function(t,a){return e.get("/trips/".concat(t,"/quotes"),{params:a}).then(function(e){return e.data.data})},giveQuote:function(t){return e.post("/given-quotes",t).then(function(e){return e.data.data})},getInstalments:function(t){return e.get("/quote-instalments/".concat(t)).then(function(e){return e.data})},changeHotelBookingStage:function(t,a){return e.patch("/quote-hotel-booking-stages",{items:[t],stage:a})}}}var Vc=Ce(function(e){var t=e.xhr,a=e.quoteHotel,n=a.id,r=a.latest_booking_stage,c=Object(w.useState)(!1),l=Object(Qe.a)(c,2),i=l[0],u=l[1];return i?T.a.createElement("span",null,T.a.createElement(M.e,{initialValues:{stage:r},validationSchema:R.object().shape({stage:R.object().required("Stage field is required")}),onSubmit:function(e,a){e.stage?Uc(t).changeHotelBookingStage(n,e.stage.id).then(function(){window.location=window.location}):a.setSubmitting(!1)},render:function(e){var t=e.isSubmitting,a=e.setFieldValue;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Change Booking Stage"),T.a.createElement(de,{name:"stage",render:function(e){var t=e.field;return T.a.createElement(Yc,Object.assign({},t,{label:"Select the booking stage",multiple:!1,fetchOnMount:!0,onChange:function(e,t){return a(t,e)}}))}}),T.a.createElement("footer",null,T.a.createElement(A.d,{disabled:t,type:"submit"},"Save"),T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){return u(!1)}},"Cancel"))))}})):T.a.createElement("span",null,r?r.name:null,T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){return u(!0)}},"\u270e"))}),Bc=R.object().shape({given_price:R.number().positive("Given price should a positive number").required("Give price field is required"),comments:R.string()}).required("Quote data is required"),Qc=Ce(function(e){var t=e.quote,a=e.xhr,n=e.readOnly,r=void 0!==n&&n,c=e.navigate,l=e.showHotelBookingStatus,i=t.id,u=t.total_price,o=t.hotels,s=t.hotel_extras,m=t.cabs,d=t.transport_extras,f=t.other_extras,p=t.comments,E=t.created_by,h=t.created_at,b=t.trip_id,g=Object(A.n)(),v=Object(Qe.a)(g,3),_=v[0],y=v[1],S=v[2],j=Object(A.p)(function(){return Uc(a).getInstalments(i).then(function(e){return e.data})}),O=Object(Qe.a)(j,3),w=O[0],x=O[1],C=O[2].isFetching;return T.a.createElement("div",null,T.a.createElement("header",{className:"mb-4"},T.a.createElement("h6",null,"Cost Price: ",T.a.createElement(A.i.RupeeIcon,null)," ",X(u)," /-"),T.a.createElement("blockquote",null,p?T.a.createElement("p",null,p):null,T.a.createElement("em",null,"on"," ",We.a.utc(h).local().format("DD MMM, YYYY [at] hh:mm A")," ","by ",E.name,"<",E.email,">"))),o.length||s.length?T.a.createElement("section",null,T.a.createElement("div",{className:"flex"},T.a.createElement("span",{className:"inline-flex w-8 h-8 align-items-center justify-content-center bg-primary-100 rounded-full mr-2"},T.a.createElement(A.i.BedIcon,null)),T.a.createElement("div",{className:"w-full"},o.length?T.a.createElement("div",null,T.a.createElement("h6",null,"Accommodation"),T.a.createElement(A.m,{striped:!0,bordered:!0,caption:"Bellow are the details of daywise hotel accomodation and their prices",responsive:!0,headers:["Date","Hotels","Meal Plan","Rooms","Price"].concat(l?["Booking Stage"]:[]),alignCols:{4:"right",5:"center"},rows:o.map(function(e){var t=e.hotel,a=e.checkin,n=e.checkout,r=e.meal_plan,c=e.room_type,i=e.no_of_rooms,u=e.comments,o=e.given_price;return[T.a.createElement("span",{className:"whitespace-pre"},We.a.utc(a).local().format("DD MMM YYYY"),T.a.createElement("br",null),T.a.createElement("small",null,We.a.utc(n).diff(We.a.utc(a),"days")+1," ","Nights")),T.a.createElement("div",null,T.a.createElement("b",null,t.name),T.a.createElement("br",null),T.a.createElement("small",null,t.location.short_name,", ",t.stars," Star"),u?T.a.createElement("blockquote",null,u):null),r.name,T.a.createElement("div",null,c.name,T.a.createElement("br",null),T.a.createElement("small",null,i," Rooms")),X(o)].concat(l?[T.a.createElement(Vc,{quoteHotel:e})]:[])})})):null,s.length?T.a.createElement("div",null,T.a.createElement("h6",null,"Hotel Extra Services"),T.a.createElement(A.m,{striped:!0,bordered:!0,caption:"Extras services for hotels",responsive:!0,headers:["Service","Date","Hotel","Price"],alignCols:{3:"right"},rows:s.map(function(e){var t=e.service,a=e.date,n=e.hotel,r=e.given_price,c=e.comments;return[T.a.createElement("div",null,T.a.createElement("div",null,t.name),c?T.a.createElement("blockquote",null,c):null),a?T.a.createElement("span",{className:"whitespace-pre"},We.a.utc(a).local().format("DD MMM YYYY")," "):null,n&&n.name,X(r)]})})):null))):null,m.length||d.length?T.a.createElement("section",null,T.a.createElement("div",{className:"flex"},T.a.createElement("span",{className:"inline-flex w-8 h-8 align-items-center justify-content-center bg-primary-100 rounded-full mr-2"},T.a.createElement(A.i.BusIcon,null)),T.a.createElement("div",{className:"w-full"},m.length?T.a.createElement("div",null,T.a.createElement("h6",null,"Transportation"),T.a.createElement(A.m,{striped:!0,bordered:!0,caption:"Bellow are the details for the daywise transportation and their prices",responsive:!0,headers:["Date","Service","Cabs","Price"],alignCols:{3:"right"},rows:m.map(function(e){var t=e.from_date,a=e.to_date,n=e.cab_type,r=e.transport_service,c=e.cab_locality,l=e.no_of_cabs,i=e.comments,u=e.given_price;return[T.a.createElement("span",{className:"whitespace-pre"},We.a.utc(t).local().format("DD MMM YYYY")," ",T.a.createElement("br",null),T.a.createElement("small",null,We.a.utc(a).diff(We.a.utc(t),"days")+1," ","Days")),T.a.createElement("div",null,r.name,i?T.a.createElement("blockquote",null,i):null),T.a.createElement("div",null,n.name,T.a.createElement("br",null),T.a.createElement("small",null,l," cabs"),c?T.a.createElement("span",null," ","\u2022"," ",T.a.createElement("small",null,"Locality: ",c.short_name)):""),X(u)]})})):null,d.length?T.a.createElement("div",null,T.a.createElement("h6",null,"Transport Extra Services"),T.a.createElement(A.m,{striped:!0,bordered:!0,caption:"Extras services for Transportation",responsive:!0,headers:["Service","Date","Price"],alignCols:{2:"right"},rows:d.map(function(e){var t=e.service,a=e.date,n=e.given_price,r=e.comments;return[T.a.createElement("div",null,T.a.createElement("div",null,t.name),r?T.a.createElement("blockquote",null,r):null),a?T.a.createElement("span",{className:"whitespace-pre"},We.a.utc(a).local().format("DD MMM YYYY")," "):null,X(n)]})})):null))):null,f.length?T.a.createElement("section",null,T.a.createElement("div",{className:"flex"},T.a.createElement("span",{className:"inline-flex w-8 h-8 align-items-center justify-content-center bg-primary-100 rounded-full mr-2"},T.a.createElement(A.i.StarEmptyIcon,null)),T.a.createElement("div",{className:"w-full"},T.a.createElement("h6",null,"Other Services"),T.a.createElement(A.m,{striped:!0,bordered:!0,caption:"Other Services provided with this quote",responsive:!0,headers:["Service","Date","Price"],alignCols:{2:"right"},rows:f.map(function(e){var t=e.service,a=e.date,n=e.given_price,r=e.comments;return[T.a.createElement("div",null,T.a.createElement("div",null,t.name),r?T.a.createElement("blockquote",null,r):null),a?T.a.createElement("span",{className:"whitespace-pre"},We.a.utc(a).local().format("DD MMM YYYY")," "):null,X(n)]})})))):null,r?null:T.a.createElement("div",null,T.a.createElement(A.e,null,T.a.createElement(A.d,{onClick:y},"Give this quote"),T.a.createElement(A.f,{open:_,onClose:S},T.a.createElement(A.f.Header,null,T.a.createElement(A.f.Title,{as:"h4"},"Give this quote (price: ",t.total_price,")")),T.a.createElement(A.f.Body,null,T.a.createElement(M.e,{initialValues:{comments:"",factor:1.3,given_price:Math.ceil(1.3*t.total_price)},validationSchema:Bc,onSubmit:function(e,t){var n,r,l;window.confirm("Are you sure you want to give this quote to the customer?")?(n=i,r=e.given_price,l=e.comments,Uc(a).giveQuote({given_price:r,quote_id:n,comments:l})).then(S).then(function(){c&&c("../given-quotes")}):t.setSubmitting(!1)},render:function(e){var a=e.isSubmitting,n=e.setFieldValue;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement(fe,{label:"Multiplication Factor",name:"factor",type:"number",step:.01,onChange:function(e){n("given_price",Math.ceil(t.total_price*parseFloat(e.currentTarget.value))),n(e.currentTarget.name,e.currentTarget.value)}}),T.a.createElement(fe,{name:"given_price",label:"Given Price",type:"number"}),T.a.createElement(fe,{name:"comments",as:"textarea",label:"Any Comments",placeholder:"Write comments regarding prices or anything else..."}),T.a.createElement(A.f.Footer,null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:a},"Give Quote"),T.a.createElement(A.d,{onClick:S,className:"btn--secondary"},"Cancel")))}}))),T.a.createElement(A.d,{onClick:x},"Get Instalments for Hotels and Cabs"," ",C?T.a.createElement(_t,null):null),T.a.createElement(F.a,{to:"/trips/".concat(b,"/new-quote"),state:{quote:t},className:"btn"},"Edit")),w?T.a.createElement(A.m,{striped:!0,bordered:!0,headers:["Amount","Due Date"],alignCols:{0:"right"},autoWidth:!0,rows:w.map(function(e){return[e.amount.toFixed(2),We.a.utc(e.due_date).local().format("DD/MM/YYYY")]})}):null))});var Gc=Ce(function(e){var t=e.xhr,a=e.trip,n=e.navigate,r=Object(w.useState)([]),c=Object(Qe.a)(r,2),l=c[0],i=c[1];return Object(w.useEffect)(function(){Uc(t).getQuotes(a.id).then(i)},[]),T.a.createElement(w.Fragment,null,T.a.createElement("h4",{className:"my-4"},"All Quotes"),0===l.length?T.a.createElement("p",{className:"text-center"},"No quote created for this trip"):T.a.createElement("ol",null,l.map(function(e){return T.a.createElement("li",{key:e.id,className:"p-4 shadow rounded mb-8 bg-white"},T.a.createElement(Qc,{quote:e,navigate:n,readOnly:!!a.converted_at}))})))});function Wc(e){return{getGivenQuotes:function(t){return e.get("/given-quotes",{params:t}).then(function(e){return e.data.data})},getInstalments:function(t){return e.get("/given-quote-instalments/".concat(t)).then(function(e){return e.data})}}}var Kc=Ce(function(e){var t=e.givenQuote,a=e.xhr,n=e.readOnly,r=e.showHotelBookingStatus,c=t.id,l=t.given_price,i=t.quote,u=t.comments,o=t.created_by,s=t.created_at,m=Object(A.p)(function(){return Wc(a).getInstalments(c).then(function(e){return e.data})}),d=Object(Qe.a)(m,3),f=d[0],p=d[1],E=d[2].isFetching;return T.a.createElement("div",null,T.a.createElement("header",{className:"mb-8"},T.a.createElement("h5",null,"Given Price:"," ",T.a.createElement("mark",null,T.a.createElement(A.i.RupeeIcon,null)," ",X(l)," /-")),T.a.createElement("blockquote",null,u?T.a.createElement("p",null,u):null,T.a.createElement("em",null,"on"," ",We.a.utc(s).local().format("DD MMM, YYYY [at] hh:mm A")," ","by ",o.name,"<",o.email,">"))),T.a.createElement(Qc,{quote:i,readOnly:!0,showHotelBookingStatus:r}),n?null:T.a.createElement(A.d,{onClick:p},"Get Instalments for Customer"," ",E?T.a.createElement(_t,null):null),f?T.a.createElement(A.m,{striped:!0,bordered:!0,headers:["Amount","Due Date"],alignCols:{0:"right"},autoWidth:!0,rows:f.map(function(e){return[e.amount.toFixed(2),We.a.utc(e.due_date).local().format("DD/MM/YYYY")]})}):null)});var zc=Ce(function(e){var t=e.xhr,a=e.trip,n=Object(w.useState)([]),r=Object(Qe.a)(n,2),c=r[0],l=r[1];return Object(w.useEffect)(function(){Wc(t).getGivenQuotes({trip_id:a.id}).then(l)},[]),T.a.createElement(w.Fragment,null,T.a.createElement("h4",null,"Given Quotes"),0===c.length?T.a.createElement("p",{className:"text-center"},"No quote given yet"):T.a.createElement("ol",null,c.map(function(e){return T.a.createElement("li",{key:e.id,className:"p-4 shadow rounded mb-8 bg-white"},T.a.createElement(Kc,{givenQuote:e}))})))}),Jc="TRANSPORT_SERVICE_PRICES_STATE",$c={isFetching:!0,state:dt()},Xc={list:Object(L.createAsyncAction)("@TRANSPORT_SERVICE_PRICES/LIST_FETCH_REQUEST","@TRANSPORT_SERVICE_PRICES/LIST_FETCH_SUCCESS","@TRANSPORT_SERVICE_PRICES/LIST_FETCH_FAILED")()},Zc=pt($c,Xc);function el(e){var t=e[Jc];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function tl(e){return{getTransportServicePrices:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/cab-prices",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var al=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Xc.list.request()),t.abrupt("return",tl(c).getTransportServicePrices(e).then(function(e){var t=e.data,n=e.meta;return a(Xc.list.success({data:t,meta:n})),t}).catch(function(e){return a(Xc.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function nl(){var e=Object(N.c)(function(e){var t=el(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,transportServicePrices:t.get()})}),t=function(){var e=Z();return Object(w.useCallback)(function(t){return e(al(t))},[e])}();return Object(H.a)({},e,{fetchTransportServicePrices:t})}function rl(e){var t=nl(),a=t.fetchTransportServicePrices,n=t.transportServicePrices,r=t.total,c=t.from,l=t.to,i=t.currentPage,u=t.lastPage,o=t.isFetching,s=Ct(),m=Object(Qe.a)(s,2),d=m[0],f=m[1];return Object(w.useEffect)(function(){a({page:i})},[a]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Transport Service Prices Listing")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(Pt,{onSearch:function(e){f(e),a(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:r,from:c,to:l,currentPage:i,lastPage:u,isFetching:o,onChange:function(e){a(Object(H.a)({},d,{page:e}))}}))),T.a.createElement(xt,{total:r,isFetching:o},T.a.createElement(A.m,{bordered:!0,striped:!0,responsive:!0,headers:["Start Date","End Date","Cab Type","Service","Locality","Per Day","Per Day Parking","Fixed","/km","Toll","Parking","Night","Min Km/Day"],rows:n.map(function(e){var t=e.start_date,a=e.end_date,n=e.cab_type,r=e.cab_locality,c=e.transport_service,l=e.per_day_charges,i=e.per_day_parking_charges,u=e.price,o=e.per_km_charges,s=e.minimum_km_per_day,m=e.night_charges,d=e.parking_charges,f=e.toll_charges;return[We.a.utc(t).local().format("DD/MM/YYYY"),We.a.utc(a).local().format("DD/MM/YYYY"),n.name,c.name,r?r.name:"",X(l),X(i),X(u),o,f,d,m,X(s)]}),alignCols:{4:"right",5:"right",6:"right",7:"right",8:"right",9:"right"}})))}var cl={timezone_offset:(new Date).getTimezoneOffset(),file:"",file_name:""},ll=R.object().shape({timezone_offset:R.string().required(),file:R.mixed().required("File field is required"),file_name:R.string().required("File field is required")}),il=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement("div",null,T.a.createElement(M.e,{initialValues:cl,validationSchema:ll,onSubmit:function(e,n){var r=new FormData;r.set("timezone_offset",e.timezone_offset.toString()),r.set("file",e.file),t.post("/cab-prices",r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){a&&a("..")}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)}).then(function(){n.setSubmitting(!1)})},render:function(e){var t=e.setFieldValue,a=e.isSubmitting,n=e.status;return T.a.createElement(M.d,{noValidate:!0,encType:"multipart/form-data"},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Upload file to add cab prices"),n?T.a.createElement("p",{className:"text-red-700"},n):null,T.a.createElement(fe,{label:"Select a csv file",name:"file_name",type:"file",accept:".csv",onChange:function(e){var a=e.currentTarget;t("file",a.files?a.files[0]:""),t(a.name,a.value)}}),T.a.createElement("footer",null,T.a.createElement(A.d,{type:"submit",disabled:a,primary:!0},"Upload"),T.a.createElement(F.a,{className:"btn",to:".."},"Cancel"))))}}))});a(145);var ul=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(A.a,Object.assign({multiple:!0,creatable:!0},a,{fetch:function(e){return function(e){return{getTransportLocations:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/transport-locations",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}(t).getTransportLocations({q:e}).then(function(e){return e.data})}}))}),ol="TRANSPORT_SERVICES_STATE",sl={isFetching:!0,state:dt()},ml={list:Object(L.createAsyncAction)("@TRANSPORT_SERVICES/LIST_FETCH_REQUEST","@TRANSPORT_SERVICES/LIST_FETCH_SUCCESS","@TRANSPORT_SERVICES/LIST_FETCH_FAILED")()},dl=pt(sl,ml);function fl(e){var t=e[ol];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function pl(e){return{getTransportServices:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/transport-services",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var El=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(ml.list.request()),t.abrupt("return",pl(c).getTransportServices(e).then(function(e){return a(ml.list.success(e)),e.data}).catch(function(e){return a(ml.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function hl(){var e=Object(N.c)(function(e){var t=fl(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,transportServices:t.get()})}),t=function(){var e=Z();return Object(w.useCallback)(function(t){return e(El(t))},[e])}();return Object(H.a)({},e,{fetchTransportServices:t})}function bl(e){Object(wt.a)(e);var t=hl(),a=t.fetchTransportServices,n=t.transportServices,r=t.total,c=t.from,l=t.to,i=t.currentPage,u=t.lastPage,o=t.isFetching,s=Ct(),m=Object(Qe.a)(s,2),d=m[0],f=m[1];return Object(w.useEffect)(function(){a({page:i})},[a]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Transport Services List")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(Pt,{onSearch:function(e){f(e),a(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:r,from:c,to:l,isFetching:o,currentPage:i,lastPage:u,onChange:function(e){return a(Object(H.a)({},d,{page:e}))}}))),T.a.createElement(xt,{total:r,isFetching:o},T.a.createElement(A.m,{responsive:!0,striped:!0,bordered:!0,headers:["Destinations","Distance (kms)"],alignCols:{1:"right"},rows:n.map(function(e){var t=e.name,a=e.comments,n=e.distance;return[T.a.createElement("div",null,t,a?T.a.createElement("blockquote",null,a):null),n]})})))}var gl=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return pl(t).getTransportServices({q:e}).then(function(e){return e.data})}}))}),vl=R.object().shape({via:R.array().of(R.object().required("Destination is required")).min(1,"Atleast one locations required").required("Via field is required"),is_sightseeing:R.boolean(),distance:R.number().positive("Distance should be a positive number").integer("Distance should be an integer").required("Distance field is required"),comments:R.string()}),_l={via:[void 0],is_sightseeing:!1,distance:0,comments:""};var yl=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Add New Transport Service")),T.a.createElement(M.e,{initialValues:_l,validationSchema:vl,onSubmit:function(){var e=Object(Y.a)(D.a.mark(function e(n,r){var c,l,i;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setStatus(),c=n.via,l=n.is_sightseeing,i=Object(ie.a)(n,["via","is_sightseeing"]),e.abrupt("return",t.post("/transport-services",Object(H.a)({},i,{via:c.map(function(e){return e.name}),is_sightseeing:+!!l})).then(function(){a&&a(".."),r.setSubmitting(!1)}).catch(function(e){return r.setStatus(e.message),e.formikErrors&&r.setErrors(e.formikErrors),r.setSubmitting(!1),Promise.reject(e)}));case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),render:function(e){var t=e.isSubmitting,a=e.values,n=e.status,r=e.setFieldValue;return T.a.createElement(M.d,{noValidate:!0},n?T.a.createElement("div",null,n):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add New Transport Service"),T.a.createElement(M.c,{name:"via",render:function(e){var t=e.name,n=e.remove,c=e.push;return T.a.createElement("div",{className:"form-group"},T.a.createElement("p",null,"Add destinations for the transportation"),T.a.createElement(rt,null,a.via.map(function(e,a,c){return T.a.createElement(ct,{md:3,key:a,style:{marginBottom:"10px"}},T.a.createElement(de,{name:"".concat(t,".").concat(a),render:function(e){var t=e.field;return T.a.createElement(ul,Object.assign({},t,{label:"Destination",multiple:!1,onChange:function(e,t){return r(t,e)}}))}}),c.length>1?T.a.createElement(A.d,{onClick:function(e){return n(a)}},"\xd7 Remove"):null)})),T.a.createElement("hr",null),T.a.createElement(A.d,{onClick:function(e){return c(void 0)}},"+ Add More Destinations"))}}),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(fe,{name:"distance",type:"number",label:"Total distance for the transportation (in kms)",placeholder:"420",required:!0})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Any Comments",name:"comments",type:"text"})),T.a.createElement(ct,{className:"mt-4"},T.a.createElement(fe,{name:"is_sightseeing",type:"checkbox",label:"Includes sightseeing"}))),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function Sl(e){return T.a.createElement(ce,null,T.a.createElement("div",{className:"float-right button-group"},T.a.createElement(F.a,{to:"/transport-service-prices",className:"btn"},"Prices"),T.a.createElement(F.a,{to:"/transport-service-prices/upload-prices",className:"btn"},"Upload Prices"),T.a.createElement(F.a,{to:"new",className:"btn"},"New Transport Service")),T.a.createElement("h2",null,"Transport Services"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(yl,{path:"/new"}),T.a.createElement(bl,{path:"/"})))}var jl=R.object().shape({prices:R.array().of(R.object().shape({start_date:R.string().required("Start date is required"),end_date:R.string().required("End date is required"),cab_type:R.object().required("Cab type is required"),transport_service:R.object().required("Transport service is required"),cab_locality:R.object(),per_day_charges:ee(),per_day_parking_charges:ee(),price:ee(),per_km_charges:ee(),minimum_km_per_day:ee(),night_charges:ee(),toll_charges:ee(),parking_charges:ee()}))}),Ol={prices:[{start_date:"",end_date:"",cab_type:void 0,transport_service:void 0,cab_locality:void 0,per_day_charges:void 0,per_day_parking_charges:void 0,price:void 0,per_km_charges:void 0,minimum_km_per_day:void 0,toll_charges:void 0,night_charges:void 0,parking_charges:void 0}]};var wl=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement(M.e,{initialValues:Ol,validationSchema:jl,onSubmit:function(e,n){n.setStatus();var r=[];e.prices.forEach(function(e){var t=e.cab_type,a=e.transport_service,n=e.cab_locality,c=e.start_date,l=e.end_date,i=Object(ie.a)(e,["cab_type","transport_service","cab_locality","start_date","end_date"]);t&&a&&r.push(Object(H.a)({},i,{start_date:We()(c).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),end_date:We()(l).hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),cab_type_id:t.id,transport_service_id:a.id,cab_locality_id:n&&n.name}))}),function(e){return{storePrice:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/cab-prices",a).then(function(e){return e.data.cab_price}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}(t).storePrice({prices:r}).then(function(){n.setSubmitting(!1),a&&a("..")}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})},render:function(e){var t=e.status,a=e.isSubmitting,n=e.values,r=e.setFieldValue;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",{style:{minInlineSize:"auto"}},T.a.createElement("legend",null,"Add Transport Service Price"),T.a.createElement(M.c,{name:"prices",render:function(e){var t=e.name,a=e.push,c=e.remove;return T.a.createElement("ol",{className:"list"},n.prices.map(function(e,n,l){return T.a.createElement("li",{key:n},T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(hn,{label:"Start Date",name:"".concat(t,".").concat(n,".start_date"),required:!0})),T.a.createElement(ct,null,T.a.createElement(hn,{label:"End Date",name:"".concat(t,".").concat(n,".end_date"),required:!0})),T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(t,".").concat(n,".cab_type"),render:function(e){var t=e.field;return T.a.createElement(kr,Object.assign({},t,{label:"Cab Type",multiple:!1,required:!0,fetchOnMount:!0,onChange:function(e,t){return r(t,e)}}))}})),T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(t,".").concat(n,".transport_service"),render:function(e){var t=e.field;return T.a.createElement(gl,Object.assign({},t,{label:"Transport Service",multiple:!1,required:!0,fetchOnMount:!0,onChange:function(e,t){return r(t,e)}}))}})),T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(t,".").concat(n,".cab_locality"),render:function(e){var t=e.field;return T.a.createElement(ul,Object.assign({},t,{label:"Cab Locality",multiple:!1,fetchOnMount:!0,onChange:function(e,t){return r(t,e)}}))}}))),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(fe,{label:"Per Day Charges",name:"".concat(t,".").concat(n,".per_day_charges"),type:"number",min:0})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Per Day Parking Charges",name:"".concat(t,".").concat(n,".per_day_parking_charges"),type:"number",min:0})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Price (fixed Per Service)",name:"".concat(t,".").concat(n,".price"),type:"number",min:0})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Charges per Km",name:"".concat(t,".").concat(n,".per_km_charges"),type:"number",min:0})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Minimum Kms per Day",name:"".concat(t,".").concat(n,".minimum_km_per_day"),type:"number",min:0})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Toll charges per Km",name:"".concat(t,".").concat(n,".toll_charges"),type:"number",min:0})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Night Charges per Km",name:"".concat(t,".").concat(n,".night_charges"),type:"number",min:0})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Parking Charges per km",name:"".concat(t,".").concat(n,".parking_charges"),type:"number",min:0}))),T.a.createElement("div",{className:"button-group"},T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){return a(e)}},"+ Duplicate"),l.length>1?T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){return c(n)}},"\xd7 Remove"):null))}),T.a.createElement("div",{className:"form-group"},T.a.createElement("hr",null),T.a.createElement(A.d,{onClick:function(){return a(Ol.prices[0])}},"+ Add More Transport Prices")))}}),t?T.a.createElement("div",null,t):null,T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:a},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}})});function Tl(e){return{getPrice:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/prices",{params:{cabs:a}}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var xl=R.object().shape({cabs:R.array().of(R.object().shape({start_date:R.string().required("Start date field is required"),no_of_days:ee().positive("Number of days should be a positive integer").integer("Number of days should be a positive integer").required("Number of days is required."),cab_type:R.object().required("Cab type field is required"),transport_service:R.object().required("Service is required"),cab_locality:R.object().nullable(!0),no_of_cabs:ee().positive("Number of cabs should be a positive integer").integer("Number of cabs should be a positive integer.").required("Number of cabs is required")}))}),Cl={cabs:[{start_date:"",no_of_days:1,cab_type:void 0,transport_service:void 0,cab_locality:void 0,no_of_cabs:1,calculated_price:void 0,edited_given_price:!1,given_price:0,comments:""}]},Nl=Ce(function(e){var t=e.initialValues,a=e.shouldEmptyInitialValues,n=void 0!==a&&a,r=e.xhr,c=e.onChange,l=e.bookingFrom,i=e.bookingTo,u=t||(n?{cabs:[]}:Cl),o=Object(w.useCallback)(function(e){c&&c(e.cabs.reduce(function(e,t){return e+parseFloat((t.given_price?t.given_price:0).toString())},0),e.cabs.map(function(e){var t=e.start_date,a=e.no_of_days,n=e.cab_type,r=e.transport_service,c=e.cab_locality,l=Object(ie.a)(e,["start_date","no_of_days","cab_type","transport_service","cab_locality"]);return Object(H.a)({},l,{from_date:We()(t).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),to_date:We()(t).add(a-1,"days").hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),cab_type_id:n&&n.id,transport_service_id:r&&r.id,cab_locality_id:c&&c.id})}))},[c]);Object(A.o)(function(){o(u)});var s=Object(w.useMemo)(function(){for(var e=[],t=We()(i).diff(We()(l),"days"),a=0;a<=t;a++)e.push({id:a,name:We()(l).add(a,"day").format("YYYY-MM-DD")});return e},[l,i]),m=Object(w.useCallback)(function(){var e=Object(Y.a)(D.a.mark(function e(t,a){var n,c;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setStatus(),n=[],c={cabs:[]},t.cabs.forEach(function(e){var t=e.start_date,a=e.no_of_days,r=e.cab_type,l=e.transport_service,i=e.cab_locality,u=e.no_of_cabs;t&&a&&r&&l&&u&&(c.cabs.push(Object(H.a)({},e,{start_date:We()(t).format("YYYY-MM-DD"),no_of_days:a})),n.push({from_date:We()(t).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),to_date:We()(t).add(a-1,"days").hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),cab_type_id:r.id,transport_service_id:l.id,cab_locality_id:i?i.id:null,no_of_cabs:u}))}),e.abrupt("return",Tl(r).getPrice(n).then(function(e){c.cabs=c.cabs.map(function(t,a){return Object(H.a)({},t,{calculated_price:e.cabs[a].price,given_price:t.edited_given_price?t.given_price:e.cabs[a].price,no_price_for_dates:e.cabs[a].no_price_for_dates})}),a.setValues(c),o(c)}).catch(function(e){a.setStatus(e.message),e.formikErrors&&a.setErrors(e.formikErrors)}));case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),[r,o]),d=Object(w.useRef)(!0);return T.a.createElement(M.e,{initialValues:u,validationSchema:xl,onSubmit:function(e,t){return m(e,t).then(function(){t.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.values,n=e.status,r=e.setFieldValue;return T.a.createElement(M.d,{noValidate:!0},n?T.a.createElement("p",{className:"text-red-700 mb-2"},n):null,T.a.createElement(M.c,{name:"cabs",render:function(e){var n=e.name,c=e.push,u=e.remove;return T.a.createElement("div",null,a.cabs.map(function(e,a){return T.a.createElement("div",{key:a,className:"border-gray-300 border-b-4"},T.a.createElement(rt,null,T.a.createElement(ct,{md:7,className:"py-3"},T.a.createElement(rt,null,T.a.createElement(ct,null,l&&i?T.a.createElement(de,{name:"".concat(n,".").concat(a,".start_date"),render:function(t){var a=t.field;return T.a.createElement(A.l,Object.assign({},a,{label:"Start Date",options:s,searchable:!1,onQuery:function(){},value:s.find(function(t){return t.name===e.start_date}),placeholder:"Select a date...",required:!0,onChange:function(e,t){r(t,e.name)}}))}}):T.a.createElement(hn,{label:"Start Date",name:"".concat(n,".").concat(a,".start_date"),required:!0})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"No of days",name:"".concat(n,".").concat(a,".no_of_days"),type:"number",required:!0,min:1,max:1e4})),T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(n,".").concat(a,".cab_type"),render:function(e){var t=e.field;return T.a.createElement(kr,Object.assign({},t,{label:"Cab Type",multiple:!1,fetchOnMount:!0,onChange:function(e,t){return r(t,e)}}))}})),T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(n,".").concat(a,".transport_service"),render:function(e){var t=e.field;return T.a.createElement(gl,Object.assign({},t,{label:"Transport Service",multiple:!1,onChange:function(e,t){return r(t,e)}}))}})),T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(n,".").concat(a,".cab_locality"),render:function(e){var t=e.field;return T.a.createElement(ul,Object.assign({},t,{creatable:!1,label:"Cab Locality",multiple:!1,onChange:function(e,t){return r(t,e)}}))}})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"No of cabs",name:"".concat(n,".").concat(a,".no_of_cabs"),min:1,max:1e3,type:"number",required:!0})))),T.a.createElement(ct,{md:4,className:"md:border-l py-3"},T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(A.h,null,T.a.createElement("div",{className:"mb-1 white-space-pre"},"Calculated Price"),t?T.a.createElement(_t,null):void 0!==e.calculated_price?T.a.createElement(A.b,{primary:!0},T.a.createElement(A.i.RupeeIcon,null)," ",e.calculated_price):T.a.createElement(A.d,{type:"submit",disabled:t},"Get Price"),e.no_price_for_dates&&e.no_price_for_dates.length?T.a.createElement("p",{className:"text-yellow-800"},"No prices available for"," ",e.no_price_for_dates.map(function(e){return We.a.utc(e).local().format("Do MMM")}).join(", ")):null)),T.a.createElement(ct,null,T.a.createElement(A.h,null,T.a.createElement("label",null,"Given Price"),T.a.createElement(me,{name:"".concat(n,".").concat(a,".given_price"),type:"number",value:e.given_price,onChange:function(e){var t=parseInt(e.target.value,10);d.current=!1,r(e.target.name,t),r("".concat(n,".").concat(a,".edited_given_price"),!0)},min:0}))),T.a.createElement(ct,{sm:12},T.a.createElement(fe,{label:"Commets",name:"".concat(n,".").concat(a,".comments"),maxLength:191,value:e.comments,placeholder:"Regarding pricing difference or any other",className:"w-full",onChange:function(e){var t=e.target.value;d.current=!1,r(e.target.name,t)}})))),T.a.createElement(ct,{md:1,className:"text-right md:border-l py-3"},T.a.createElement(A.d,{className:"btn--secondary w-full",onClick:function(){return c(e)}},"+ Duplicate"),T.a.createElement(A.d,{className:"btn--secondary w-full",onClick:function(){return u(a)}},"\xd7 Remove"))))}),T.a.createElement("div",{className:"pt-4"},T.a.createElement(A.d,{onClick:function(){return c(Cl.cabs[0])}},"+ Add More Price Queries")))}}),T.a.createElement(pe,{onChange:function(e){o(e.values),d.current?e.isSubmitting||xl.validate(e.values).then(Object(Y.a)(D.a.mark(function t(){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSubmitting){t.next=2;break}return t.abrupt("return");case 2:return e.setSubmitting(!0),t.abrupt("return",m(e.values,e).then(function(){e.setSubmitting(!1)}));case 4:case"end":return t.stop()}},t)}))).catch(function(){}):d.current=!0}}))}})});function kl(e){var t=Object(w.useState)(0),a=Object(Qe.a)(t,2),n=a[0],r=a[1];return T.a.createElement("div",null,T.a.createElement("div",{className:"flex align-items-center mb-8"},T.a.createElement(F.a,{to:"..",className:"mr-4 text-blue-600 hover:text-blue-800 text-lg px-2 border rounded-full"},T.a.createElement(A.i.ChevronDownIcon,{className:"rotate-90"})),T.a.createElement("h3",{className:"m-0"},"Calculate Transportation Prices")),T.a.createElement("p",null,"Please enter your transportation query and press get price to get the prices."),T.a.createElement("div",{className:"bg-white px-4 pb-4 rounded shadow"},T.a.createElement(Nl,{onChange:function(e){return r(e)}})),T.a.createElement("footer",{className:"mt-4"},T.a.createElement("mark",{className:"inline-block text-2xl font-bold px-4 py-2 rounded"},"Total Price: ",X(n))))}function Pl(e){return T.a.createElement(ce,null,T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement("h2",{className:"white-space-pre"},"Transport Service Prices")),T.a.createElement(ct,{className:"text-right d-flex align-items-center justify-content-end"},T.a.createElement("div",{className:"button-group"},T.a.createElement(F.a,{to:"upload-prices",className:"btn"},"Upload Prices"),T.a.createElement(F.a,{to:"new",className:"btn"},"Add Prices"),T.a.createElement(F.a,{to:"calculate-price",className:"btn"},"Calculate Price")))),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(wl,{path:"/new"}),T.a.createElement(il,{path:"/upload-prices"}),T.a.createElement(kl,{path:"/calculate-price"}),T.a.createElement(rl,{path:"/"})))}var ql=R.object().shape({transport_extras:R.array().of(R.object().shape({service:R.object().typeError("Service field is required").required("Service field is required"),date:R.string(),price:ee().positive("Price should be positive"),comments:R.string()}))}),Fl={transport_extras:[{service:void 0,date:"",price:void 0,comments:""}]},Al=Ce(function(e){var t=e.initialValues,a=e.shouldEmptyInitialValues,n=void 0===a||a,r=e.xhr,c=e.onChange,l=e.bookingFrom,i=e.bookingTo,u=t||(n?{transport_extras:[]}:Fl),o=Object(w.useCallback)(function(e){c&&c(e.transport_extras.reduce(function(e,t){return e+parseFloat((t.price?t.price:0).toString())},0),e.transport_extras.map(function(e){var t=e.service,a=e.date,n=Object(ie.a)(e,["service","date"]);return Object(H.a)({},n,{date:a?We()(a).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"):"",service:t?t.name:void 0})}))},[c]);Object(A.o)(function(){o(u)});var s=Object(w.useMemo)(function(){for(var e=[],t=We()(i).diff(We()(l),"days"),a=0;a<=t;a++)e.push({id:a,name:We()(l).add(a,"day").format("YYYY-MM-DD")});return e},[l,i]),m=Object(w.useCallback)(function(){var e=Object(Y.a)(D.a.mark(function e(t,a){var n,r;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setStatus(),n=[],r={transport_extras:[]},t.transport_extras.forEach(function(e){var t=e.date,a=e.service,c=Object(ie.a)(e,["date","service"]);a&&(r.transport_extras.push(Object(H.a)({},e,{date:t?We()(t).format("YYYY-MM-DD"):""})),n.push(Object(H.a)({},c,{date:t?We()(t).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"):"",service:a&&a.name})))}),e.abrupt("return",function(){var e=Object(Y.a)(D.a.mark(function e(t){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({transport_extras:t}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(n).then(function(e){r.transport_extras=r.transport_extras.map(function(t,a){return Object(H.a)({},t,{price:e.transport_extras[a].price})}),a.setValues(r),o(r)}).catch(function(e){a.setStatus(e.message),e.formikErrors&&a.setErrors(e.formikErrors)}));case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),[r,o]),d=Object(w.useRef)(!0);return T.a.createElement(M.e,{initialValues:u,validationSchema:ql,onSubmit:function(e,t){return m(e,t).then(function(){t.setSubmitting(!1)})},render:function(e){e.isSubmitting;var t=e.values,a=e.setFieldValue;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement(M.c,{name:"transport_extras",render:function(e){var n=e.name,r=e.push,c=e.remove;return T.a.createElement("div",null,t.transport_extras.map(function(e,t){return T.a.createElement("div",{key:t,className:"border-gray-300 border-b-4"},T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(n,".").concat(t,".service"),render:function(e){var t=e.field;return T.a.createElement(xn,Object.assign({},t,{label:"Service",placeholder:"Select or add a service...",required:!0,creatable:!0,fetchOnMount:!0,onChange:function(e,t){a(t,e)}}))}})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Price",name:"".concat(n,".").concat(t,".price"),type:"number",placeholder:"3000",min:0})),T.a.createElement(ct,null,l&&i?T.a.createElement(de,{name:"".concat(n,".").concat(t,".date"),render:function(t){var n=t.field;return T.a.createElement(A.l,Object.assign({},n,{label:"Date",options:s,searchable:!1,placeholder:"Select a date...",required:!0,value:s.find(function(t){return t.name===e.date}),onChange:function(e,t){a(t,e.name)}}))}}):T.a.createElement(hn,{label:"Date",name:"".concat(n,".").concat(t,".date"),required:!0})),T.a.createElement(ct,null,T.a.createElement(fe,{name:"".concat(n,".").concat(t,".comments"),label:"Comments",placeholder:"Any comments regarding service"})),T.a.createElement(ct,{className:"pt-4 border-l text-right"},T.a.createElement(A.e,null,T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){return r(e)}},"+ Duplicate"),T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){return c(t)}},"\xd7 Remove")))))}),T.a.createElement("div",{className:"mt-4"},T.a.createElement(A.d,{onClick:function(){return r(Fl.transport_extras[0])}},"+ Add ",t.transport_extras.length?"Another":""," ","Transport Extra Service")))}}),T.a.createElement(pe,{onChange:function(e){o(e.values),d.current?e.isSubmitting||ql.validate(e.values).then(Object(Y.a)(D.a.mark(function t(){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSubmitting){t.next=2;break}return t.abrupt("return");case 2:return e.setSubmitting(!0),t.abrupt("return",m(e.values,e).then(function(){e.setSubmitting(!1)}));case 4:case"end":return t.stop()}},t)}))).catch(function(){}):d.current=!0}}),T.a.createElement("button",{type:"submit",className:"invisible"},"Get Price"))}})});var Il=R.object().shape({other_extras:R.array().of(R.object().shape({service:R.object().typeError("Service field is required").required("Service field is required"),date:R.string(),price:ee().positive("Price should be positive"),comments:R.string()}))}),Dl={other_extras:[{service:void 0,date:"",price:void 0,comments:""}]},Yl=Ce(function(e){var t=e.initialValues,a=e.shouldEmptyInitialValues,n=void 0===a||a,r=e.xhr,c=e.onChange,l=e.bookingFrom,i=e.bookingTo,u=t||(n?{other_extras:[]}:Dl),o=Object(w.useCallback)(function(e){c&&c(e.other_extras.reduce(function(e,t){return e+parseFloat((t.price?t.price:0).toString())},0),e.other_extras.map(function(e){var t=e.service,a=e.date,n=Object(ie.a)(e,["service","date"]);return Object(H.a)({},n,{date:a?We()(a).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"):"",service:t?t.name:void 0})}))},[c]);Object(A.o)(function(){o(u)});var s=Object(w.useMemo)(function(){for(var e=[],t=We()(i).diff(We()(l),"days"),a=0;a<=t;a++)e.push({id:a,name:We()(l).add(a,"day").format("YYYY-MM-DD")});return e},[l,i]),m=Object(w.useCallback)(function(){var e=Object(Y.a)(D.a.mark(function e(t,a){var n,r;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setStatus(),n=[],r={other_extras:[]},t.other_extras.forEach(function(e){var t=e.date,a=e.service,c=Object(ie.a)(e,["date","service"]);a&&(r.other_extras.push(Object(H.a)({},e,{date:We()(t).format("YYYY-MM-DD")})),n.push(Object(H.a)({},c,{date:t?We()(t).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"):"",service:a?a.name:void 0})))}),e.abrupt("return",function(){var e=Object(Y.a)(D.a.mark(function e(t){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({other_extras:t}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(n).then(function(e){r.other_extras=r.other_extras.map(function(t,a){return Object(H.a)({},t,{price:e.other_extras[a].price})}),a.setValues(r),o(r)}).catch(function(e){a.setStatus(e.message),e.formikErrors&&a.setErrors(e.formikErrors)}));case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),[r,o]),d=Object(w.useRef)(!0);return T.a.createElement(M.e,{initialValues:u,validationSchema:Il,onSubmit:function(e,t){return m(e,t).then(function(){t.setSubmitting(!1)})},render:function(e){e.isSubmitting;var t=e.values,a=e.setFieldValue;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement(M.c,{name:"other_extras",render:function(e){var n=e.name,r=e.push,c=e.remove;return T.a.createElement("div",null,t.other_extras.map(function(e,t){return T.a.createElement("div",{key:t,className:"border-gray-300 border-b-4"},T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(de,{name:"".concat(n,".").concat(t,".service"),render:function(e){var t=e.field;return T.a.createElement(Cn,Object.assign({},t,{label:"Service",placeholder:"Select or add a service...",required:!0,creatable:!0,fetchOnMount:!0,onChange:function(e,t){a(t,e)}}))}})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Price",name:"".concat(n,".").concat(t,".price"),type:"number",placeholder:"3000",min:0})),T.a.createElement(ct,null,l&&i?T.a.createElement(de,{name:"".concat(n,".").concat(t,".date"),render:function(t){var n=t.field;return T.a.createElement(A.l,Object.assign({},n,{label:"Date",options:s,searchable:!1,placeholder:"Select a date...",required:!0,value:s.find(function(t){return t.name===e.date}),onChange:function(e,t){a(t,e.name)}}))}}):T.a.createElement(hn,{label:"Date",name:"".concat(n,".").concat(t,".date"),required:!0})),T.a.createElement(ct,null,T.a.createElement(fe,{name:"".concat(n,".").concat(t,".comments"),label:"Comments",placeholder:"Any comments regarding service"})),T.a.createElement(ct,{className:"pt-4 border-l text-right"},T.a.createElement(A.e,null,T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){return r(e)}},"+ Duplicate"),T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){return c(t)}},"\xd7 Remove")))))}),T.a.createElement("div",{className:"mt-4"},T.a.createElement(A.d,{onClick:function(){return r(Dl.other_extras[0])}},"+ Add ",t.other_extras.length?"Another":""," Quote Extra Service")))}}),T.a.createElement(pe,{onChange:function(e){o(e.values),d.current?e.isSubmitting||Il.validate(e.values).then(Object(Y.a)(D.a.mark(function t(){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isSubmitting){t.next=2;break}return t.abrupt("return");case 2:return e.setSubmitting(!0),t.abrupt("return",m(e.values,e).then(function(){e.setSubmitting(!1)}));case 4:case"end":return t.stop()}},t)}))).catch(function(){}):d.current=!0}}),T.a.createElement("button",{type:"submit",className:"invisible"},"Get Price"))}})});var Ml=Ce(function(e){var t=e.xhr,a=e.navigate,n=e.trip,r=e.location,c=r&&r.state&&r.state.quote,l=Object(w.useState)(0),i=Object(Qe.a)(l,2),u=i[0],o=i[1],s=Object(w.useState)(0),m=Object(Qe.a)(s,2),d=m[0],f=m[1],p=Object(w.useState)([]),E=Object(Qe.a)(p,2),h=E[0],b=E[1],g=Object(w.useState)([]),v=Object(Qe.a)(g,2),_=v[0],y=v[1],S=Object(w.useState)(0),j=Object(Qe.a)(S,2),O=j[0],x=j[1],C=Object(w.useState)(0),N=Object(Qe.a)(C,2),k=N[0],P=N[1],q=Object(w.useState)(0),F=Object(Qe.a)(q,2),I=F[0],M=F[1],R=Object(w.useState)([]),L=Object(Qe.a)(R,2),U=L[0],V=L[1],B=Object(w.useState)([]),Q=Object(Qe.a)(B,2),G=Q[0],W=Q[1],K=Object(w.useState)([]),z=Object(Qe.a)(K,2),J=z[0],$=z[1],Z=Object(w.useState)(c&&c.comments||""),ee=Object(Qe.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(w.useState)(null),re=Object(Qe.a)(ne,2),ce=re[0],le=re[1],ue=Object(w.useRef)(null),oe=Object(w.useCallback)(function(){le(null),function(e){return{saveQuote:function(){var t=Object(Y.a)(D.a.mark(function t(a,n){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/trips/".concat(a,"/quotes"),n).then(function(e){return e.data.quote}));case 1:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()}}(t).saveQuote(n.id,{total_price:u+d+O+k+I,hotels:h,cabs:U,hotel_extras:_,transport_extras:G,other_extras:J,comments:te}).then(function(){a&&a("../quotes")}).catch(function(e){le(e);var t=ue.current;t&&(t.querySelectorAll("[type='submit']").forEach(function(e){return"function"===typeof e.click?e.click():null}),setTimeout(function(){var t=ue.current;if(t){var a=t.querySelectorAll("[class='error-message']");a.length&&(a[0].scrollIntoView?a[0].scrollIntoView({behavior:"smooth",block:"center"}):window.alert(e.message))}},300))})},[t,n,a,te,h,u,U,d,_,O,G,k,J,I]),se=Object(w.useCallback)(function(e,t){le(null),o(e),b(t)},[o,b]),de=Object(w.useCallback)(function(e,t){le(null),x(e),y(t)},[y,y]),fe=Object(w.useCallback)(function(e,t){le(null),f(e),V(t)},[f,V]),pe=Object(w.useCallback)(function(e,t){le(null),P(e),W(t)},[P,W]),Ee=Object(w.useCallback)(function(e,t){le(null),M(e),$(t)},[M,$]),he=Object(w.useMemo)(function(){return{hotels:c?{hotels:c.hotels.map(function(e){var t=e.checkin,a=e.checkout,n=e.room_type,r=e.adults_with_extra_bed,c=e.children_with_extra_bed,l=e.children_without_extra_bed,i=e.no_of_rooms,u=Object(ie.a)(e,["checkin","checkout","room_type","adults_with_extra_bed","children_with_extra_bed","children_without_extra_bed","no_of_rooms"]);return Object(H.a)({},u,{start_date:We.a.utc(t).local().format("YYYY-MM-DD"),no_of_nights:We.a.utc(a).diff(We.a.utc(t),"days")+1,edited_given_price:u.calculated_price!==u.given_price,rooms_detail:{room_type:n,adults_with_extra_bed:r,children_with_extra_bed:c,children_without_extra_bed:l,no_of_rooms:i}})})}:void 0,cabs:c?{cabs:c.cabs.map(function(e){var t=e.from_date,a=e.to_date,n=Object(ie.a)(e,["from_date","to_date"]);return Object(H.a)({edited_given_price:n.calculated_price!==n.given_price,start_date:We.a.utc(t).local().format("YYYY-MM-DD"),no_of_days:We.a.utc(a).diff(We.a.utc(t),"days")+1},n)})}:void 0,hotel_extras:c?{hotel_extras:c.hotel_extras.map(function(e){var t=e.given_price,a=e.date,n=Object(ie.a)(e,["given_price","date"]);return Object(H.a)({},n,{price:t,date:a?We.a.utc(a).local().format("YYYY-MM-DD"):void 0})})}:void 0,transport_extras:c?{transport_extras:c.transport_extras.map(function(e){var t=e.given_price,a=e.date,n=Object(ie.a)(e,["given_price","date"]);return Object(H.a)({},n,{price:t,date:a?We.a.utc(a).local().format("YYYY-MM-DD"):void 0})})}:void 0,other_extras:c?{other_extras:c.other_extras.map(function(e){var t=e.given_price,a=e.date,n=Object(ie.a)(e,["given_price","date"]);return Object(H.a)({},n,{price:t,date:a?We.a.utc(a).local().format("YYYY-MM-DD"):void 0})})}:void 0}},[c]),be=We.a.utc(n.start_date).local().format("YYYY-MM-DD HH:mm:ss"),ge=We.a.utc(n.end_date).local().format("YYYY-MM-DD HH:mm:ss");return T.a.createElement("div",{className:"pb-8",ref:ue},T.a.createElement("h3",{className:"mb-8"},"Create a new quote"),T.a.createElement("section",{className:"mb-16"},T.a.createElement("header",{className:"flex"},T.a.createElement("div",{className:"mr-2"},T.a.createElement("span",{className:"inline-flex w-12 h-12 align-items-center justify-content-center bg-primary-600 text-white rounded-full"},T.a.createElement(A.i.BedIcon,null))),T.a.createElement("div",null,T.a.createElement("h4",null,"Hotels"),T.a.createElement("p",null,"Please fill hotel details and get the respective prices. Update the given price if necessary."))),T.a.createElement("div",{className:"bg-white rounded shadow"},T.a.createElement("div",{className:"mb-8 px-4"},T.a.createElement(jn,{bookingFrom:be,bookingTo:ge,initialValues:he.hotels,onChange:se})),T.a.createElement("hr",null),T.a.createElement("div",{className:"p-4"},T.a.createElement("h5",null,"Any extra services in hotels"),T.a.createElement("p",null,"Add any extra services for hotels e.g. special dinner, honeymoon cake etc."),T.a.createElement(Pn,{bookingFrom:be,bookingTo:ge,initialValues:he.hotel_extras,onChange:de}))),T.a.createElement("footer",null,T.a.createElement("mark",{className:"inline-block"},"Total price for Accommodation:"," ",X(u+O)))),T.a.createElement("section",{className:"mb-16"},T.a.createElement("header",{className:"flex"},T.a.createElement("div",{className:"mr-2"},T.a.createElement("span",{className:"inline-flex w-12 h-12 align-items-center justify-content-center bg-primary-600 text-white rounded-full"},T.a.createElement(A.i.BusIcon,null))),T.a.createElement("div",null,T.a.createElement("h4",null,"Transportation"),T.a.createElement("p",null,"Please fill the transportation details and click on get price to get the corresponding prices. Update given prices if necessary."))),T.a.createElement("div",{className:"bg-white rounded shadow"},T.a.createElement("div",{className:"mb-8 px-4"},T.a.createElement(Nl,{bookingFrom:be,bookingTo:ge,initialValues:he.cabs,onChange:fe})),T.a.createElement("hr",null),T.a.createElement("div",{className:"p-4"},T.a.createElement("h5",null,"Any extra services in transportation"),T.a.createElement("p",null,"Add any extra services like any side destination trip that is provided only per customer request"),T.a.createElement(Al,{bookingFrom:be,bookingTo:ge,initialValues:he.transport_extras,onChange:pe}))),T.a.createElement("footer",null,T.a.createElement("mark",{className:"inline-block"},"Total price for Transportation:"," ",X(d+k)))),T.a.createElement("section",{className:"mb-16"},T.a.createElement("header",{className:"flex"},T.a.createElement("div",{className:"mr-2"},T.a.createElement("span",{className:"inline-flex w-12 h-12 align-items-center justify-content-center bg-primary-600 text-white rounded-full"},T.a.createElement(A.i.StarEmptyIcon,null))),T.a.createElement("div",null,T.a.createElement("h4",null,"Any extra service for this trip"),T.a.createElement("p",null,"Add any extra services like off road dinner, side tracking etc that are associated with overall trip package"))),T.a.createElement("div",{className:"bg-white rounded p-4 shadow"},T.a.createElement(Yl,{bookingFrom:be,bookingTo:ge,initialValues:he.other_extras,onChange:Ee})),T.a.createElement("footer",null,T.a.createElement("mark",{className:"inline-block"},"Extra Stuff Price: ",X(I)))),T.a.createElement(A.h,null,T.a.createElement("label",null,"Any comments for this quote"),T.a.createElement(me,{name:"comments",as:"textarea",value:te,onChange:function(e){return ae(e.target.value)},placeholder:"Any comments regarding customer request or anything special about this quote or anything else...",maxLength:191})),T.a.createElement("footer",{className:"mt-16"},T.a.createElement("div",{className:"mb-4"},T.a.createElement("mark",{className:"inline-block font-bold text-2xl"},"Total Cost Price:"," ",X(u+d+O+k+I))),T.a.createElement(A.d,{className:"w-full py-2 text-lg",primary:!0,onClick:oe},"Create Quote"),ce?T.a.createElement("p",{className:"text-red-700 my-2"},ce.message):null))});function Rl(e){var t=e.initialState,a=e.render,n=e.children,r=Object(w.useState)(t),c=Object(Qe.a)(r,2),l={state:c[0],setState:c[1]};return a?a(l):"function"===typeof n?n(l):n||null}var Hl=Ce(function(e){var t=e.type,a=e.itemId,n=e.xhr,r=e.tags,c=void 0===r?[]:r,l=e.onCancel,i=e.onSuccess;return T.a.createElement(M.e,{initialValues:{items:[a],tags:c},onSubmit:function(e,a){a.setStatus(),vc(n,t).storeTags(e.items,e.tags.map(function(e){return e.name})).then(function(){a.setSubmitting(!1),i()}).catch(function(e){a.setStatus(e.message),e.formikErrors&&a.setErrors(e.formikErrors),a.setSubmitting(!1)})},render:function(e){var a=e.setFieldValue,n=e.isSubmitting,r=e.status;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Edit Tags"),r?T.a.createElement("p",{className:"error-message"},r):null,T.a.createElement(de,{name:"tags",render:function(e){var n=e.field;return T.a.createElement(_c,Object.assign({},n,{label:"Select existing or create new tags",type:t,onChange:function(e,t){a(t,e)}}))}}),T.a.createElement("footer",null,T.a.createElement(A.d,{type:"submit",primary:!0,disabled:n},"Save"),T.a.createElement(A.d,{disabled:n,onClick:function(){l()}},"Cancel"))))}})});function Ll(e){var t=e.type,a=e.itemId,n=e.users,r=void 0===n?[]:n,c=e.onCancel,l=e.onSuccess,i=T.a.useContext(xe);return T.a.createElement(M.e,{initialValues:{items:[a],users:r},onSubmit:function(e,a){a.setStatus(),i.put("/trip-owners",{items:e.items,users:e.users.map(function(e){return e.id}),type:t}).then(function(){a.setSubmitting(!1),l()}).catch(function(e){a.setStatus(e.message),e.formikErrors&&a.setErrors(e.formikErrors),a.setSubmitting(!1)})},render:function(e){var t=e.setFieldValue,a=e.isSubmitting,n=e.status;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Edit Owners"),n?T.a.createElement("p",{className:"error-message"},n):null,T.a.createElement(de,{name:"users",render:function(e){var a=e.field;return T.a.createElement(Mt,Object.assign({},a,{label:"Select User(s)",onChange:function(e,a){t(a,e)}}))}}),T.a.createElement("footer",null,T.a.createElement(A.d,{type:"submit",primary:!0,disabled:a},"Save"),T.a.createElement(A.d,{disabled:a,onClick:function(){c()}},"Cancel"))))}})}function Ul(e){var t=e.trip,a=t.customer_payments,n=t.hotel_payments,r=t.cab_payments;return T.a.createElement("section",null,a?T.a.createElement(zl,{payments:a}):null,n?T.a.createElement(Jl,{payments:n}):null,r?T.a.createElement(Kl,{payments:r}):null)}function Vl(e){var t=e.dueAmount,a=e.dueDate,n="Due";if(t<=0)n="Paid";else{var r=We.a.utc(a).local(),c=We()();r.isBefore(c)&&(n="Overdue")}return"Due"==n?null:T.a.createElement(A.b,{className:oe()("Paid"===n&&"bg-green-300","Overdue"===n&&"bg-red-300","Due"===n&&"bg-yellow-300")},n)}function Bl(e){var t=e.date;return T.a.createElement("span",null,We.a.utc(t).local().format("DD MMM, YYYY"))}function Ql(e){var t=e.amount;return T.a.createElement("span",null,X(t))}function Gl(e){var t=e.date,a=e.amount;return T.a.createElement("div",null,T.a.createElement(Ql,{amount:a}),T.a.createElement("br",null),T.a.createElement(Vl,{dueAmount:a,dueDate:t}))}function Wl(e){var t=e.instalment;return T.a.createElement("div",null,t.transactions&&t.transactions.length?T.a.createElement("div",null,t.transactions.map(function(e){return T.a.createElement("div",{key:e.id},We.a.utc(e.date).local().format("DD MMM, YYYY [at] hh:mm A")," - ",X(e.amount)," /-",e.comments?T.a.createElement("blockquote",null,e.comments):null)})):T.a.createElement("p",null,"Nothing yet"),t.due_amount>0?T.a.createElement($l,{instalment:t}):null)}function Kl(e){var t=e.payments;return t&&t.length?T.a.createElement(A.m,{caption:"Payments for Transportation",headers:["Transportation","Due Date","Due","Total","Paid","Transactions"],striped:!1,bordered:!0,autoWidth:!0},T.a.createElement("tbody",null,t.map(function(e){var t=e.paymentable.cab_type,a=e.paymentable.transport_service;return T.a.createElement(w.Fragment,{key:e.id},e.instalments.map(function(e,n,r){return T.a.createElement("tr",{key:e.id},0===n?T.a.createElement("td",{rowSpan:r.length,className:"vertical-align-middle"},T.a.createElement("b",null,a.name),T.a.createElement("br",null),T.a.createElement("small",null,t.name)):null,T.a.createElement("td",null,T.a.createElement(Gl,{date:e.due_date,amount:e.due_amount})),T.a.createElement("td",null,T.a.createElement(Ql,{amount:e.due_amount})),T.a.createElement("td",null,T.a.createElement(Ql,{amount:e.amount})),T.a.createElement("td",null,T.a.createElement(Ql,{amount:e.paid_amount})),T.a.createElement("td",null,T.a.createElement(Wl,{instalment:e})))}))}))):null}function zl(e){var t=e.payments;return t&&t.length?T.a.createElement(A.m,{autoWidth:!0,caption:"Payments towards customer",headers:["Due Date","Due","Total","Paid","Transactions"],alignCols:{2:"right",3:"right"},bordered:!0,rows:t.reduce(function(e,t){return e.concat(t.instalments)},[]).map(function(e){return[T.a.createElement(Bl,{date:e.due_date}),T.a.createElement(Gl,{date:e.due_date,amount:e.due_amount}),T.a.createElement(Ql,{amount:e.amount}),T.a.createElement(Ql,{amount:e.paid_amount}),T.a.createElement(Wl,{instalment:e})]})}):null}function Jl(e){var t=e.payments;return t&&t.length?T.a.createElement(A.m,{caption:"Payments for accomodation",headers:["Hotel","Due Date","Due Amount","Total Amount","Paid Amount","Transactions"],striped:!1,bordered:!0,autoWidth:!0},T.a.createElement("tbody",null,t.map(function(e){var t=e.paymentable.hotel;return T.a.createElement(w.Fragment,{key:e.id},e.instalments.map(function(e,a,n){return T.a.createElement("tr",{key:e.id},0===a?T.a.createElement("td",{rowSpan:n.length,className:"vertical-align-middle"},T.a.createElement("b",null,t.name),T.a.createElement("br",null),T.a.createElement("small",null,t.location.short_name,", ",t.stars," Star")):null,T.a.createElement("td",null,T.a.createElement(Bl,{date:e.due_date})),T.a.createElement("td",null,T.a.createElement(Gl,{date:e.due_date,amount:e.due_amount})),T.a.createElement("td",null,T.a.createElement(Ql,{amount:e.amount})),T.a.createElement("td",null,T.a.createElement(Ql,{amount:e.amount})),T.a.createElement("td",null,T.a.createElement(Wl,{instalment:e})))}))}))):null}var $l=Ce(function(e){var t=e.instalment,a=e.xhr,n=Object(A.n)(),r=Object(Qe.a)(n,3),c=r[0],l=r[1],i=r[2];return T.a.createElement(T.a.Fragment,null,T.a.createElement(A.d,{onClick:l},"Add"),T.a.createElement(A.f,{open:c,onClose:i,closeButton:!0},T.a.createElement(A.f.Header,null,T.a.createElement(A.f.Title,null,"Log Transaction")),T.a.createElement(A.f.Body,null,T.a.createElement("p",null,T.a.createElement("mark",null,"INR ",X(t.due_amount))," is due by",T.a.createElement("mark",null,We.a.utc(t.due_date).local().format("DD MMM, YYYY"))),T.a.createElement(M.e,{initialValues:{amount:t.due_amount,payment_mode:"netbanking",comments:""},onSubmit:function(e,n){var r=e.amount,c=e.comments,l=e.payment_mode;n.setStatus(),function(e){return{logTransaction:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/payment-transactions",a).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}(a).logTransaction({instalment_id:t.id,amount:r,payment_mode:l,comments:c}).then(function(){n.setSubmitting(!1),window.location=window.location}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setStatus(!1)})},render:function(e){var t=e.isSubmitting,a=e.status;return T.a.createElement(M.d,{noValidate:!0},a?T.a.createElement("p",{className:"error"},a):null,T.a.createElement(fe,{name:"amount",label:"Paid Amount (INR)",required:!0}),T.a.createElement(fe,{as:"select",name:"payment_mode",label:"Payment Mode",required:!0},T.a.createElement("option",{value:"cash"},"Cash"),T.a.createElement("option",{value:"netbanking"},"Netbanking"),T.a.createElement("option",{value:"upi"},"UPI"),T.a.createElement("option",{value:"others"},"Others")),T.a.createElement(fe,{name:"comments",as:"textarea",label:"Comments",placeholder:"Any comments consisting reference id or payment details"}),T.a.createElement(A.f.Footer,null,T.a.createElement(A.d,{primary:!0,disabled:t,type:"submit"},"Update"),T.a.createElement(A.d,{onClick:i},"Cancel")))}}))))});var Xl=Ce(function(e){var t=e.trip,a=e.xhr,n=Object(A.n)(),r=Object(Qe.a)(n,3),c=r[0],l=r[1],i=r[2],u=t.latest_given_quote,o=t.converted_at;return u?T.a.createElement("fieldset",null,T.a.createElement("legend",null,T.a.createElement("h4",null,o?"Quote used for conversion":"Latest Given Quote")),T.a.createElement(Kc,{givenQuote:u,readOnly:!!o,showHotelBookingStatus:!!o}),T.a.createElement(ei,{trip:t,isConvertVisible:c,hideConvert:i,onConvert:function(e){return function(e){return{convertTrip:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/converted-trips",a).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}(a).convertTrip(e)}}),o?null:T.a.createElement("footer",null,T.a.createElement(A.d,{onClick:l,primary:!0},"Mark as converted"))):null}),Zl=R.object().shape({instalments:R.array().of(R.object().shape({due_date:R.string().required("Instalment due date is required"),amount:R.number().positive("Instalment amount should a positive number").required("Instalment amount is required"),percentage:R.number().positive("Percentage should be a positive number").required("Percentage field is required")})).min(1,"Atleast one instalment should is required"),comments:R.string(),details_verified:R.boolean().required("Please verify the details before conversion")}).required("Conversion fields are required"),ei=Ce(function(e){var t=e.trip,a=e.isConvertVisible,n=e.hideConvert,r=e.onConvert,c=e.xhr,l=t.id,i=t.locations,u=t.latest_given_quote,o=t.start_date,s=t.end_date,m=t.no_of_adults,d=t.children,f=Object(A.p)(Object(Y.a)(D.a.mark(function e(){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=2;break}return e.abrupt("return",Promise.reject("No given quote for the trip"));case 2:return e.abrupt("return",Wc(c).getInstalments(u.id).then(function(e){return e.data}));case 3:case"end":return e.stop()}},e)})),{isFetching:!0}),p=Object(Qe.a)(f,3),E=p[0],h=p[1],b=p[2].isFetching;return Object(w.useEffect)(function(){a&&h()},[a]),u?T.a.createElement(A.f,{open:a,onClose:n},T.a.createElement(A.f.Header,null,T.a.createElement(A.f.Title,null,"Trip Conversion")),T.a.createElement(A.f.Body,null,b?T.a.createElement(_t,null):T.a.createElement(M.e,{initialValues:{comments:"",details_verified:!1,instalments:(E||[]).map(function(e){var t=e.amount,a=e.due_date;return{amount:parseFloat(t.toFixed(2)),due_date:We.a.utc(a).local().format("YYYY-MM-DD"),percentage:parseFloat((100*t/u.given_price).toFixed(2))}})},validationSchema:Zl,onSubmit:function(e,t){var a=e.details_verified,c=e.instalments,i=e.comments,o=u.given_price;if(t.setStatus(),!a)return t.setStatus("Please verify the details and select the checkbox when done."),void t.setSubmitting(!1);var s=c.reduce(function(e,t){return e+t.amount},0);if(s<o)return t.setStatus("Instalments doesn't sumup(Rs: ".concat(s," /-) with given quote's price (Rs: ").concat(o,") /-")),void t.setSubmitting(!1);window.confirm("".concat(s>o?"Total instalment is greater then given quote's amount. ":"","Are you sure you want to mark this trip as converted ?"))?r({instalments:c.map(function(e){e.percentage;return Object(ie.a)(e,["percentage"])}),comments:i,trip_id:l}).then(function(){t.setSubmitting(!1),n()}).catch(function(e){return t.setStatus(e.message),e.formikErrors&&t.setErrors(e.formikErrors),t.setSubmitting(!1),Promise.reject(e)}):t.setSubmitting(!1)},render:function(e){var t=e.isSubmitting,a=e.values,r=e.setFieldValue,c=e.status;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,T.a.createElement("legend",null,T.a.createElement("b",null,"Please verify following details with the customer")),T.a.createElement("p",null,T.a.createElement("b",null,"Trip to"," ",T.a.createElement("mark",null,i.map(function(e){return e.short_name}).join(", "))," ","from"," ",T.a.createElement("mark",null,We.a.utc(o).local().format("DD MMM, YYYY"))," ","to"," ",T.a.createElement("mark",null,We.a.utc(s).local().format("DD MMM, YYYY"))," ","with"," ",T.a.createElement("mark",null,m," Adults",d?" and ".concat(d," children"):"")," ","where the package cost is"," ",T.a.createElement("mark",null,T.a.createElement(A.i.RupeeIcon,null)," ",X(u.given_price)," /-"),".")),T.a.createElement("h5",null,"Quote Details"),T.a.createElement("hr",null),T.a.createElement(Qc,{quote:u.quote,readOnly:!0})),T.a.createElement("hr",null),T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Customer Instalments"),T.a.createElement(M.c,{name:"instalments",render:function(e){var t=e.name,n=e.push,c=e.remove;return T.a.createElement(T.a.Fragment,null,T.a.createElement("ul",{className:"list"},a.instalments.map(function(e,a,l){return T.a.createElement("li",{key:a},T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(fe,{name:"".concat(t,".").concat(a,".due_date"),label:"Date",type:"date"})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Percentage",name:"".concat(t,".").concat(a,".percentage"),onChange:function(e){r("".concat(t,".").concat(a,".amount"),u.given_price*parseFloat(e.currentTarget.value||"0")/100),r(e.currentTarget.name,e.currentTarget.value)},type:"number"})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Amount",name:"".concat(t,".").concat(a,".amount"),onChange:function(e){r("".concat(t,".").concat(a,".percentage"),100*parseFloat(e.currentTarget.value||"0")/u.given_price),r(e.currentTarget.name,e.currentTarget.value)},type:"number"})),T.a.createElement(ct,{className:"d-flex align-items-center"},T.a.createElement("div",{className:"button-group"},T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){return n(e)}},"+ Duplicate"),l.length>1?T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){return c(a)}},"\xd7 Remove"):null))))})),T.a.createElement("footer",null,T.a.createElement(A.d,{className:"btn--secondary",onClick:function(){var e=Math.max(100-a.instalments.reduce(function(e,t){return e+t.percentage},0),0);n({due_date:"",amount:u.given_price*e/100,percentage:e})}},"+ Add More Instalments")))}})),T.a.createElement(fe,{name:"comments",label:"Comments",as:"textarea",placeholder:"Any comments regarding verification or prices etc.."}),T.a.createElement(fe,{name:"details_verified",type:"checkbox",label:"Verified travel details with customer ?"}),c?T.a.createElement("p",{className:"error"},c):null,T.a.createElement(A.f.Footer,null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Mark as converted"),T.a.createElement(A.d,{onClick:n},"Cancel")))}}))):null}),ti=Xl;function ai(e){return{getTrip:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/trips/".concat(a)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),convertTrip:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/converted-trips",a).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),changeTripStage:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.put("/trip-active-stages",a).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var ni=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(tc.item.request()),t.abrupt("return",ai(c).getTrip(e).then(function(e){return a(tc.item.success(e)),e}).catch(function(e){return a(tc.item.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()},ri=Ce(function(e){var t=e.trip,a=e.xhr,n=Ue().hasPermission,r=t.id,c=t.start_date,l=t.end_date,i=t.locations,u=t.no_of_adults,o=t.children,s=t.trip_source,m=t.trip_id,d=t.contacts,f=t.tags,p=t.latest_stage,E=t.created_by,h=t.sales_team,b=void 0===h?[]:h,g=t.operations_team,v=void 0===g?[]:g;return T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(A.m,{autoWidth:!0,bordered:!0},T.a.createElement("tbody",null,T.a.createElement("tr",null,T.a.createElement("th",null,"ID"),T.a.createElement("td",null,s.short_name,"-",m||r)),T.a.createElement("tr",null,T.a.createElement("th",null,"Destination"),T.a.createElement("td",null,i.map(function(e){return e.short_name}))),T.a.createElement("tr",null,T.a.createElement("th",null,"Dates"),T.a.createElement("td",null,We.a.utc(c).local().format("DD MMM, YYYY")," for ",We.a.utc(l).diff(We.a.utc(c),"days")," ","Nights")),T.a.createElement("tr",null,T.a.createElement("th",null,"Traveler"),T.a.createElement("td",null,d.map(function(e){return T.a.createElement("div",{key:e.id},e.name,T.a.createElement("br",null),T.a.createElement("small",null,T.a.createElement("a",{href:"tel:".concat(e.phone_number)},e.phone_number),e.phone_number&&e.email?T.a.createElement("span",null," \u2022 "):null,e.email?T.a.createElement("a",{href:"mailto:".concat(e.email)},e.email):null))}))),T.a.createElement("tr",null,T.a.createElement("th",null,"Pax"),T.a.createElement("td",null,u," Adults",o?T.a.createElement("span",null," with ",o," Children"):"")),T.a.createElement("tr",null,T.a.createElement("th",null,"Stage"),T.a.createElement("td",null,T.a.createElement("div",null,p?p.name:"Initiated"),T.a.createElement("small",null,"Initiated by ",E.name))),T.a.createElement("tr",null,T.a.createElement("th",null,"Sales Team"),T.a.createElement("td",null,T.a.createElement("div",null,b.map(function(e){return e.name})),n(Me)?T.a.createElement("div",null,T.a.createElement(Rl,{initialState:!1},function(e){var a=e.state,n=e.setState;return T.a.createElement("div",null,a?null:T.a.createElement("button",{className:"text-sm",onClick:function(){n(!0)}},T.a.createElement("span",{className:"rotate-90 inline-block mr-1"},"\u270e")," ","Edit"),a?T.a.createElement(Ll,{type:"sales_team",users:b,itemId:t.id,onSuccess:function(){n(!1)},onCancel:function(){n(!1)}}):null)})):null)),T.a.createElement("tr",null,T.a.createElement("th",null,"Operations Team"),T.a.createElement("td",null,T.a.createElement("div",null,v.map(function(e){return e.name})),n(Me)?T.a.createElement("div",null,T.a.createElement(Rl,{initialState:!1},function(e){var a=e.state,n=e.setState;return T.a.createElement("div",null,a?null:T.a.createElement("button",{className:"text-sm",onClick:function(){n(!0)}},T.a.createElement("span",{className:"rotate-90 inline-block mr-1"},"\u270e")," ","Edit"),a?T.a.createElement(Ll,{type:"operations_team",users:v,itemId:t.id,onSuccess:function(){n(!1)},onCancel:function(){n(!1)}}):null)})):null))))),T.a.createElement(ct,null,T.a.createElement("section",null,T.a.createElement(Rl,{initialState:!1},function(e){var n=e.state,c=e.setState;return T.a.createElement("div",null,n?null:T.a.createElement("header",null,"Stage"," ",T.a.createElement(A.d,{style:{background:"none"},className:"p-0 w-8 h-8 ml-2 border-transparent",onClick:function(){return c(!0)}},T.a.createElement("span",{className:"rotate-90 inline-block"},"\u270e"))),n?T.a.createElement(M.e,{initialValues:{stage:t.latest_stage},onSubmit:function(e,t){var n=e.stage;ai(a).changeTripStage({trips:[r],stage:n?n.id:null}).then(function(){t.setSubmitting(!1),c(!1)}).catch(function(e){return t.setStatus(e.message),e.formikErrors&&t.setErrors(e.formikErrors),t.setSubmitting(!1),Promise.reject(e)})},render:function(e){var t=e.setFieldValue,a=e.isSubmitting,n=e.status;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Edit Trip Stage"),n?T.a.createElement("p",{className:"text-red-700 mb-2"},n):null,T.a.createElement(de,{name:"stage",render:function(e){var a=e.field;return T.a.createElement(pc,Object.assign({},a,{label:"Select next stage for the trip*",fetchOnMount:!0,multiple:!1,onChange:function(e,a){return t(a,e)}}))}}),T.a.createElement("footer",null,T.a.createElement(A.d,{disabled:a,type:"submit",primary:!0},"Update")," ",T.a.createElement(A.d,{disabled:a,onClick:function(){return c(!1)}},"Cancel"))))}}):T.a.createElement("div",null,t.latest_stage?t.latest_stage.name:"Initiated"))})),T.a.createElement("section",{className:"mt-4"},T.a.createElement(Rl,{initialState:!1},function(e){var a=e.state,n=e.setState;return T.a.createElement("div",null,a?null:T.a.createElement("header",{className:"mb-2"},"Tags",T.a.createElement(A.d,{style:{background:"none"},className:"p-0 w-8 h-8 ml-2 border-transparent",onClick:function(){n(!0)}},T.a.createElement("span",{className:"rotate-90 inline-block"},"\u270e"))),a?T.a.createElement(Hl,{type:"trip",tags:f,itemId:t.id,onSuccess:function(){n(!1)},onCancel:function(){n(!1)}}):T.a.createElement("div",null,f&&f.length?T.a.createElement(A.c,null,f.map(function(e){return T.a.createElement(A.b,{key:e.id},e.name)})):T.a.createElement("div",null,"No Tags Assigned",T.a.createElement("br",null),T.a.createElement("small",null,"Use tags to quickly indentify and group trips"))))}))))});function ci(e){var t=e.trip,a=t.id,n=t.locations,r=t.trip_source,c=t.trip_id,l=t.activity_logs;return T.a.createElement("div",null,T.a.createElement(q.a,null,T.a.createElement("title",null,n.map(function(e){return e.short_name}).join(" \u2022 ")," (",r.short_name,"-",c||a.toString(),")")),T.a.createElement(ri,{trip:t}),T.a.createElement(Ul,{trip:t}),T.a.createElement(ti,{trip:t}),l?T.a.createElement("div",null,T.a.createElement("h5",null,"Activities"),T.a.createElement("ol",{className:"list-disc pl-4"},l.map(function(e){return T.a.createElement("li",{key:e.id,className:"py-2"},T.a.createElement("span",null,e.description)," ",T.a.createElement("br",null),e.causer?T.a.createElement("small",{className:"text-gray-600"}," ","by ",e.causer.name," \u2022"," ",We.a.utc(e.created_at).local().fromNow()):null)}))):null)}function li(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(e){return Object(N.c)(function(t){var a=nc(t);return{isFetching:a.isFetching,trip:a.getItem(e)}})}(e),n=function(){var e=Z();return Object(w.useCallback)(function(t){return e(ni(t))},[e])}();return Object(w.useEffect)(function(){t&&e&&n(e)},[t,e,n]),Object(H.a)({},a,{fetchTrip:n})}function ii(e){var t=e.tripId,a=e.navigate,n=li(t,!0),r=n.trip,c=n.isFetching;return t?c?T.a.createElement("div",{className:"text-center"},T.a.createElement(_t,null)):r?T.a.createElement("div",null,T.a.createElement("ul",{className:"border-b flex mb-4 tabs"},T.a.createElement(Be,{to:"..",className:"border"},T.a.createElement(A.i.ChevronDownIcon,{className:"rotate-90"})),T.a.createElement(Be,{to:"",className:"border"},"Trip Details"),T.a.createElement(Be,{to:"given-quotes",className:"border"},"Given Quotes"),T.a.createElement(Be,{to:"quotes",className:"border"},"Quotes"),T.a.createElement(Be,{to:"new-quote",className:"border"},"New Quote")),T.a.createElement(F.e,null,T.a.createElement(ci,{path:"/",trip:r}),T.a.createElement(zc,{path:"given-quotes",trip:r}),T.a.createElement(Gc,{path:"quotes",trip:r}),T.a.createElement(Ml,{path:"new-quote",trip:r}))):null:(a&&a(".."),null)}var ui="TRIP_SOURCES_STATE",oi={isFetching:!0,state:dt()},si={list:Object(L.createAsyncAction)("@TRIP_SOURCES/LIST_FETCH_REQUEST","@TRIP_SOURCES/LIST_FETCH_SUCCESS","@TRIP_SOURCES/LIST_FETCH_FAILED")()},mi=pt(oi,si);function di(e){var t=e[ui];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function fi(e){return{getTripSources:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/trip-sources",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var pi=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(si.list.request()),t.abrupt("return",fi(c).getTripSources(e).then(function(e){return a(si.list.success(e)),e.data}).catch(function(e){return a(si.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Ei(){var e=Z();return Object(w.useCallback)(function(t){e(pi(t))},[e])}function hi(){return Object(H.a)({},Object(N.c)(function(e){var t=di(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,tripSources:t.get()})}),{fetchTripSources:Ei()})}function bi(e){Object(wt.a)(e);var t=hi(),a=t.fetchTripSources,n=t.tripSources,r=t.total,c=t.from,l=t.to,i=t.currentPage,u=t.lastPage,o=t.isFetching,s=Ct(),m=Object(Qe.a)(s,2),d=m[0],f=m[1];return Object(w.useEffect)(function(){a({page:i})},[a]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Trip Sources List")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(Pt,{onSearch:function(e){f(e),a(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:r,from:c,to:l,lastPage:u,currentPage:i,isFetching:o,onChange:function(e){return a(Object(H.a)({},d,{page:e}))}}))),T.a.createElement(xt,{total:r,isFetching:o},T.a.createElement(A.m,{striped:!0,bordered:!0,headers:["Name","Short Name"],rows:n.map(function(e){return[e.name,e.short_name]})})))}var gi=Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0},a,{fetch:function(e){return fi(t).getTripSources({q:e}).then(function(e){return e.data})}}))}),vi=R.object().shape({name:R.string().required("Name field is required"),short_name:R.string().required("Short name field is required")}),_i={name:"",short_name:""};var yi=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"New Trip Source")),T.a.createElement(M.e,{initialValues:_i,validationSchema:vi,onSubmit:function(e,n){return n.setStatus(),t.post("/trip-sources",e).then(function(e){e.data,a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status;return T.a.createElement(M.d,{noValidate:!0},a?T.a.createElement("div",null,a):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add New Source of Trips"),T.a.createElement(fe,{label:"Name",name:"name",placeholder:"Travel Triangle",required:!0}),T.a.createElement(fe,{label:"Short name",name:"short_name",placeholder:"TT",required:!0}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function Si(e){return T.a.createElement(ce,null,T.a.createElement(F.a,{to:"new",className:"float-right btn"},"New Trip Source"),T.a.createElement("h2",null,"Trip Sources"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(yi,{path:"/new"}),T.a.createElement(bi,{path:"/"})))}var ji=R.object().shape({trip_id:R.string(),start_date:R.string().required("Start date is required"),no_of_nights:ee().positive("Number of nights should be a positive integer").integer("Number of nights should be a positive integer").required("Number of nights is required"),destinations:R.array().min(1,"Please select atleast one destination"),no_of_adults:ee().positive("Number of adults should be a positive integer").integer("Number of adults should be a positive integer").required("Number of adults field is required"),children:R.array().of(R.object().shape({count:ee().positive("Number of children should be positive integer").integer("Number of children should be positive integer").required("Number of children field is required"),age:ee().positive("Child age should a positive number").required("Child age is required")})),trip_source:R.object().required("Trip Source Type is required"),contact:R.object().shape({name:R.string().required("Contact name is required."),email:R.string().email("Contact email address in invalid"),phone_number:ee().typeError("Phone number is invalid").positive("Phone number should be an positive integer")}).required()}),Oi={trip_id:"",start_date:"",no_of_nights:1,destinations:[],no_of_adults:1,children:[],trip_source:void 0,contact:{name:"",email:"",phone_number:void 0,country:void 0}};var wi=Ce(function(e){var t=e.xhr,a=e.navigate;return T.a.createElement(M.e,{initialValues:Oi,validationSchema:ji,onSubmit:function(e,n){n.setStatus();var r=e.start_date,c=e.no_of_adults,l=e.no_of_nights,i=e.children,u=void 0===i?[]:i,o=e.destinations,s=e.trip_source,m=e.trip_id,d=e.contact;if(r&&l&&c&&o&&o.length){var f={start_date:We()(r).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),end_date:We()(r).add(l,"day").hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),no_of_adults:c,children:u.map(function(e){var t=e.count,a=e.age;return"".concat(t,"-").concat(a,"yo")}).join(","),locations:o.map(function(e){return e.id}),trip_id:m,trip_source_id:s?s.id:void 0,contact:{name:d.name,email:d.email||void 0,phone_number:d.phone_number||void 0,country_id:d.country?d.country.id:void 0}};t.post("/trips",f).then(function(e){var t=e.data.data;a&&a("../".concat(t.id)),n.setSubmitting(!1)}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})}else n.setStatus("Please fill the required attributes"),n.setSubmitting(!1)},render:function(e){var t=e.isSubmitting,a=e.status,n=e.values,r=e.setFieldValue;return T.a.createElement(M.d,{noValidate:!0},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add New Trip"),a?T.a.createElement("p",{className:"text-red-700"},a):null,T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(de,{name:"destinations",render:function(e){var t=e.field;return T.a.createElement(Gn,Object.assign({},t,{label:"Destinations",onChange:function(e,t){return r(t,e)}}))}})),T.a.createElement(ct,null,T.a.createElement(hn,{name:"start_date",label:"Start Date",required:!0})),T.a.createElement(ct,null,T.a.createElement(fe,{name:"no_of_nights",label:"Number of nights",type:"number",min:1,required:!0})),T.a.createElement(ct,null,T.a.createElement(de,{name:"trip_source",render:function(e){var t=e.field;return T.a.createElement(gi,Object.assign({},t,{label:"Trip Source",required:!0,fetchOnMount:!0,onChange:function(e,t){return r(t,e)},multiple:!1}))}})),T.a.createElement(ct,null,T.a.createElement(fe,{name:"trip_id",label:"Trip ID",placeholder:"1231231"}))),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Pax Details"),T.a.createElement(fe,{name:"no_of_adults",label:"Number of adults",type:"number",min:1,required:!0}),T.a.createElement(M.c,{name:"children",render:function(e){var t=e.name,a=e.remove,r=e.push;return T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Children"),T.a.createElement("ul",{className:"list"},n.children.map(function(e,n){return T.a.createElement(rt,{as:"li",key:n},T.a.createElement(ct,{xs:"auto"},T.a.createElement(fe,{label:"Age",name:"".concat(t,".").concat(n,".age"),type:"number",min:1,max:20,required:!0})),T.a.createElement(ct,{xs:"auto"},T.a.createElement(fe,{label:"Count",name:"".concat(t,".").concat(n,".count"),type:"number",min:1,max:1e4,required:!0})),T.a.createElement(ct,{xs:"auto",className:"d-flex align-items-center"},T.a.createElement(A.d,{className:"btn--secondary",onClick:function(e){return a(n)}},"\xd7 Remove")))}),T.a.createElement(A.d,{onClick:function(e){return r({count:1,age:6})}},"+ Add Children Details")))}}))),T.a.createElement(ct,{sm:6},T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Contact Details"),T.a.createElement(M.c,{name:"contact",render:function(e){var t=e.name;return T.a.createElement(rt,null,T.a.createElement(ct,{sm:"auto"},T.a.createElement(fe,{name:"".concat(t,".name"),label:"Contact Name",required:!0,placeholder:"Anoop Rai"})),T.a.createElement(ct,{sm:"auto"},T.a.createElement(fe,{name:"".concat(t,".email"),label:"Email",required:!0,type:"email",placeholder:"user@domain.com"})),T.a.createElement(ct,null,T.a.createElement(fe,{name:"".concat(t,".phone_number"),label:"Phone Number",type:"number",required:!0,placeholder:"9779212232"})))}})))),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Save"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}})});function Ti(e){return T.a.createElement(ce,null,T.a.createElement(F.a,{to:"new",className:"float-right btn"},"Add New Trip"),T.a.createElement("h2",null,"Trips"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(wc,{path:"/"}),T.a.createElement(wi,{path:"/new"}),T.a.createElement(ii,{path:":tripId/*"})))}var xi="TRIP_PLAN_REQUEST_LIST_STATE",Ci={isFetching:!0,state:dt()},Ni={list:Object(L.createAsyncAction)("@TRIP_PLAN_REQUESTS/LIST_FETCH_REQUEST","@TRIP_PLAN_REQUESTS/LIST_FETCH_SUCCESS","@TRIP_PLAN_REQUESTS/LIST_FETCH_FAILED")(),item:Object(L.createAsyncAction)("@TRIP_PLAN_REQUESTS/ITEM_FETCH_REQUEST","@TRIP_PLAN_REQUESTS/ITEM_FETCH_SUCCESS","@TRIP_PLAN_REQUESTS/ITEM_FETCH_FAILED")()},ki=pt(Ci,Ni);function Pi(e){var t=e[xi];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function qi(e){return{getTripPlanRequest:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/trip-plan-requests/".concat(a)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Fi=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Ni.item.request()),t.abrupt("return",qi(c).getTripPlanRequest(e).then(function(e){return a(Ni.item.success(e)),e}).catch(function(e){return a(Ni.item.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Ai(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(e){return Object(N.c)(function(t){var a=Pi(t);return{isFetching:a.isFetching,item:a.getItem(e)}})}(e),n=function(){var e=Z();return Object(w.useCallback)(function(t){return e(Fi(t))},[e])}();return Object(w.useEffect)(function(){t&&e&&n(e)},[e,t,n]),Object(H.a)({},a,{fetch:n})}function Ii(e){var t=e.cabId,a=e.navigate,n=Ai(t,!0),r=n.item,c=n.isFetching;return t?T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Request from ",r?r.name:""," ",r?r.phone_number:"")),T.a.createElement(F.a,{to:".."},"Back to list"),c?"Loading...":r?T.a.createElement("div",null,r.name," - ",r.phone_number," - ",r.destination,T.a.createElement("br",null),"Created at:"," ",We.a.utc(r.created_at).local().toLocaleString(),T.a.createElement("br",null)):T.a.createElement(F.d,{noThrow:!0,to:"/trip-plan-requests"})):(a&&a("/trip-plan-requests"),null)}function Di(e){return{getTripPlanRequests:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/trip-plan-requests",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),assignTripRequestsOwner:function(){var t=Object(Y.a)(D.a.mark(function t(a,n){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/trip-plan-request-owners",{items:n,owner_id:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()}}var Yi=Ce(function(e){var t=e.xhr,a=e.request,n=e.onUpdate,r=a.owner,c=a.assigned_at,l=Object(w.useState)(!1),i=Object(Qe.a)(l,2),u=i[0],o=i[1];return T.a.createElement("span",null,r?T.a.createElement("span",null,T.a.createElement(F.a,{to:"/users/".concat(r.id)},r.name)," on"," ",We.a.utc(c).format("Do MMM, YYYY")):T.a.createElement("span",null,"Not Set"),u?T.a.createElement(M.e,{initialValues:{owner:r},onSubmit:function(e,r){r.setStatus();var c=e.owner;if(!c)return null;Di(t).assignTripRequestsOwner(c.id,[a.id]).then(function(e){return r.setSubmitting(!1),o(!1),n&&n(),e}).catch(function(e){return r.setStatus(e.message),e.formikErrors&&r.setErrors(e.formikErrors),r.setSubmitting(!1),Promise.reject(e)})},render:function(e){var t=e.isSubmitting,a=e.setFieldValue,n=e.status;return T.a.createElement(M.d,null,T.a.createElement("fieldset",null,n?T.a.createElement("p",{className:"text-red-700 my-2"},n):null,T.a.createElement(de,{name:"owner",render:function(e){var t=e.field;return T.a.createElement(Mt,Object.assign({},t,{multiple:!1,label:"Select Owner",onChange:function(e,t){return a(t,e)}}))}}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Assign"),T.a.createElement(A.d,{type:"button",disabled:t,onClick:function(){return o(!1)}},"Cancel"))))}}):T.a.createElement(A.d,{title:"Edit",onClick:function(){return o(!0)}},"\u270e"))}),Mi=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Ni.list.request()),t.abrupt("return",Di(c).getTripPlanRequests(e).then(function(e){var t=e.data,n=e.meta;return a(Ni.list.success({data:t,meta:n})),t}).catch(function(e){return a(Ni.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Ri(){var e=Object(N.b)();return Object(w.useCallback)(function(t){return e(Mi(t))},[e])}function Hi(){return Object(H.a)({},Object(N.c)(function(e){var t=Pi(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,items:t.get()})}),{fetch:Ri()})}function Li(e){var t=Hi(),a=t.items,n=t.total,r=t.from,c=t.to,l=t.currentPage,i=t.lastPage,u=t.isFetching,o=t.fetch,s=Ct(),m=Object(Qe.a)(s,2),d=m[0],f=m[1];return Object(w.useEffect)(function(){o({page:l})},[o]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Trip Plan Requests")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(kt,{onSearch:function(e){f(e),o(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:n,from:r,to:c,currentPage:l,lastPage:i,isFetching:u,onChange:function(e){return o(Object(H.a)({},d,{page:e}))}}))),T.a.createElement(Tt,{isFetching:u,total:n},T.a.createElement(A.m,{headers:["Guest","Destination","Pax","Comments","Actions"],striped:!0,bordered:!0,rows:a.map(function(e){return[T.a.createElement("span",null,T.a.createElement("h4",null,e.name),e.phone_number," \u2022 ",e.email),T.a.createElement("span",null,T.a.createElement("h4",null,e.destination),T.a.createElement("span",null,e.start_date?We.a.utc(e.start_date).local().format("Do MMM, YYYY"):null," ","\u2022 ",e.no_of_days," Days")),T.a.createElement("span",null,e.no_of_adults," Adults with ",e.no_of_children," Children"),T.a.createElement("span",null,e.hotel_preference?T.a.createElement("span",null,"Hotel Preference: ",e.hotel_preference,T.a.createElement("br",null)):null,T.a.createElement("blockquote",null,e.comments)),T.a.createElement("span",null,e.trip_id?T.a.createElement(F.a,{to:"/trips/".concat(e.trip_id)},"View Associated Trip"):null,T.a.createElement("br",null),"Owner:"," ",T.a.createElement(Yi,{request:e,onUpdate:function(){o(Object(H.a)({page:l},d))}})," ",T.a.createElement("br",null),"Created at: ",We.a.utc(e.created_at).format("Do MMM, YYYY"))]})})))}Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0,fetch:function(e){return Di(t).getTripPlanRequests({q:e}).then(function(e){return e.data})}},a))});function Ui(e){return T.a.createElement(ce,null,T.a.createElement("h2",null,"Trip Plan Requests"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(Ii,{path:":cabId"}),T.a.createElement(Li,{path:"/"})))}var Vi="TENANT_LIST_STATE",Bi={isFetching:!0,state:dt()},Qi={list:Object(L.createAsyncAction)("@TENANTS/LIST_FETCH_REQUEST","@TENANTS/LIST_FETCH_SUCCESS","@TENANTS/LIST_FETCH_FAILED")(),item:Object(L.createAsyncAction)("@TENANTS/ITEM_FETCH_REQUEST","@TENANTS/ITEM_FETCH_SUCCESS","@TENANTS/ITEM_FETCH_FAILED")()},Gi=pt(Bi,Qi);function Wi(e){var t=e[Vi];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function Ki(e){return{getTenant:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/tenants/".concat(a)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var zi=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Qi.item.request()),t.abrupt("return",Ki(c).getTenant(e).then(function(e){return a(Qi.item.success(e)),e}).catch(function(e){return a(Qi.item.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Ji(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(e){return Object(N.c)(function(t){var a=Wi(t);return{isFetching:a.isFetching,tenant:a.getItem(e)}})}(e),n=function(){var e=Z();return Object(w.useCallback)(function(t){return e(zi(t))},[e])}();return Object(w.useEffect)(function(){t&&e&&n(e)},[e,t,n]),Object(H.a)({},a,{fetchTenant:n})}function $i(e){var t=e.tenantId,a=e.navigate,n=Ji(t,!0),r=n.tenant,c=n.isFetching;return t?T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,r?r.name:"")),T.a.createElement(F.a,{to:".."},"Back to list"),c?"Loading...":r?T.a.createElement("div",null,T.a.createElement("h3",null,r.name),T.a.createElement("p",null,r.description),T.a.createElement("div",{className:"float-right"},r.invited_at?T.a.createElement("b",null,"Invited at:"," ",We.a.utc(r.invited_at).local().toLocaleString()):"Not invited yet",T.a.createElement("br",null),r.signup_at?T.a.createElement("b",null,"Signedup at:"," ",We.a.utc(r.signup_at).local().toLocaleString()):"Not invited yet"),T.a.createElement("h4",null,"Users"),T.a.createElement("ul",null,r.users?r.users.map(function(e){return T.a.createElement("li",{key:e.id},T.a.createElement(F.a,{to:"/users/".concat(e.id)},e.name)," -"," ",e.email," - ",e.email_verified_at)}):null)):T.a.createElement(F.d,{noThrow:!0,to:"/tenants"})):(a&&a("/tenants"),null)}function Xi(e){return{getTenants:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/tenants",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Zi=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Qi.list.request()),t.abrupt("return",Xi(c).getTenants(e).then(function(e){var t=e.data,n=e.meta;return a(Qi.list.success({data:t,meta:n})),t}).catch(function(e){return a(Qi.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function eu(){var e=Object(N.b)();return Object(w.useCallback)(function(t){return e(Zi(t))},[e])}function tu(){return Object(H.a)({},Object(N.c)(function(e){var t=Wi(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,tenants:t.get()})}),{fetchTenants:eu()})}function au(e){var t=tu(),a=t.tenants,n=t.total,r=t.from,c=t.to,l=t.currentPage,i=t.lastPage,u=t.isFetching,o=t.fetchTenants,s=Ct(),m=Object(Qe.a)(s,2),d=m[0],f=m[1];return Object(w.useEffect)(function(){o({page:l})},[o]),T.a.createElement(w.Fragment,null,T.a.createElement(q.a,null,T.a.createElement("title",null,"Agents")),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(kt,{onSearch:function(e){f(e),o(Object(H.a)({},e,{page:1}))}})),T.a.createElement(ct,{className:"text-right"},T.a.createElement(A.k,{total:n,from:r,to:c,currentPage:l,lastPage:i,isFetching:u,onChange:function(e){return o(Object(H.a)({},d,{page:e}))}}))),T.a.createElement(Tt,{isFetching:u,total:n},T.a.createElement(A.m,{headers:["Name","Description"],striped:!0,bordered:!0,rows:a.map(function(e){return[T.a.createElement(F.a,{to:e.id.toString()},e.name),e.description]})})))}Ce(function(e){var t=e.xhr,a=Object(ie.a)(e,["xhr"]);return T.a.createElement(qt.a,Object.assign({multiple:!0,fetch:function(e){return Xi(t).getTenants({q:e}).then(function(e){return e.data})}},a))});var nu=R.object().shape({name:R.string().required("Name for the tenant is required.").max(299,"Maximum 299 characters allowed"),description:R.string().max(299,"Maximum 299 characters allowed"),address_name:R.string().required("Addressing name is required"),address_email:R.string().email("Invalid email address").required("Addressing email is required"),send_invite:R.boolean()}),ru={name:"",description:"",address_name:"",address_email:"",send_invite:!0,tenant_signup_link:""};var cu=Ce(function(e){var t=e.xhr,a=e.navigate,n=e.location;return ru.tenant_signup_link=n?"".concat(n.origin,"/tenant-signup"):"",T.a.createElement("div",null,T.a.createElement(M.e,{initialValues:ru,validationSchema:nu,onSubmit:function(){var e=Object(Y.a)(D.a.mark(function e(n,r){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.setStatus(),e.abrupt("return",t.post("/tenants",Object(H.a)({},n,{send_invite:+(n.send_invite||!1)})).then(function(e){var t=e.data.data;a&&a("../".concat(t.id))}).catch(function(e){r.setStatus(e.message),e.formikErrors&&r.setErrors(e.formikErrors)}).then(function(){r.setSubmitting(!1)}));case 2:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),render:function(e){var t=e.isSubmitting,a=e.status,n=e.values;return T.a.createElement(M.d,{noValidate:!0},a?T.a.createElement("p",{className:"text-red-700 my-2"},a):null,T.a.createElement("fieldset",null,T.a.createElement("legend",null,"Add New Tenant"),T.a.createElement(rt,null,T.a.createElement(ct,null,T.a.createElement(fe,{label:"Name",name:"name",required:!0,placeholder:"Tourepedia Holidays"})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Description",name:"description",placeholder:"Tourepedia provides best tourisum services across India"})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Addressing Name",name:"address_name",placeholder:"Admin Name",required:!0})),T.a.createElement(ct,null,T.a.createElement(fe,{label:"Addressing Email",name:"address_email",type:"email",placeholder:"admin@domain.com",required:!0}))),T.a.createElement(fe,{label:"Send Invitation email also",name:"send_invite",type:"checkbox",checked:n.send_invite}),T.a.createElement("footer",null,T.a.createElement(A.d,{primary:!0,type:"submit",disabled:t},"Submit"),T.a.createElement(F.a,{to:"..",className:"btn"},"Cancel"))))}}))});function lu(e){return T.a.createElement(ce,null,T.a.createElement(F.a,{to:"new",className:"btn float-right"},"Add New Agent"),T.a.createElement("h2",null,"Agents"),T.a.createElement("hr",null),T.a.createElement(F.e,null,T.a.createElement(cu,{path:"/new"}),T.a.createElement($i,{path:":tenantId"}),T.a.createElement(au,{path:"/"})))}var iu=function(e){var t=e.location,a=z(t&&t.search).email||"";return T.a.createElement("div",{className:"pt-20"},T.a.createElement("div",{className:"max-w-xl mx-auto text-center text-xl border rounded-lg py-20 px-4"},T.a.createElement("div",null,T.a.createElement("div",{className:"text-center mb-10"},T.a.createElement("div",{className:"text-5xl w-20 h-20 rounded-full bg-green-400 inline-block text-white"},T.a.createElement(A.i.OkIcon,{className:"align-middle"}))),T.a.createElement("h1",null,"Your Email Verified Successfully."),T.a.createElement("p",null,"You can now"," ",T.a.createElement(F.a,{to:"/login?email=".concat(a),className:"text-blue-600 hover:text-blue-800"},"login")," ","to the Tourepedia Admin Dashboard."))))};a(320);function uu(e){var t=e.as,a=void 0===t?"div":t,n=e.className,r=e.alignRight,c=void 0!==r&&r,l=Object(ie.a)(e,["as","className","alignRight"]);return T.a.createElement(a,Object.assign({className:oe()("drop-down",{"align-right":c},n)},l))}a(321),a(322);var ou="NOTIFICATIONS_STATE",su={isFetching:!0,state:dt()},mu={list:Object(L.createAsyncAction)("@NOTIFICATIONS/LIST_FETCH_REQUEST","@NOTIFICATIONS/LIST_FETCH_SUCCESS","@NOTIFICATIONS/LIST_FETCH_FAILED")(),markAsRead:Object(L.createAsyncAction)("@NOTIFICATIONS/MARK_AS_READ_REQUEST","@NOTIFICATIONS/MARK_AS_READ_SUCCESS","@NOTIFICATIONS/MARK_AS_READ_FAILED")(),pushNewNotification:Object(L.createStandardAction)("@NOTIFICATIONS/PUSH_NEW_NOTIFICATION")()},du=pt(su,mu,function(e,t){switch(t.type){case Object(L.getType)(mu.markAsRead.success):return Object(H.a)({},e,{state:ft(e.state).insert(t.payload.data)});case Object(L.getType)(mu.pushNewNotification):return Object(H.a)({},e,{state:ft(e.state).insert([t.payload],void 0,!0)})}return e});function fu(e){var t=e[ou];return Object(H.a)({},ft(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}var pu=a(149),Eu=a(150),hu=a.n(Eu);var bu=T.a.createContext(void 0);$(bu,"channels");function gu(e){var t=e.children,a=re().user,n=Object(w.useState)(void 0),r=Object(Qe.a)(n,2),c=r[0],l=r[1];return Object(w.useEffect)(function(){a&&l(function(){var e=new hu.a(Ee.pusher.key,{cluster:Ee.pusher.cluster,forceTLS:!0,authEndpoint:Ee.pusher.authEndpoint,auth:{headers:{Authorization:"Bearer ".concat(Te())}}});return new pu.a({broadcaster:"pusher",client:e})}())},[a]),T.a.createElement(bu.Provider,{value:c},t)}var vu=".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated";function _u(e){return{getNotifications:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/notifications",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),markAsRead:function(){var t=Object(Y.a)(D.a.mark(function t(a){return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.patch("/notifications/mark-as-read",{items:a.map(function(e){return e.id})}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var yu=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(mu.list.request()),t.abrupt("return",_u(c).getNotifications(e).then(function(e){var t=e.data,n=e.meta;return a(mu.list.success({data:t,meta:n})),t}).catch(function(e){return a(mu.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()},Su=function(e){return function(){var t=Object(Y.a)(D.a.mark(function t(a,n,r){var c,l;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,l={data:e.map(function(e){return Object(H.a)({},e,{read_at:We.a.utc().toString()})})},a(mu.markAsRead.success(l)),t.abrupt("return",_u(c).markAsRead(e).then(function(e){return e.data}).catch(function(t){var n={data:e.map(function(e){return Object(H.a)({},e,{read_at:null})})};return a(mu.markAsRead.success(n)),Promise.reject(t)}));case 4:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function ju(){return Object(N.c)(function(e){var t=fu(e);return Object(H.a)({},t.meta,{isFetching:t.isFetching,notifications:t.get()})})}function Ou(){var e=Z();return Object(w.useCallback)(function(t){return e(yu(t))},[e])}function wu(){var e=Z(),t=ju().notifications;return Object(w.useCallback)(function(){return e(Su(t.filter(function(e){return!e.read_at})))},[e,t])}function Tu(e){var t=e.notification.data,a=t.id,n=t.price,r=t.converted_by;return T.a.createElement("div",null,T.a.createElement("div",null,T.a.createElement("div",{className:"font-bold mb-1"},T.a.createElement(F.a,{to:"/trips/".concat(a)},"Trip Conversion")),T.a.createElement("div",{className:"text-sm"},T.a.createElement(A.b,null,T.a.createElement(A.i.RupeeIcon,null)," ",n)," ","by ",r)))}function xu(e){var t,a=e.notification,n=a.created_at,r=a.read_at,c=function(){var e=Z();return Object(w.useCallback)(function(t){return e(Su(t))},[e])}();switch(a.type){case"App\\Notifications\\TripConverted":t=Tu;break;default:return console.warn("No renderer for '".concat(a.type,"' type notification")),null}return T.a.createElement("div",{className:oe()("p-3",{"bg-gray-100":r})},T.a.createElement(t,{notification:a}),T.a.createElement("footer",{className:"mt-1 text-sm text-gray-600"},We.a.utc(n).local().fromNow()," ","\u2022"," ",r?T.a.createElement("span",null,"Read"):T.a.createElement("button",{className:"text-primary-600",onClick:function(){return c([a])}},T.a.createElement(A.i.OkIcon,{title:"Mark as Read"}))))}function Cu(e){var t=T.a.useContext(bu),a=Object(w.useMemo)(function(){return t&&t.private("users."+e)},[e,t]);if(e&&t)return a}function Nu(){var e=re().user,t=Object(H.a)({},ju(),{fetchNotifications:Ou(),markAllAsRead:wu()}),a=t.notifications,n=t.fetchNotifications,r=t.markAllAsRead;return function(){var e=re().user,t=Z(),a=Cu(e&&e.id);Object(w.useEffect)(function(){if(a)return a.notification(function(e){t(mu.pushNewNotification(e))}),function(){a.stopListening(vu)}},[t,a])}(),Object(w.useEffect)(function(){e&&n()},[e,n]),e&&a&&a.length?T.a.createElement(uu,{as:"li",className:"inline-block",alignRight:!0},T.a.createElement("a",{href:"#view-notifications",className:"toggler"},T.a.createElement(A.b,{primary:!0},a.filter(function(e){return!e.read_at}).length.toString())),T.a.createElement("ul",{className:"menu",style:{maxHeight:"40vh",minWidth:"250px",overflow:"auto"}},T.a.createElement("header",{className:"px-3 py-2 text-sm border-b flex justify-between"},T.a.createElement("span",{className:"font-bold "},"Notifications"),T.a.createElement("button",{className:"text-primary-600",onClick:r},"Mark All as Read")),a.map(function(e,t){return T.a.createElement("li",{key:e.id,className:"border-t"},T.a.createElement(xu,{notification:e}))}))):null}var ku=function(){var e=re().user,t=Ue(),a=t.hasPermission,n=t.hasAnyPermission;if(!e)return null;var r=e.name,c=e.tenant;return T.a.createElement("header",{className:"mb-4 text-base bg-white border-t-4 border-primary-600"},T.a.createElement("nav",{className:"sm:flex border-b items-stretch md:justify-between"},T.a.createElement(F.a,{to:"/",className:"inline-flex h-16 px-2 mr-4 sm:mr-auto"},T.a.createElement("div",{className:"flex items-center"},T.a.createElement("img",{alt:"Tourepedia Logo",src:Ee.publicUrl+"/logo.png",className:"inline-block align-middle rounded-full shadow h-8 w-8 mr-2"}),T.a.createElement("h1",{className:"font-normal text-base m-0 md:block"},c?c.name:"Tourepedia Dashboard"))),T.a.createElement("ul",{className:"flex w-full md:w-auto md:px-4 h-16 items-center justify-between md:justify-end"},T.a.createElement(uu,{as:"li",className:"inline-block"},T.a.createElement(F.a,{to:"/trips",className:"inline-block"},"Trips"),T.a.createElement("ul",null,T.a.createElement(Ve,{to:"/trips"},"Trips"),n(Le,Re)?T.a.createElement(Ve,{to:"/trip-plan-requests"},"Trip Plan Requests"):null,T.a.createElement(Ve,{to:"/trip-sources"},"Trip Sources"),T.a.createElement(Ve,{to:"/trip-stages"},"Trip Stages"))),T.a.createElement(uu,{as:"li",className:"inline-block"},T.a.createElement(F.a,{to:"/hotels"},"Hotels"),T.a.createElement("ul",null,T.a.createElement(Ve,{to:"/hotels"},"Hotels"),T.a.createElement(Ve,{to:"/hotel-prices"},"Hotel Prices"),T.a.createElement(Ve,{to:"/meal-plans"},"Meal Plans"),T.a.createElement(Ve,{to:"/room-types"},"Room Types"),T.a.createElement(Ve,{to:"/hotel-payment-preferences"},"Payment Preferences"),T.a.createElement(Ve,{to:"/hotel-booking-stages"},"Booking Stages"))),T.a.createElement(uu,{as:"li",className:"inline-block",alignRight:!0},T.a.createElement(F.a,{to:"/transport-services"},"Transportation"),T.a.createElement("ul",null,T.a.createElement(Ve,{to:"/transport-services"},"Transport Services"),T.a.createElement(Ve,{to:"/cab-types"},"Cab Types"),T.a.createElement(Ve,{to:"/transport-service-prices"},"Transport Service Prices"),T.a.createElement(Ve,{to:"/locations"},"Locations"),T.a.createElement(Ve,{to:"/cabs"},"Cabs"))),a(He)?T.a.createElement(uu,{as:"li",className:"inline-block",alignRight:!0},T.a.createElement(F.a,{to:"/users"},"Users"),T.a.createElement("ul",{className:"menu"},T.a.createElement(Ve,{to:"/users"},"Users"),a(De)?T.a.createElement(Ve,{to:"/roles"},"Roles"):null,a(Ye)?T.a.createElement(Ve,{to:"/tenants"},"Agents"):null)):null,T.a.createElement(Nu,null),T.a.createElement(uu,{as:"li",className:"inline-block",alignRight:!0},T.a.createElement("a",{className:"toggler",href:"#profile-and-settings"},T.a.createElement(A.i.CogAltIcon,{title:"Hi ".concat(r)})),T.a.createElement("ul",{className:"menu"},T.a.createElement(Ve,{to:"/settings"},T.a.createElement(A.i.CogAltIcon,null)," Settings"),T.a.createElement(F.b,null,function(e){var t=e.location;return T.a.createElement(Ve,{to:"/logout?from=".concat(t.pathname)},T.a.createElement(A.i.OffIcon,null)," Logout")}))))))};function Pu(){return T.a.createElement("footer",{className:"border-t mt-8"},T.a.createElement(nt,{fluid:!0},T.a.createElement("div",{className:"py-4"},T.a.createElement("span",null,"\xa9 2019 Tourepedia. All rights reserved")," \u2022 ",T.a.createElement("span",null,"v",Ee.appVersion))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var qu=a(151),Fu=a(152);var Au,Iu=function(e,t){var a=t.initialState,n=t.thunkExtraAgrs,r=[Fu.a.withExtraArgument(n)],c=[k.applyMiddleware.apply(void 0,r)];return Object(k.createStore)(e,a,qu.composeWithDevTools.apply(void 0,c))}(Object(k.combineReducers)((Au={},Object(O.a)(Au,n.key,n.reducer),Object(O.a)(Au,c.key,c.reducer),Object(O.a)(Au,r.key,r.reducer),Object(O.a)(Au,u.key,u.reducer),Object(O.a)(Au,o.key,o.reducer),Object(O.a)(Au,s.key,s.reducer),Object(O.a)(Au,l.key,l.reducer),Object(O.a)(Au,d.key,d.reducer),Object(O.a)(Au,f.key,f.reducer),Object(O.a)(Au,p.key,p.reducer),Object(O.a)(Au,v.key,v.reducer),Object(O.a)(Au,E.key,E.reducer),Object(O.a)(Au,g.key,g.reducer),Object(O.a)(Au,b.key,b.reducer),Object(O.a)(Au,m.key,m.reducer),Object(O.a)(Au,h.key,h.reducer),Object(O.a)(Au,_.key,_.reducer),Object(O.a)(Au,y.key,y.reducer),Object(O.a)(Au,i.key,i.reducer),Object(O.a)(Au,S.key,S.reducer),Au)),{thunkExtraAgrs:{xhr:Ne}}),Du=T.a.createElement(N.a,{store:Iu},T.a.createElement(P.HelmetProvider,null,T.a.createElement(xe.Provider,{value:Ne},T.a.createElement(function(e){var t=e.children,a=void 0===t?null:t,n=re(),r=n.user,c=n.wait,l=n.isAuthenticating,i=n.fetchUser;return Object(w.useEffect)(function(){r||l||i()},[i]),T.a.createElement(w.Fragment,null,"function"===typeof a?a({wait:c,user:r}):a)},null,T.a.createElement(function(){return T.a.createElement(gu,null,T.a.createElement(q.a,{titleTemplate:"%s | Tourepedia",defaultTitle:"Tourepedia"}),T.a.createElement(ku,null),T.a.createElement("main",{style:{minHeight:"80vh"}},T.a.createElement(nt,{fluid:!0},T.a.createElement(F.e,null,T.a.createElement(_e,{path:"/login"}),T.a.createElement(qe,{path:"/invited-signup"}),T.a.createElement(Ie,{path:"/tenant-signup"}),T.a.createElement(ut,{path:"/forgot-password"}),T.a.createElement(st,{path:"/reset-password"}),T.a.createElement(Xe,{path:"/"}),T.a.createElement(je,{path:"/logout"}),T.a.createElement(lt,{path:"/settings/*"}),T.a.createElement(pa,{path:"/users/*"}),T.a.createElement(da,{path:"/roles/*"}),T.a.createElement(vr,{path:"/hotels/*"}),T.a.createElement(en,{path:"/meal-plans/*"}),T.a.createElement(En,{path:"/room-types/*"}),T.a.createElement(Zn,{path:"/locations/*"}),T.a.createElement(Ar,{path:"/cab-types/*"}),T.a.createElement(Xr,{path:"/cabs/*"}),T.a.createElement(Ti,{path:"/trips/*"}),T.a.createElement(Si,{path:"/trip-sources/*"}),T.a.createElement(gc,{path:"/trip-stages/*"}),T.a.createElement(Sl,{path:"/transport-services/*"}),T.a.createElement(Pl,{path:"/transport-service-prices/*"}),T.a.createElement(Er,{path:"/hotel-payment-preferences/*"}),T.a.createElement(Lc,{path:"/hotel-booking-stages/*"}),T.a.createElement(Ui,{path:"/trip-plan-requests/*"}),T.a.createElement(lu,{path:"/tenants/*"}),T.a.createElement(wn,{path:"/hotel-prices/*"}),T.a.createElement(iu,{path:"email-verified"}),T.a.createElement(Ze,{default:!0})))),T.a.createElement(Pu,null))},null)))));C.a.render(Du,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[154,1,2]]]);
//# sourceMappingURL=main.5c2f2060.chunk.js.map