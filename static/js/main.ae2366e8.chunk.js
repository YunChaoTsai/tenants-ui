(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{142:function(e,t){},149:function(e,t,a){e.exports=a(318)},313:function(e,t,a){},314:function(e,t,a){},315:function(e,t,a){},316:function(e,t,a){},317:function(e,t,a){},318:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"key",function(){return R}),a.d(n,"AuthUserStatus",function(){return _}),a.d(n,"actions",function(){return L}),a.d(n,"reducer",function(){return U}),a.d(n,"selectors",function(){return V});var r={};a.r(r),a.d(r,"key",function(){return $e}),a.d(r,"actions",function(){return Ze}),a.d(r,"reducer",function(){return et}),a.d(r,"selectors",function(){return tt});var c={};a.r(c),a.d(c,"key",function(){return wt}),a.d(c,"actions",function(){return xt}),a.d(c,"reducer",function(){return Nt}),a.d(c,"selectors",function(){return kt});var l={};a.r(l),a.d(l,"key",function(){return $t}),a.d(l,"hotelActions",function(){return Xt}),a.d(l,"priceActions",function(){return Zt}),a.d(l,"actions",function(){return ea}),a.d(l,"reducer",function(){return aa}),a.d(l,"selectors",function(){return na});var i={};a.r(i),a.d(i,"key",function(){return fa}),a.d(i,"actions",function(){return pa}),a.d(i,"reducer",function(){return ha}),a.d(i,"selectors",function(){return ba});var u={};a.r(u),a.d(u,"key",function(){return xa}),a.d(u,"actions",function(){return ka}),a.d(u,"reducer",function(){return Pa}),a.d(u,"selectors",function(){return Fa});var o={};a.r(o),a.d(o,"key",function(){return en}),a.d(o,"actions",function(){return an}),a.d(o,"reducer",function(){return nn}),a.d(o,"selectors",function(){return rn});var s={};a.r(s),a.d(s,"key",function(){return vn}),a.d(s,"actions",function(){return Sn}),a.d(s,"reducer",function(){return yn}),a.d(s,"selectors",function(){return jn});var m={};a.r(m),a.d(m,"key",function(){return Vn}),a.d(m,"actions",function(){return Qn}),a.d(m,"reducer",function(){return Gn}),a.d(m,"selectors",function(){return Kn});var d={};a.r(d),a.d(d,"key",function(){return rr}),a.d(d,"actions",function(){return lr}),a.d(d,"reducer",function(){return ir}),a.d(d,"selectors",function(){return ur});var f={};a.r(f),a.d(f,"key",function(){return yr}),a.d(f,"actions",function(){return Or}),a.d(f,"reducer",function(){return Tr}),a.d(f,"selectors",function(){return wr});var E={};a.r(E),a.d(E,"key",function(){return Fr}),a.d(E,"actions",function(){return Ar}),a.d(E,"reducer",function(){return Ir}),a.d(E,"selectors",function(){return Dr});var p={};a.r(p),a.d(p,"key",function(){return tc}),a.d(p,"actions",function(){return nc}),a.d(p,"reducer",function(){return rc}),a.d(p,"selectors",function(){return cc});var h={};a.r(h),a.d(h,"key",function(){return sc}),a.d(h,"actions",function(){return dc}),a.d(h,"reducer",function(){return fc}),a.d(h,"selectors",function(){return Ec});var b={};a.r(b),a.d(b,"key",function(){return tl}),a.d(b,"actions",function(){return nl}),a.d(b,"reducer",function(){return rl}),a.d(b,"selectors",function(){return cl});var g={};a.r(g),a.d(g,"key",function(){return _l}),a.d(g,"actions",function(){return yl}),a.d(g,"reducer",function(){return jl}),a.d(g,"selectors",function(){return Ol});var v={};a.r(v),a.d(v,"key",function(){return Al}),a.d(v,"actions",function(){return Dl}),a.d(v,"reducer",function(){return Ml}),a.d(v,"selectors",function(){return Yl});var _,S=a(16),y=a(0),j=a.n(y),O=a(43),T=a.n(O),w=a(13),C=a(22),x=a(9),N=a.n(x),k=a(5),P=a(1),F=(a(165),a(4)),q=a.n(F),A=a(7),I=a(6),D=a(3),M=a(2),Y=a(12),R="AUTHENTICATED_USER_STATE";!function(e){e.DEFAULT="DEFAULT",e.CHECKING="CHECKING",e.UN_AUTHENTICATED="UN_AUTHENTICATED",e.AUTHENTICATING="AUTHENTICATING",e.AUTHENTICATED="AUTHENTICATED"}(_||(_={}));var H={data:void 0,status:_.DEFAULT},L={checkAuth:Object(Y.createAsyncAction)("@AUTH/CHECK_AUTH_REQUEST","@AUTH/CHECK_AUTH_SUCCESS","@AUTH/CHECK_AUTH_FAILED")(),login:Object(Y.createAsyncAction)("@AUTH/LOGIN_REQUEST","@AUTH/LOGIN_SUCCESS","@AUTH/LOGIN_FAILED")(),logout:Object(Y.createAsyncAction)("@AUTH/LOGOUT_REQUEST","@AUTH/LOGOUT_SUCCESS","@AUTH/LOGOUT_FAILED")()};function U(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(Y.getType)(L.checkAuth.request):return Object(M.a)({},e,{status:_.CHECKING});case Object(Y.getType)(L.login.request):return Object(M.a)({},e,{status:_.AUTHENTICATING});case Object(Y.getType)(L.checkAuth.success):case Object(Y.getType)(L.login.success):return Object(M.a)({},e,{status:_.AUTHENTICATED,data:t.payload});case Object(Y.getType)(L.checkAuth.failure):case Object(Y.getType)(L.login.failure):return Object(M.a)({},e,{status:_.UN_AUTHENTICATED});case Object(Y.getType)(L.logout.success):return Object(M.a)({},e,{status:_.UN_AUTHENTICATED,data:void 0});default:return e}}function V(e){return{get state(){return e[R]},get user(){return this.state.data},get status(){return this.state.status},get noRequestYet(){return this.status===_.DEFAULT},get isAuthenticated(){return this.status===_.AUTHENTICATED},get isAuthenticating(){return this.status===_.AUTHENTICATING||this.status===_.CHECKING},get wait(){return this.isAuthenticating||this.noRequestYet}}}var B=a(88),Q=a.n(B);function G(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"?",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Q.a.parse(e,Object(M.a)({ignoreQueryPrefix:!0},t))}function K(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Q.a.stringify(e,Object(M.a)({addQueryPrefix:!0},t))}function W(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function J(){return Object(w.b)()}function z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Please enter a valid number";return D.number().transform(function(e,t){return this.isType(e)?e:t&&t.trim()?t:null}).nullable(!0).typeError(e)}function $(e){return{getUser:function(){var t=Object(A.a)(q.a.mark(function t(){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/me").then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}}var X=function(){return function(){var e=Object(A.a)(q.a.mark(function e(t,a,n){var r;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.xhr,t(L.checkAuth.request()),e.abrupt("return",$(r).getUser().then(function(e){return t(L.checkAuth.success(e)),e}).catch(function(e){return t(L.checkAuth.failure(e)),Promise.reject(e)}));case 3:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}()};function Z(){var e=J();return Object(y.useCallback)(function(){return e(X())},[e])}function ee(){return Object(M.a)({},Object(w.c)(function(e){var t=V(e);return{user:t.user,wait:t.wait,isAuthenticating:t.isAuthenticating,isAuthenticated:t.isAuthenticated}}),{fetchUser:Z()})}function te(e){var t=e.children,a=void 0===t?null:t,n=ee(),r=n.wait,c=n.user;return r?null:c?j.a.createElement(y.Fragment,null,a):j.a.createElement(k.b,null,function(e){var t=e.location;return j.a.createElement(k.d,{to:"/login?next=".concat(t.pathname),noThrow:!0})})}function ae(e){var t=e.children,a=void 0===t?null:t,n=e.to,r=void 0===n?"/":n,c=ee(),l=c.wait,i=c.user;return l?null:i?j.a.createElement(k.d,{to:r,noThrow:!0}):j.a.createElement(y.Fragment,null,a)}var ne=a(11);function re(e){var t=e.className,a=void 0===t?"":t,n=Object(ne.a)(e,["className"]);return j.a.createElement(I.a,Object.assign({component:P.f,className:"".concat(a)},n))}function ce(e){var t=e.as,a=void 0===t?"input":t,n=e.id,r=e.name,c=Object(ne.a)(e,["as","id","name"]);return j.a.createElement(a,Object.assign({className:"input",name:r,id:n||r},c))}function le(e){var t=e.name,a=e.render,n=e.children,r=(e.ref,Object(ne.a)(e,["name","render","children","ref"]));return j.a.createElement(I.b,{name:t,render:function(e){var t=e.field.name,c=e.form,l=c.touched,i=c.errors,u=Object(I.f)(l,t),o=Object(I.f)(i,t);return j.a.createElement(P.g,Object.assign({hasError:!(!u||!o),"aria-errormessage":o},r),n||a(e),j.a.createElement(re,{name:t}))}})}function ie(e){var t=e.label,a=e.name,n=e.type,r=e.className,c=e.labelPlacement,l=e.noGroup,i=Object(ne.a)(e,["label","name","type","className","labelPlacement","noGroup"]);c=c||("checkbox"===n||"radio"===n?"after":"before");var u=t?j.a.createElement("label",{htmlFor:a},t):null;function o(e){var t=e.field;return j.a.createElement(y.Fragment,null,"before"===c?u:null,j.a.createElement(ce,Object.assign({},i,{type:n},t)),"after"===c?u:null)}return l?j.a.createElement(I.b,{name:a,render:o}):j.a.createElement(le,{name:a,className:r,render:o})}var ue=D.object().shape({email:D.string().email("Invalid email address").required("Email field is required"),password:D.string().required("Password field is required")}),oe={email:"",password:""};function se(e){return{login:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/login",a).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),refresh:function(){var t=Object(A.a)(q.a.mark(function t(){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.patch("/refresh").then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}}var me=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,L.login.request(),t.abrupt("return",se(c).login(e).then(function(){return a(X())}).catch(function(e){return L.login.failure(e),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function de(e){var t=e.location,a=G(t&&t.search).next,n=function(){var e=J();return Object(y.useCallback)(function(t){return e(me(t))},[e])}();return j.a.createElement(ae,{to:a},j.a.createElement(N.a,null,j.a.createElement("title",null,"Sign in to TAD")),j.a.createElement("div",{className:"min-h-screen"},j.a.createElement("div",{className:"text-center"},j.a.createElement("img",{src:"/logo.png",className:"inline-block mt-16 w-20 rounded-full shadow"})),j.a.createElement("h1",{className:"text-center my-4"},"Sign in to TAD"),j.a.createElement("div",{className:"max-w-sm mx-auto"},j.a.createElement(I.e,{initialValues:oe,onSubmit:function(e,t){t.setStatus(),n(e).catch(function(e){t.setStatus(e.message),t.setSubmitting(!1)})},validationSchema:ue,render:function(e){var t=e.isSubmitting,a=e.status;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",null,a?j.a.createElement("p",{className:"text-red-700",role:"alert"},a):null,j.a.createElement(ie,{label:"Email",name:"email",type:"email",autoFocus:!0,id:"email",placeholder:"username@domain.com",autoComplete:"username email",required:!0,tabIndex:1}),j.a.createElement(k.a,{to:"/forgot-password",className:"float-right text-blue-600 hover:text-blue-800 text-sm"},"Forgot Password ?"),j.a.createElement(ie,{label:"Password",name:"password",type:"password",id:"password",required:!0,autoComplete:"current-password",tabIndex:2}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,tabIndex:3,type:"submit",className:"w-full",disabled:t},"Sign in"))))}}))))}function fe(e){return{logout:function(){var t=Object(A.a)(q.a.mark(function t(){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.delete("/logout").then(function(e){return localStorage.removeItem("access_token"),e}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}}var Ee=function(){return function(){var e=Object(A.a)(q.a.mark(function e(t,a,n){var r;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.xhr,e.abrupt("return",fe(r).logout().then(function(){t(L.logout.success())}));case 2:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}()};var pe=function(e){var t=e.navigate,a=e.location,n=G(a&&a.search).from,r=function(){var e=J();return Object(y.useCallback)(function(){return e(Ee())},[e])}();return Object(y.useEffect)(function(){r().then(function(){t&&t(n||"/")})},[]),j.a.createElement("div",null,"Logging out")},he=a(15),be=a.n(he);function ge(e){var t=e.to,a=e.children,n=e.className,r=void 0===n?"":n;return j.a.createElement(k.c,{path:t},function(e){var n=e.match;return j.a.createElement("li",{className:be()(r,n?"active":void 0)},j.a.createElement(k.a,{to:t},a))})}var ve=ge,_e=a(10),Se=a(8),ye=a.n(Se),je=a(44),Oe=a.n(je);Oe.a.defaults.baseURL="https://api.tourepedia.com/api",Oe.a.interceptors.request.use(Object(C.compose)(function(e){return e.headers.Authorization="Bearer ".concat(localStorage.getItem("access_token")),e},function(e){var t=e.data,a=e.params;return e.headers["Content-Type"]="application/x-www-form-urlencoded",t instanceof FormData?e:(e.data=K(t,{addQueryPrefix:!1}),e.url=e.url+K(a),e.params=void 0,e)},function(e){var t=(e.method||"").toUpperCase(),a=e.data||{};switch(t){case"DELETE":case"PATCH":case"PUT":a instanceof FormData?a.append("_method",t):a._method=t,e.method="POST"}return e.data=a,e})),Oe.a.interceptors.response.use(Object(C.compose)(function(e){var t=e.data;return t.access_token&&localStorage.setItem("access_token",t.access_token),e}),Object(C.compose)(function(e){var t=e.response&&e.response.data;if(!t)return Promise.reject(e);if(t.errors){var a=Object.keys(t.errors).reduce(function(e,a){return e[a]=t.errors[a].join(", "),e},{});t.formikErrors=a}return Promise.reject(t)},function(e){var t=e.response;if(t){var a=t.data&&t.data;if(503===a.status_code){if(t.headers&&t.headers["retry-after"]){var n=t.headers["retry-after"];setTimeout(function(){window.location=window.location},1e3*parseInt(n))}alert(a.message)}}return e},function(e){var t=e.response;if(t){var a=t.data&&t.data;if(429===a.status_code){if(t.headers&&t.headers["retry-after"]){var n=t.headers["retry-after"];setTimeout(function(){window.location=window.location},1e3*parseInt(n))}alert(a.message)}}return e}));var Te,we,Ce=j.a.createContext(Oe.a),xe=(Te=Ce,we="xhr",function(e){function t(t){return j.a.createElement(Te.Consumer,null,function(a){var n=Object(M.a)(Object(S.a)({},we,a),t);return j.a.createElement(e,n)})}t.WrappedComponent=e;var a=e.displayName||e.name||"Component",n=Te.Consumer.name||"Context.Consumer";return t.displayName=a+"("+n+"."+we+")",t}),Ne=Oe.a;function ke(e){return{getConvertedTripAnalytics:function(){var t=Object(A.a)(q.a.mark(function t(){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/converted-trips").then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),getDuePayments:function(){var t=Object(A.a)(q.a.mark(function t(){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/instalments").then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),getTransactions:function(){var t=Object(A.a)(q.a.mark(function t(){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/payment-transactions").then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}}function Pe(e){var t=e.xhr,a=Object(y.useState)([]),n=Object(_e.a)(a,2),r=n[0],c=n[1];return Object(y.useEffect)(function(){ke(t).getConvertedTripAnalytics().then(c)},[]),j.a.createElement("section",null,j.a.createElement("h2",null,"Converted trips over time"),j.a.createElement(P.l,{responsive:!0,bordered:!0,striped:!0,headers:["ID","Dates","Stages","Destinations","Traveler","Pax"],rows:r.map(function(e){var t=e.id,a=e.trip_source,n=e.trip_id,r=e.start_date,c=e.end_date,l=e.locations,i=e.no_of_adults,u=e.children,o=e.contact,s=e.latest_stage;return[j.a.createElement(k.a,{to:"/trips/"+t.toString()},a.short_name,"-",n||t),"".concat(ye.a.utc(r).local().format("DD/MM/YYYY")," to ").concat(ye.a.utc(c).local().format("DD/MM/YYYY")),s?s.name:"Initiated",l.map(function(e){return e.short_name}).join(" \u2022\xa0"),o?j.a.createElement("div",null,o.name,j.a.createElement("br",null),j.a.createElement("a",{href:"tel:".concat(o.phone_number),className:"btn--icon"},j.a.createElement(P.h.PhoneIcon,{title:"Call to ".concat(o.name," on ").concat(o.phone_number)})),j.a.createElement("a",{href:"mailto:".concat(o.email),className:"btn--icon"},j.a.createElement(P.h.MailIcon,{title:"Send Email to ".concat(o.name," at ").concat(o.email)}))):null,"".concat(i," Adults").concat(u?" with "+u:"")]})}))}function Fe(e){var t=e.xhr,a=Object(y.useState)([]),n=Object(_e.a)(a,2),r=n[0],c=n[1];return Object(y.useEffect)(function(){ke(t).getDuePayments().then(c)},[]),j.a.createElement("section",null,j.a.createElement("h2",null,"Due payments"),j.a.createElement(P.l,{bordered:!0,responsive:!0},j.a.createElement("thead",null,j.a.createElement("tr",null,j.a.createElement("th",null,"Due Date"),r.map(function(e,t){return j.a.createElement("th",{key:t},ye.a.utc(e.due_date).local().format("DD/MM/YYYY"))}))),j.a.createElement("tbody",null,j.a.createElement("tr",null,j.a.createElement("th",null,"Amount"),r.map(function(e,t){return j.a.createElement("td",{key:t},e.is_credit?"+":"-",e.due_amount)})))))}function qe(e){var t=e.xhr,a=Object(y.useState)({data:[],debited:0,credited:0}),n=Object(_e.a)(a,2),r=n[0],c=n[1];return Object(y.useEffect)(function(){ke(t).getTransactions().then(function(e){var t=e.data,a=e.meta;return c(Object(M.a)({data:t},a))})},[]),j.a.createElement("section",null,j.a.createElement("h2",null,"Transactions"),j.a.createElement("div",null,"Credited: ",r.credited," \u2022 Debited: ",r.debited),j.a.createElement(P.l,{responsive:!0,bordered:!0},j.a.createElement("thead",null,j.a.createElement("tr",null,j.a.createElement("th",null,"Date"),r.data.map(function(e,t){return j.a.createElement("th",{key:t},ye.a.utc(e.date).local().format("DD/MM/YYYY"))}))),j.a.createElement("tbody",null,j.a.createElement("tr",null,j.a.createElement("th",null,"Amount"),r.data.map(function(e,t){return j.a.createElement("td",{key:t},e.is_credited?"+":"-",e.amount)})))))}var Ae=xe(function(e){var t=e.xhr;return j.a.createElement(te,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Dashboard")),j.a.createElement(Pe,{xhr:t}),j.a.createElement(Fe,{xhr:t}),j.a.createElement(qe,{xhr:t}))});function Ie(e){return j.a.createElement("div",null,j.a.createElement("h2",null,"Not Found"),j.a.createElement(k.a,{to:"/"},"Visit Dashboard"))}var De=D.object().shape({current:D.string().required("Current password field is required"),password:D.string().required("Password field is required"),password_confirmation:D.string().required("Password confirmation field is required")});var Me={current:"",password:"",password_confirmation:""};var Ye=xe(function(e){var t=e.xhr,a=e.navigate,n=ee().user;return j.a.createElement(te,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Change Password")),j.a.createElement(I.e,{initialValues:Me,validationSchema:De,onSubmit:function(e,n){n.setStatus(),function(e){return{changePassword:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.patch("/passwords",a));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}(t).changePassword(e).then(function(){alert("Password updated successfully"),a&&a("/")}).catch(function(e){e.formikErrors&&n.setErrors(e.formikErrors),n.setStatus(e.message),n.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Change Password"),n?j.a.createElement("input",{type:"email",name:"email",value:n.email,hidden:!0,readOnly:!0,autoComplete:"username"}):null,j.a.createElement(ie,{label:"Current Password",name:"current",type:"password",required:!0,id:"current",autoComplete:"current-password"}),j.a.createElement(ie,{name:"password",label:"New Password",type:"password",required:!0,id:"password",autoComplete:"new-password"}),j.a.createElement(ie,{label:"Confirm new password",name:"password_confirmation",type:"password",required:!0,id:"password_confirmation",autoComplete:"new-password"}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Update"))))}}))});a(313);function Re(e){var t=e.fluid,a=e.className,n=e.as,r=void 0===n?"div":n,c=Object(ne.a)(e,["fluid","className","as"]);return j.a.createElement(r,Object.assign({className:"container".concat(t?"-fluid":""," ").concat(a||"")},c))}function He(e){var t=e.className,a=e.noGutters,n=e.as,r=void 0===n?"div":n,c=Object(ne.a)(e,["className","noGutters","as"]);return j.a.createElement(r,Object.assign({className:"row ".concat(a?"no-gutters":""," ").concat(t||"")},c))}function Le(e){var t=e.className,a=e.xs,n=e.sm,r=e.md,c=e.lg,l=e.xl,i=e.as,u=void 0===i?"div":i,o=Object(ne.a)(e,["className","xs","sm","md","lg","xl","as"]),s=[],m=[];return[["xs",a],["sm",n],["md",r],["lg",c],["xl",l]].forEach(function(e){var t,a,n,r=Object(_e.a)(e,2),c=r[0],l=r[1];null!==l&&"object"===typeof l?(t=l.span,a=l.offset,n=l.order):t=l;var i="xs"!==c?"-".concat(c):"";null!=t&&m.push(!0===t?"".concat("col").concat(i):"".concat("col").concat(i,"-").concat(t)),null!=n&&s.push("order".concat(i,"-").concat(n)),null!=a&&s.push("offset".concat(i,"-").concat(a))}),m.length||m.push("col"),j.a.createElement(u,Object.assign({className:be.a.apply(void 0,[t].concat(s,m))},o))}var Ue=function(e){return j.a.createElement(te,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Settings")),j.a.createElement("h2",null,"Settings"),j.a.createElement(Re,{fluid:!0},j.a.createElement(He,null,j.a.createElement(Le,{as:"fieldset",sm:2},j.a.createElement("ul",{className:"list"},j.a.createElement("li",null,j.a.createElement(k.a,{to:"change-password"},"Change Password")))),j.a.createElement(Le,{className:"col-sm"},j.a.createElement(k.e,null,j.a.createElement(Ye,{path:"change-password"}),j.a.createElement(Ye,{path:"/"}))))))},Ve=D.object().shape({email:D.string().email("Invalid email address").required("Email field is required")});var Be=xe(function(e){var t=e.xhr,a=e.navigate,n=e.location,r=G(n&&n.search).email||"";return j.a.createElement(ae,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Forgot Password")),j.a.createElement("div",{className:"text-center mt-16"},j.a.createElement("h1",null,"Forgot Your Password?"),j.a.createElement("p",null,"No problem. Just enter your email address and we will send instructions to reset your password. ",j.a.createElement("br",null),"Or"," ",j.a.createElement(k.a,{to:"/login",className:"text-blue-600 hover:text-blue-800"},"Login")," ","if you remember your password!")),j.a.createElement("div",{className:"max-w-sm mx-auto"},j.a.createElement(I.e,{initialValues:{email:r,reset_password_link:"".concat(n&&n.origin,"/reset-password")},validationSchema:Ve,onSubmit:function(e,n){n.setStatus(),function(e){return{forgotPassword:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/passwords/reset",a));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}(t).forgotPassword(e).then(function(){alert("Please check your inbox for password reset instructions."),n.setSubmitting(!1),a&&a("/login")}).catch(function(e){n.setStatus(e.message),n.setSubmitting(!1)})},render:function(e){var t=e.status,a=e.isSubmitting,n=e.values;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",null,t?j.a.createElement("p",{role:"alert",className:"text-red-700"},t):null,j.a.createElement(ie,{name:"email",label:"Email",placeholder:"username@domain.com",autoComplete:"username email",required:!0,autoFocus:!0,type:"email",id:"email",tabIndex:1}),j.a.createElement("input",{type:"hidden",name:"reset_password_link",hidden:!0,value:n.reset_password_link}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,tabIndex:2,type:"submit",disabled:a},"Get Instructions"))))}})))}),Qe=D.object().shape({email:D.string().required("Email field is required").email("Invalid email address"),token:D.string().required("Missing token to reset values. Please check for valid url from sent email"),password:D.string().required("Password field is required"),password_confirmation:D.string().required("Password confirmation field is required")});var Ge=xe(function(e){var t=e.navigate,a=e.location,n=e.xhr,r=G(a&&a.search),c=r.email,l=r.token;return c&&l||t&&t("/"),j.a.createElement("div",null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Reset Password")),j.a.createElement("div",{className:"text-center mt-16"},j.a.createElement("h1",null,"Reset Password"),j.a.createElement("p",null,"Just enter your new password to reset the password for your email address (",c,")")),j.a.createElement("div",{className:"max-w-sm mx-auto"},j.a.createElement(I.e,{initialValues:{email:c,token:l,password:"",password_confirmation:""},validationSchema:Qe,onSubmit:function(e,a){a.setStatus(),function(e){return{resetPassword:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.delete("/passwords/reset",{data:a}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}(n).resetPassword(e).then(function(){alert("Your passwords updated successfully. You can now log in with the new password"),t&&t("/login")}).catch(function(e){e.formikErrors&&a.setErrors(e.formikErrors),a.setStatus(e.message),a.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",null,a?j.a.createElement("p",{className:"text-red-700",role:"alert"},a):null,j.a.createElement(I.b,{name:"email",render:function(e){var t=e.field,a=t.value,n=t.name;return j.a.createElement("input",{type:"hidden",hidden:!0,name:n,value:a})}}),j.a.createElement(I.b,{name:"token",render:function(e){var t=e.field,a=t.value,n=t.name;return j.a.createElement("input",{type:"hidden",value:a,name:n})}}),j.a.createElement(ie,{label:"Password",name:"password",type:"password",id:"password",autoFocus:!0,autoComplete:"new-password",required:!0}),j.a.createElement(ie,{label:"Confirm Password",name:"password_confirmation",type:"password",id:"password_confirmation",autoComplete:"new-password",required:!0}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Reset Password"))))}}),j.a.createElement("div",{className:"text-center"},"Get instructions"," ",j.a.createElement(k.a,{to:"/forgot-password?email=".concat(c),className:"text-blue-600 hover:text-blue-800"},"again")," ",j.a.createElement("br",null),"OR",j.a.createElement("br",null),j.a.createElement(k.a,{to:"/login",className:"text-blue-600 hover:text-blue-800"},"Login")," ","if you remember your password!")))}),Ke=a(148);function We(e){return Je({items:[],byId:{},meta:{from:0,to:0,total:0,current_page:1,last_page:1},links:{}}).insert(e)}function Je(e){var t=e||We();return{insert:function(e,a){return e?e.reduce(function(e,t){var n=e.byId,r=e.items,c=e.meta;return n[t.id]||(r=r.concat(t.id)),n[t.id]=t,Object(M.a)({},e,{byId:Object(M.a)({},n),items:Object(Ke.a)(r),meta:Object(M.a)({},c,a||{})})},t):t},get:function(){return t.items.map(function(e){return t.byId[e]})},getItem:function(e){if(e)return t.byId[e]},getMeta:function(){return t.meta},get total(){return this.getMeta().total||0},get currentPage(){return this.getMeta().current_page||1},get lastPage(){return this.getMeta().last_page||1},get from(){return this.getMeta().from||0},get to(){return this.getMeta().to||0},get meta(){return{total:this.total,lastPage:this.lastPage,currentPage:this.currentPage,from:this.from,to:this.to}}}}function ze(e,t){return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,n=arguments.length>1?arguments[1]:void 0;if(t.list)switch(n.type){case Object(Y.getType)(t.list.request):return Object(M.a)({},a,{isFetching:!0});case Object(Y.getType)(t.list.success):return Object(M.a)({},a,{state:Je(We()).insert(n.payload.data,n.payload.meta),isFetching:!1});case Object(Y.getType)(t.list.failure):return Object(M.a)({},a,{isFetching:!1})}if(t.item)switch(n.type){case Object(Y.getType)(t.item.request):return Object(M.a)({},a,{isFetching:!0});case Object(Y.getType)(t.item.success):return Object(M.a)({},a,{state:Je(a.state).insert([n.payload]),isFetching:!1});case Object(Y.getType)(t.item.failure):return Object(M.a)({},a,{isFetching:!1})}return a}}var $e="USER_LIST_STATE",Xe={isFetching:!0,state:We()},Ze={list:Object(Y.createAsyncAction)("@USERS/LIST_FETCH_REQUEST","@USERS/LIST_FETCH_SUCCESS","@USERS/LIST_FETCH_FAILED")(),item:Object(Y.createAsyncAction)("@USERS/ITEM_FETCH_REQUEST","@USERS/ITEM_FETCH_SUCCESS","@USERS/ITEM_FETCH_FAILED")()},et=ze(Xe,Ze);function tt(e){var t=e[$e];return Object(M.a)({},Je(t.state),{get state(){return e[$e]},get isFetching(){return this.state.isFetching}})}a(314);var at=function(){return j.a.createElement("span",{className:"spin"},j.a.createElement(P.h.SpinnerIcon,null))};function nt(e){return{getUser:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/users/".concat(a)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var rt=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Ze.item.request()),t.abrupt("return",nt(c).getUser(e).then(function(e){return a(Ze.item.success(e)),e}).catch(function(e){return a(Ze.item.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function ct(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(e){return Object(w.c)(function(t){var a=tt(t);return{isFetching:a.isFetching,user:a.getItem(e)}})}(e),n=function(){var e=J();return Object(y.useCallback)(function(t){return e(rt(t))},[e])}();return Object(y.useEffect)(function(){t&&e&&n(e)},[t,e,n]),Object(M.a)({},a,{fetchUser:n})}function lt(e){var t=e.navigate,a=e.userId,n=ct(a,!0),r=n.user,c=n.isFetching;return a?j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,r?r.name:""," | User")),j.a.createElement(k.a,{to:".."},"Back to list"),c?j.a.createElement("div",{className:"text-center"},j.a.createElement(at,null)):r?j.a.createElement("div",null,j.a.createElement("h3",null,r.name," ",j.a.createElement(k.a,{to:"edit",title:"Edit Name"},"\u270e")),j.a.createElement("p",null,"Roles:"," ",(r.roles||[]).map(function(e,t,a){return j.a.createElement("span",{key:e.id},e.name,t!==a.length-1?" \u2022 ":"")}),j.a.createElement(k.a,{to:"edit-roles",title:"Edit Roles"},"\u270e")),"Email Verified on:"," ",r.email_verified_at?ye.a.utc(r.email_verified_at).local().format("Do MMM, YYYY \\at hh:mm A"):"Not verified yet",j.a.createElement("br",null),"Invited on:"," ",ye.a.utc(r.created_at).local().format("Do MMM, YYYY \\at hh:mm A")):j.a.createElement(k.d,{noThrow:!0,to:"/users"})):(t&&t("/users"),null)}var it=a(19);function ut(e){var t=e.isFetching,a=e.total,n=e.items,r=e.render,c=e.children;return j.a.createElement(y.Fragment,null,t?j.a.createElement("div",{className:"text-center"},j.a.createElement(at,null)):0===a?j.a.createElement("div",{className:"text-center"},"No item in the list"):c||(r?r(n):null))}var ot=ut;function st(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(y.useState)(e),a=Object(_e.a)(t,2);return[a[0],a[1]]}var mt={q:""};function dt(e){var t=e.initialParams,a=void 0===t?mt:t,n=e.onSearch;return j.a.createElement(I.e,{initialValues:a,onSubmit:function(e){return n(e)},render:function(){return j.a.createElement(I.d,{noValidate:!0,style:{marginBottom:"1em"}},j.a.createElement(P.i,null,j.a.createElement(ie,{name:"q",noGroup:!0,placeholder:"Search...",type:"search"}),j.a.createElement(P.d,{type:"submit"},j.a.createElement(P.h.SearchIcon,null))))}})}var ft=dt,Et=a(14);function pt(e){return{getUsers:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/users",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var ht=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Ze.list.request()),t.abrupt("return",pt(c).getUsers(e).then(function(e){var t=e.data,n=e.meta;return a(Ze.list.success({data:t,meta:n})),t}).catch(function(e){return a(Ze.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function bt(){var e=J();return Object(y.useCallback)(function(t){return e(ht(t))},[e])}function gt(){return Object(M.a)({},Object(w.c)(function(e){var t=tt(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,users:t.get()})}),{fetchUsers:bt()})}function vt(e){Object(it.a)(e);var t=st(),a=Object(_e.a)(t,2),n=a[0],r=a[1],c=gt(),l=c.fetchUsers,i=c.users,u=c.total,o=c.from,s=c.to,m=c.currentPage,d=c.lastPage,f=c.isFetching;return Object(y.useEffect)(function(){l({page:m})},[l]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Users")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(dt,{onSearch:function(e){r(e),l(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:u,from:o,to:s,isFetching:f,currentPage:m,lastPage:d,onChange:function(e){return l(Object(M.a)({},n,{page:e}))}}))),j.a.createElement(ut,{isFetching:f,total:u},j.a.createElement(P.l,{striped:!0,bordered:!0,responsive:!0,headers:["Name","Email","Roles","Email Verified At"],rows:i.map(function(e){return[j.a.createElement(k.a,{to:e.id.toString()},e.name),j.a.createElement("span",null,e.email),j.a.createElement("span",null,e.roles.map(function(e){return e.name}).join(" \u2022 ")),j.a.createElement("span",null,e.email_verified_at?ye.a.utc(e.email_verified_at).local().format("Do MMM, YYYY \\at hh:mm A"):"Not Verified Yet")]})})))}var _t=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return pt(t).getUsers({q:e}).then(function(e){return e.data})}}))}),St=D.object().shape({name:D.string().required("Name is required").min(4,"Minimum 4 characters required").max(199,"Maximum 199 characters allowed"),email:D.string().email("Email must be a valid email address").required("Email field is required"),password:D.string().required("Password is required").min(8,"Password must be of a length greater than 8"),password_confirmation:D.string().required("Password confirmation is required").min(8,"Password must be of a length greater than 8")}),yt={name:"",email:"",password:"",password_confirmation:"",email_verified_link:""};var jt=xe(function(e){var t=e.xhr,a=e.navigate,n=e.location;return yt.email_verified_link=n?"".concat(n.origin,"/email-verified"):"",j.a.createElement("div",null,j.a.createElement(I.e,{initialValues:yt,validationSchema:St,onSubmit:function(e,n){n.setStatus(),t.post("/users",e).then(function(e){var t=e.data.data;a&&a("../".concat(t.id)),n.setSubmitting(!1)}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status,n=e.values;return j.a.createElement(I.d,{noValidate:!0},a?j.a.createElement("div",null,a):null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Invite New User"),j.a.createElement(ie,{label:"Name",name:"name",required:!0,placeholder:"John Tourepedia",autoComplete:"name"}),j.a.createElement(ie,{label:"Email",type:"email",name:"email",autoComplete:"username",placeholder:"username@tourepedia.com",required:!0}),j.a.createElement(ie,{label:"Password",type:"password",name:"password",autoComplete:"new-password",required:!0}),j.a.createElement(ie,{label:"Retype Password",type:"password",name:"password_confirmation",autoComplete:"new-password",required:!0}),j.a.createElement("input",{hidden:!0,type:"hidden",name:"email_verified_link",value:n.email_verified_link}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Submit"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))}),Ot=D.object().shape({name:D.string().required("Name is required").min(4,"Minimum 4 characters required").max(199,"Maximum 199 characters allowed")});var Tt=xe(function(e){var t=e.xhr,a=e.navigate,n=e.userId,r=ct(n,!0),c=r.user,l=r.isFetching;if(!n)return a&&a("/users"),null;if(l)return j.a.createElement("div",{className:"text-center"},j.a.createElement(at,null));if(!c)return a&&a("/users"),null;var i={name:c.name};return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Edit User")),j.a.createElement(I.e,{initialValues:i,validationSchema:Ot,onSubmit:function(e,r){r.setStatus(),t.patch("/users/".concat(n),e).then(function(e){var t=e.data.data;a&&a("../../".concat(t.id)),r.setSubmitting(!1)}).catch(function(e){r.setStatus(e.message),e.formikErrors&&r.setErrors(e.formikErrors),r.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Edit User Details"),a?j.a.createElement("div",null,a):null,j.a.createElement(ie,{label:"Name",name:"name",placeholder:"Manager",required:!0}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Submit"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))}),wt="ROLE_LIST_STATE",Ct={isFetching:!0,state:We()},xt={list:Object(Y.createAsyncAction)("@ROLES/LIST_FETCH_REQUEST","@ROLES/LIST_FETCH_SUCCESS","@ROLES/LIST_FETCH_FAILED")(),item:Object(Y.createAsyncAction)("@ROLES/ITEM_FETCH_REQUEST","@ROLES/ITEM_FETCH_SUCCESS","@ROLES/ITEM_FETCH_FAILED")()},Nt=ze(Ct,xt);function kt(e){var t=e[wt];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function Pt(e){return{getRole:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/roles/".concat(a)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Ft=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(xt.item.request()),t.abrupt("return",Pt(c).getRole(e).then(function(e){return a(xt.item.success(e)),e}).catch(function(e){return a(xt.item.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function qt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(e){return Object(w.c)(function(t){var a=kt(t);return{isFetching:a.isFetching,role:a.getItem(e)}})}(e),n=function(){var e=J();return Object(y.useCallback)(function(t){return e(Ft(t))},[e])}();return Object(y.useEffect)(function(){t&&e&&n(e)},[t,e]),Object(M.a)({},a,{fetchRole:n})}function At(e){var t=e.roleId,a=e.navigate,n=qt(t,!0),r=n.role,c=n.isFetching;return t?j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,r?r.name:""," Role")),j.a.createElement(k.a,{to:".."},"Back to list"),c?j.a.createElement("div",{className:"text-center"},j.a.createElement(at,null)):r?j.a.createElement("div",null,j.a.createElement("h3",null,r.name," ",j.a.createElement(k.a,{to:"edit",title:"Edit Role"},"\u270e")),"Created at:"," ",ye.a.utc(r.created_at).local().format("Do MMM YYYY \\at hh:mm A"),j.a.createElement("br",null),j.a.createElement("p",null,j.a.createElement("b",null,"Permissions"),":"," ",(r.permissions||[]).map(function(e,t,a){return j.a.createElement("span",{key:e.id},e.name,t!==a.length-1?" \u2022 ":"")})," ",j.a.createElement(k.a,{to:"edit-permissions",title:"Edit Permissions"},"\u270e"))):j.a.createElement(k.d,{noThrow:!0,to:"/users"})):(a&&a("/roles"),null)}function It(e){return{getRoles:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/roles",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getPermissions:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/permissions",{params:a}).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Dt=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(xt.list.request()),t.abrupt("return",It(c).getRoles(e).then(function(e){return a(xt.list.success(e)),e.data}).catch(function(e){return a(xt.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Mt(){var e=J();return Object(y.useCallback)(function(t){return e(Dt(t))},[e])}function Yt(){return Object(M.a)({},Object(w.c)(function(e){var t=kt(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,roles:t.get()})}),{fetchRoles:Mt()})}function Rt(e){Object(it.a)(e);var t=Yt(),a=t.roles,n=t.total,r=t.from,c=t.to,l=t.isFetching,i=t.currentPage,u=t.lastPage,o=t.fetchRoles,s=st(),m=Object(_e.a)(s,2),d=m[0],f=m[1];return Object(y.useEffect)(function(){o({page:i})},[o]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Roles")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ft,{onSearch:function(e){f(e),o(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:n,from:r,to:c,currentPage:i,lastPage:u,isFetching:l,onChange:function(e){return o(Object(M.a)({},d,{page:e}))}}))),j.a.createElement(ot,{total:n,isFetching:l},j.a.createElement(P.l,{headers:["Name","Permissions"],striped:!0,bordered:!0,rows:a.map(function(e){return[j.a.createElement(k.a,{to:e.id.toString()},e.name),(e.permissions||[]).map(function(e){return e.name}).join(" \u2022\xa0")]})})))}var Ht=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0,fetch:function(e){return It(t).getRoles({q:e}).then(function(e){return e.data})}},a))}),Lt=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0,fetch:function(e){return It(t).getPermissions({q:e})}},a))}),Ut=D.object().shape({name:D.string().required("Name is required").min(4,"Minimum 4 characters required").max(199,"Maximum 199 characters allowed")}),Vt={name:""};var Bt=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement("div",null,j.a.createElement(I.e,{initialValues:Vt,validationSchema:Ut,onSubmit:function(e,n){return n.setStatus(),t.post("/roles",e).then(function(e){var t=e.data.data;a&&a("../".concat(t.id)),n.setSubmitting(!1)}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status;return j.a.createElement(I.d,{noValidate:!0},a?j.a.createElement("div",null,a):null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Add New Role"),j.a.createElement(ie,{label:"Name",name:"name",required:!0,placeholder:"Manager"}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Submit"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))}),Qt=D.object().shape({name:D.string().required("Name is required").min(4,"Minimum 4 characters required").max(199,"Maximum 199 characters allowed")});var Gt=xe(function(e){var t=e.xhr,a=e.navigate,n=e.roleId,r=qt(n,!0),c=r.role,l=r.isFetching;if(!n)return a&&a("/roles"),null;if(l)return j.a.createElement("div",{className:"text-center"},j.a.createElement(at,null));if(!c)return null;var i=c.id,u=c.name,o={name:u};return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Editing ",u," Role")),j.a.createElement(I.e,{initialValues:o,validationSchema:Qt,onSubmit:function(e,n){n.setStatus(),t.put("/roles/".concat(i),e).then(function(e){var t=e.data.data;a&&a("../../".concat(t.id)),n.setSubmitting(!1)}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status;return j.a.createElement(I.d,{noValidate:!0},a?j.a.createElement("div",null,a):null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Edit Role"),j.a.createElement(ie,{label:"Name",name:"name",placeholder:"Manager",required:!0}),j.a.createElement(P.d,{type:"submit",disabled:t},"Save")),j.a.createElement(k.a,{to:".."},"Cancel"))}}))});var Kt=xe(function(e){var t=e.xhr,a=e.navigate,n=e.roleId,r=qt(n,!0),c=r.role,l=r.isFetching;if(!n)return a&&a("/roles"),null;if(l)return j.a.createElement("div",{className:"text-center"},j.a.createElement(at,null));if(!c)return a&&a("/roles"),null;var i=c.name,u=c.permissions,o={permissions:void 0===u?[]:u};return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Edit ",i,"'s permissions")),j.a.createElement(I.e,{initialValues:o,onSubmit:function(e,r){r.setStatus(),t.post("/roles/".concat(n,"/permissions"),{permissions:e.permissions.map(function(e){return{name:e.name}})}).then(function(e){a&&a("../../".concat(c.id)),r.setSubmitting(!1)}).catch(function(e){r.setStatus(e.message),e.formikErrors&&r.setErrors(e.formikErrors),r.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status,n=(e.values,e.setFieldValue);return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Editing ",i,"'s permissions"),a?j.a.createElement("div",null,a):null,j.a.createElement(le,{name:"permissions",render:function(e){var t=e.field;return j.a.createElement(Lt,Object.assign({},t,{label:"Select permission(s)",onChange:function(e,t){return n(t,e)}}))}}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))});function Wt(e){return j.a.createElement(te,null,j.a.createElement(k.a,{to:"new",className:"btn float-right"},"New Role"),j.a.createElement("h2",null,"Roles"),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(At,{path:":roleId"}),j.a.createElement(Gt,{path:":roleId/edit"}),j.a.createElement(Kt,{path:":roleId/edit-permissions"}),j.a.createElement(Bt,{path:"/new"}),j.a.createElement(Rt,{path:"/"})))}var Jt=xe(function(e){var t=e.xhr,a=e.navigate,n=e.userId,r=ct(n,!0),c=r.user,l=r.isFetching;if(!n)return a&&a("/users"),null;if(l)return j.a.createElement("div",{className:"text-center"},j.a.createElement(at,null));if(!c)return a&&a("/users"),null;var i=c.name,u=c.roles,o={roles:void 0===u?[]:u};return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Edit ",i,"'s Roles")),j.a.createElement(I.e,{initialValues:o,onSubmit:function(e,r){r.setStatus(),t.post("/users/".concat(n,"/roles"),{roles:e.roles.map(function(e){return{name:e.name}})}).then(function(e){a&&a("../../".concat(c.id)),r.setSubmitting(!1)}).catch(function(e){r.setStatus(e.message),e.formikErrors&&r.setErrors(e.formikErrors),r.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.status,n=(e.values,e.setFieldValue);return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Editing ",i,"'s roles"),a?j.a.createElement("div",null,a):null,j.a.createElement(le,{name:"roles",render:function(e){var t=e.field;return j.a.createElement(Ht,Object.assign({},t,{label:"Select Role(s)",onChange:function(e,t){return n(t,e)}}))}}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))});function zt(e){return j.a.createElement(te,null,j.a.createElement(k.a,{to:"new",className:"btn float-right"},"New User"),j.a.createElement("h2",null,"Users"),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(lt,{path:":userId"}),j.a.createElement(Tt,{path:":userId/edit"}),j.a.createElement(Jt,{path:":userId/edit-roles"}),j.a.createElement(jt,{path:"/new"}),j.a.createElement(vt,{path:"/"})))}var $t="HOTEL_LIST_STATE",Xt={list:Object(Y.createAsyncAction)("@HOTELS/LIST_FETCH_REQUEST","@HOTELS/LIST_FETCH_SUCCESS","@HOTELS/LIST_FETCH_FAILED")(),item:Object(Y.createAsyncAction)("@HOTELS/ITEM_FETCH_REQUEST","@HOTELS/ITEM_FETCH_SUCCESS","@HOTELS/ITEM_FETCH_FAILED")()},Zt={list:Object(Y.createAsyncAction)("@HOTEL_PRICES/LIST_FETCH_REQUEST","@HOTEL_PRICES/LIST_FETCH_SUCCESS","@HOTEL_PRICES/LIST_FETCH_FAILED")()},ea={hotels:Xt,prices:Zt},ta={hotels:{isFetching:!0,state:We()},prices:{isFetching:!0,state:We()}},aa=Object(C.combineReducers)({hotels:ze(ta.hotels,ea.hotels),prices:ze(ta.prices,ea.prices)});function na(e){var t=e[$t],a=t.hotels,n=t.prices;return{hotels:Object(M.a)({},Je(a.state),{get state(){return a},get isFetching(){return this.state.isFetching}}),prices:Object(M.a)({},Je(n.state),{get state(){return n},get isFetching(){return this.state.isFetching}}),getHotelPrices:function(e){return Je(n.state).get().filter(function(t){return t.hotel_id===e})}}}function ra(e){return{getHotels:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/hotels",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var ca=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Xt.list.request()),t.abrupt("return",ra(c).getHotels(e).then(function(e){var t=e.data,n=e.meta;return a(Xt.list.success({data:t,meta:n})),t}).catch(function(e){return a(Xt.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function la(){var e=J();return Object(y.useCallback)(function(t){return e(ca(t))},[e])}function ia(){return Object(M.a)({},Object(w.c)(function(e){var t=na(e).hotels;return Object(M.a)({},t.meta,{isFetching:t.isFetching,hotels:t.get()})}),{fetchHotels:la()})}function ua(e){Object(it.a)(e);var t=ia(),a=t.hotels,n=t.total,r=t.from,c=t.to,l=t.lastPage,i=t.currentPage,u=t.isFetching,o=t.fetchHotels,s=st(),m=Object(_e.a)(s,2),d=m[0],f=m[1];return Object(y.useEffect)(function(){o({page:i})},[o]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Hotels List")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(dt,{onSearch:function(e){f(e),o(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:n,isFetching:u,currentPage:i,from:r,to:c,lastPage:l,onChange:function(e){return o(Object(M.a)({},d,{page:e}))}}))),j.a.createElement(ut,{isFetching:u,total:n},j.a.createElement(P.l,{responsive:!0,striped:!0,bordered:!0,headers:["Name","Meal Plans","Room Type","Child extra bed age"],rows:a.map(function(e){return[j.a.createElement(y.Fragment,null,j.a.createElement(k.a,{to:e.id.toString()},e.name),j.a.createElement("br",null),e.location.short_name," \u2022 ",e.stars," stars"),e.meal_plans.map(function(e){return e.name}).join(" \u2022 "),e.room_types.map(function(e){return e.name}).join(" \u2022 "),j.a.createElement(y.Fragment,null,e.extra_bed_child_age_start,"-",e.extra_bed_child_age_end,"yo")]})})))}var oa=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return ra(t).getHotels({q:e}).then(function(e){return e.data})}}))});function sa(e){return{getPrices:function(){var t=Object(A.a)(q.a.mark(function t(a,n){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/hotel-prices",{params:Object(M.a)({},n,{hotels:[a]})}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()}}var ma=function(e,t){return function(){var a=Object(A.a)(q.a.mark(function a(n,r,c){var l;return q.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l=c.xhr,n(Zt.list.request()),a.abrupt("return",sa(l).getPrices(e,t).then(function(e){return n(Zt.list.success(e)),e.data}).catch(function(e){return n(Zt.list.failure(e)),Promise.reject(e)}));case 3:case"end":return a.stop()}},a)}));return function(e,t,n){return a.apply(this,arguments)}}()};function da(e){var t=e.hotelId,a=st(),n=Object(_e.a)(a,2),r=n[0],c=n[1],l=parseInt(t||"",10),i=J(),u=Object(y.useCallback)(function(e,t){return i(ma(e,t))},[i,t]);Object(y.useEffect)(function(){l&&u(l,{page:E})},[l,u]);var o=function(e){return Object(w.c)(function(t){var a=na(t),n=parseInt(e.toString(),10);return Object(M.a)({},a.prices.meta,{isFetching:a.prices.isFetching,prices:a.getHotelPrices(n)})})}(l),s=o.prices,m=o.total,d=o.from,f=o.to,E=o.currentPage,p=o.lastPage,h=o.isFetching;return isNaN(l)?null:j.a.createElement(y.Fragment,null,j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ft,{initialParams:r,onSearch:function(e){c(e),u(l,Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:m,from:d,to:f,currentPage:E,lastPage:p,isFetching:h,onChange:function(e){return u(l,{page:e})}}))),j.a.createElement(ot,{isFetching:h,total:m},j.a.createElement(P.l,{responsive:!0,bordered:!0,striped:!0,headers:["Start Date","End Date","Meal Plan","Room Type","Base Price","Persons","A.W.E.B.","C.W.E.B.","C.Wo.E.B"],alignCols:{4:"right",5:"right",6:"right",7:"right",8:"right"},rows:s.map(function(e){var t=e.base_price,a=e.persons,n=e.start_date,r=e.end_date,c=e.adult_with_extra_bed_price,l=e.child_with_extra_bed_price,i=e.child_without_extra_bed_price,u=e.meal_plan,o=e.room_type;return[ye.a.utc(n).local().format("DD/MM/YYYY"),ye.a.utc(r).local().format("DD/MM/YYYY"),u.name,o.name,t,a,c,l,i]})})))}var fa="MEAL_PLANS_STATE",Ea={isFetching:!0,state:We()},pa={list:Object(Y.createAsyncAction)("@MEAL_PLANS/LIST_FETCH_REQUEST","@MEAL_PLANS/LIST_FETCH_SUCCESS","@MEAL_PLANS/LIST_FETCH_FAILED")()},ha=ze(Ea,pa);function ba(e){var t=e[fa];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function ga(e){return{getMealPlans:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/meal-plans",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var va=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(pa.list.request()),t.abrupt("return",ga(c).getMealPlans(e).then(function(e){var t=e.data,n=e.meta;return a(pa.list.success({data:t,meta:n})),t}).catch(function(e){return a(pa.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function _a(){var e=J();return Object(y.useCallback)(function(t){return e(va(t))},[e])}function Sa(){return Object(M.a)({},Object(w.c)(function(e){var t=ba(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,mealPlans:t.get()})}),{fetchMealPlans:_a()})}function ya(e){Object(it.a)(e);var t=Sa(),a=t.mealPlans,n=t.total,r=t.from,c=t.to,l=t.isFetching,i=t.currentPage,u=t.lastPage,o=t.fetchMealPlans,s=st(),m=Object(_e.a)(s,2),d=m[0],f=m[1];return Object(y.useEffect)(function(){o({page:i})},[o]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Meal Plans")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ft,{onSearch:function(e){f(e),o(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:n,from:r,to:c,currentPage:i,lastPage:u,isFetching:l,onChange:function(e){return o(Object(M.a)({},d,{page:e}))}}))),j.a.createElement(ot,{total:n,isFetching:l},j.a.createElement(P.l,{striped:!0,bordered:!0,headers:["Name","Description"],rows:a.map(function(e){return[e.name,e.description]})})))}var ja=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return ga(t).getMealPlans({q:e}).then(function(e){return e.data})}}))}),Oa=D.object().shape({name:D.string().required("Name field is required"),description:D.string().required("Description field is required")}),Ta={name:"",description:""};var wa=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"New Meal Plan")),j.a.createElement(I.e,{initialValues:Ta,validationSchema:Oa,onSubmit:function(e,n){return n.setStatus(),t.post("/meal-plans",e).then(function(e){e.data,a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status;return j.a.createElement(I.d,{noValidate:!0},a?j.a.createElement("div",null,a):null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Add New Meal Plan"),j.a.createElement(ie,{label:"Name",name:"name",placeholder:"MAP",required:!0}),j.a.createElement(ie,{label:"Description",name:"description",placeholder:"Modified American Plan (Two meals: Breakfast and one of Lunch or Dinner)",required:!0}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))});function Ca(e){return j.a.createElement(te,null,j.a.createElement(k.a,{to:"new",className:"float-right btn"},"New Meal Plan"),j.a.createElement("h2",null,"Meal Plans"),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(wa,{path:"/new"}),j.a.createElement(ya,{path:"/"})))}var xa="ROOM_TYPES_STATE",Na={isFetching:!0,state:We()},ka={list:Object(Y.createAsyncAction)("@ROOM_TYPES/LIST_FETCH_REQUEST","@ROOM_TYPES/LIST_FETCH_SUCCESS","@ROOM_TYPES/LIST_FETCH_FAILED")()},Pa=ze(Na,ka);function Fa(e){var t=e[xa];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function qa(e){return{getRoomTypes:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/room-types",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Aa=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(ka.list.request()),t.abrupt("return",qa(c).getRoomTypes(e).then(function(e){return a(ka.list.success(e)),e.data}).catch(function(e){return a(ka.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Ia(){var e=Object(w.c)(function(e){var t=Fa(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,roomTypes:t.get()})}),t=function(){var e=J();return Object(y.useCallback)(function(t){return e(Aa(t))},[e])}();return Object(M.a)({},e,{fetchRoomTypes:t})}function Da(e){var t=st(),a=Object(_e.a)(t,2),n=a[0],r=a[1],c=Ia(),l=c.fetchRoomTypes,i=c.roomTypes,u=c.total,o=c.from,s=c.to,m=c.currentPage,d=c.lastPage,f=c.isFetching;return Object(y.useEffect)(function(){l({page:m})},[l]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Room Types")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ft,{onSearch:function(e){r(e),l(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:u,from:o,to:s,isFetching:f,currentPage:m,lastPage:d,onChange:function(e){return l(Object(M.a)({},n,{page:e}))}}))),j.a.createElement(ot,{total:u,isFetching:f},j.a.createElement(P.l,{bordered:!0,striped:!0,headers:["Name","Description"],rows:i.map(function(e){return[e.name,e.description]})})))}var Ma=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return qa(t).getRoomTypes({q:e}).then(function(e){return e.data})}}))}),Ya=D.object().shape({name:D.string().required("Name field is required"),description:D.string().required("Description field is required")}),Ra={name:"",description:""};var Ha=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"New Room Type")),j.a.createElement(I.e,{initialValues:Ra,validationSchema:Ya,onSubmit:function(e,n){return n.setStatus(),t.post("/room-types",e).then(function(e){e.data,a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status;return j.a.createElement(I.d,{noValidate:!0},a?j.a.createElement("div",null,a):null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Add New Room Type"),j.a.createElement(ie,{label:"Name",name:"name",placeholder:"Delux",required:!0}),j.a.createElement(ie,{label:"Description",name:"description",placeholder:"Luxury room",required:!0}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))});function La(e){return j.a.createElement(te,null,j.a.createElement(k.a,{to:"new",className:"btn float-right"},"New Room Type"),j.a.createElement("h2",null,"Room Types"),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(Ha,{path:"/new"}),j.a.createElement(Da,{path:"/"})))}function Ua(e){return j.a.createElement(ie,Object.assign({type:"date",placeholder:"dd/mm/yyyy"},e))}var Va={prices:[{start_date:"",end_date:"",base_price:0,persons:2,adult_with_extra_bed_price:0,child_with_extra_bed_price:0,child_without_extra_bed_price:0,meal_plan:void 0,room_type:void 0}]},Ba=D.object().shape({prices:D.array().of(D.object().shape({start_date:D.string().required("Start date field is required"),end_date:D.string().required("End date field is required"),base_price:D.number().required("Base price field is required").positive("Price should be positive"),persons:D.number().required("Persons field is required").integer().positive("Persons should be positive number"),adult_with_extra_bed_price:D.number().required("Price for adult with extra bed is required").min(0,"Price should not be negative"),child_with_extra_bed_price:D.number().required("Price for child with extra bed is required").min(0,"Price should not be negative"),child_without_extra_bed_price:D.number().nullable(!0).min(0,"Price should not be negative").required("Price for child without extra bed is required"),meal_plan:D.object().required("Meal plan should be selected"),room_type:D.object().required("Room type should be selected")}))});var Qa=xe(function(e){var t=e.hotel,a=e.xhr,n=e.navigate;return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Add Prices")),j.a.createElement(I.e,{initialValues:Va,validationSchema:Ba,onSubmit:function(e,r){return r.setStatus(),a.post("/hotel-prices",{prices:e.prices.reduce(function(e,a){var n=a.meal_plan,r=a.room_type,c=a.start_date,l=a.end_date,i=Object(ne.a)(a,["meal_plan","room_type","start_date","end_date"]),u=[];return u.push(Object(M.a)({},i,{start_date:ye()(c).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),end_date:ye()(l).hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),hotel_id:t.id,meal_plan_id:n&&n.id,room_type_id:r&&r.id})),e.concat(u)},[])}).then(function(e){n&&n(".."),r.setSubmitting(!1)}).catch(function(e){r.setStatus(e.message),e.formikErrors&&r.setErrors(e.formikErrors),r.setSubmitting(!1)})},render:function(e){var a=e.isSubmitting,n=e.setFieldValue,r=e.values;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",{style:{minInlineSize:"auto"}},j.a.createElement("legend",null,"Add Hotel Price"),j.a.createElement(I.c,{name:"prices",render:function(e){var a=e.name,c=e.remove,l=e.push;return j.a.createElement("ol",{className:"list"},r.prices.map(function(e,i){return j.a.createElement("li",{key:i},j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(Ua,{label:"Start Date",name:"".concat(a,".").concat(i,".start_date")})),j.a.createElement(Le,null,j.a.createElement(Ua,{label:"End Date",name:"".concat(a,".").concat(i,".end_date")})),j.a.createElement(Le,null,j.a.createElement(le,{name:"prices.".concat(i,".meal_plan"),render:function(e){var a=e.field;return j.a.createElement(ja,Object.assign({label:"Meal Plan"},a,{searchable:!1,multiple:!1,options:t.meal_plans,onChange:function(e,t){return n(t,e)}}))}})),j.a.createElement(Le,null,j.a.createElement(le,{name:"prices.".concat(i,".room_type"),render:function(e){var a=e.field;return j.a.createElement(Ma,Object.assign({},a,{label:"Room Type",searchable:!1,multiple:!1,options:t.room_types,onChange:function(e,t){n(t,e),e&&e.allowed_extra_beds||(n("prices.".concat(i,".adult_with_extra_bed_price"),0),n("prices.".concat(i,".child_with_extra_bed_price"),0))}}))}}))),j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Prices"),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ie,{label:"Number of persons",name:"".concat(a,".").concat(i,".persons"),type:"number"})),j.a.createElement(Le,null,j.a.createElement(ie,{label:"Base Price",name:"".concat(a,".").concat(i,".base_price"),type:"number"})),j.a.createElement(Le,null,j.a.createElement(ie,{label:"Adult with extra bed price",name:"".concat(a,".").concat(i,".adult_with_extra_bed_price"),type:"number",title:e.room_type?e.room_type.allowed_extra_beds?void 0:"No extra bed allowed":"Please select a room type",disabled:!e.room_type||!e.room_type.allowed_extra_beds})),j.a.createElement(Le,null,j.a.createElement(ie,{label:"Child with extra bed price",name:"".concat(a,".").concat(i,".child_with_extra_bed_price"),type:"number",title:e.room_type?e.room_type.allowed_extra_beds?void 0:"No extra bed allowed":"Please select a room type",disabled:!e.room_type||!e.room_type.allowed_extra_beds})),j.a.createElement(Le,null,j.a.createElement(ie,{label:"Child without extra bed price",name:"".concat(a,".").concat(i,".child_without_extra_bed_price"),type:"number"})))),j.a.createElement("hr",null),j.a.createElement("div",{className:"button-group form-group"},j.a.createElement(P.d,{className:"btn--secondary",onClick:function(t){return l(e)}},"+ Duplicate"),r.prices.length>1?j.a.createElement(P.d,{className:"btn--secondary",onClick:function(e){return c(i)}},"\xd7 Remove"):null))}),j.a.createElement("div",{className:"form-group"},j.a.createElement("hr",null),j.a.createElement(P.d,{onClick:function(e){return l(Va.prices[0])}},"+ Add More")))}}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:a},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))}),Ga=a(28),Ka=(a(142),D.object().shape({name:D.string().required("Contact name is required"),email:D.string().email("Email should be a valid email address"),phone_number:D.number().positive("Phone number should be a positive integer").typeError("Invalid number")}).required("Contact data is required")),Wa={name:"",email:""};function Ja(e){var t=e.onCreate,a=e.onCancel;return j.a.createElement(I.e,{initialValues:Wa,validationSchema:Ka,onSubmit:function(e,n){n.setStatus(),t(e).then(function(){n.setSubmitting(!1),a()}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})},render:function(e){e.setFieldValue;var t=e.isSubmitting;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement(ie,{name:"name",label:"Name",required:!0,placeholder:"Johhny Dep"}),j.a.createElement(ie,{name:"email",label:"Email",type:"email",placeholder:"user@domain.com"}),j.a.createElement(ie,{name:"phone_number",label:"Phone Number",type:"number",placeholder:"9911929399"}),j.a.createElement("hr",null),j.a.createElement("footer",null,j.a.createElement(P.d,{disabled:t,primary:!0,type:"submit"},"Save")," ",j.a.createElement(P.d,{onClick:a},"Cancel")))}})}function za(e){return{getHotel:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/hotels/".concat(a)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),createContact:function(){var t=Object(A.a)(q.a.mark(function t(a,n){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/hotel-contacts",Object(M.a)({hotel_id:a},n)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()}}var $a=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Xt.item.request()),t.abrupt("return",za(c).getHotel(e).then(function(e){return a(Xt.item.success(e)),e}).catch(function(e){return a(Xt.item.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Xa(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(e){return Object(w.c)(function(t){var a=na(t).hotels;return{isFetching:a.isFetching,hotel:a.getItem(e)}})}(e),n=function(){var e=J();return Object(y.useCallback)(function(t){return e($a(t))},[e])}();return Object(y.useEffect)(function(){t&&e&&n(e)},[n,e,t]),Object(M.a)({},a,{fetchHotel:n})}var Za=xe(function(e){var t=e.hotelId,a=e.navigate,n=e.xhr,r=Object(Ga.c)(),c=Object(_e.a)(r,3),l=c[0],i=c[1],u=c[2],o=Xa(t,!0),s=o.hotel,m=o.isFetching,d=o.fetchHotel;if(!t)return a&&a("/hotels"),null;if(m)return j.a.createElement("div",{className:"text-center"},j.a.createElement(at,null));if(!s)return null;var f=s.name,E=s.stars,p=s.extra_bed_child_age_start,h=s.extra_bed_child_age_end,b=s.meal_plans,g=s.room_types,v=s.location,_=s.contacts,S=s.payment_preference;return j.a.createElement("div",null,j.a.createElement(k.a,{to:".."},"Back"),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement("h3",null,f," \u2022 ",v.short_name," \u2022 ",E," Star"),j.a.createElement("dl",null,j.a.createElement("dt",null,"Meal Plans:"),j.a.createElement("dd",null,b.map(function(e){return e.name}).join(" \u2022 ")),j.a.createElement("dt",null,"Room Types:"),j.a.createElement("dd",null,g.map(function(e){return"".concat(e.name,"(").concat(e.allowed_extra_beds," AEBs)")}).join(" \u2022 ")),j.a.createElement("dt",null,"Payment Preference"),j.a.createElement("dd",null,S?S.name:"NOT SET"),j.a.createElement("dt",null,"Extra bed child ages:"),j.a.createElement("dd",null,"From ",p," to ",h," ","years"))),j.a.createElement(Le,{sm:"auto",xs:12},j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Contacts"),j.a.createElement("ul",null,(_||[]).map(function(e){return j.a.createElement("li",{key:e.id},e.name," ",e.phone_number,"<",e.email,">")})),j.a.createElement(Ga.a,{open:l,onClose:u,closeButton:!0},j.a.createElement(Ga.a.Header,null,j.a.createElement(Ga.a.Title,null,"Add Contact")),j.a.createElement(Ga.a.Body,null,j.a.createElement(Ja,{onCancel:u,onCreate:function(){var e=Object(A.a)(q.a.mark(function e(a){var r,c,l,i;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.name,c=a.email,l=a.phone_number,i=a.country,e.abrupt("return",za(n).createContact(t,{name:r,email:c,phone_number:l,country_id:i?i.id:void 0}).then(function(e){return d(t),e}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}))),j.a.createElement(P.d,{onClick:i,"data-testid":"add_contact"},"Add Contact")))),j.a.createElement("hr",null),j.a.createElement("div",null,j.a.createElement("div",{className:"clearfix mb-4"},j.a.createElement(k.a,{to:"add-prices",className:"btn btn-primary float-right"},"Add Prices"),j.a.createElement("h4",null,"Prices")),j.a.createElement(k.e,null,j.a.createElement(Qa,{path:"add-prices",hotel:s}),j.a.createElement(da,{path:"/",hotel:s}))))}),en="LOCATIONS_STATE",tn={isFetching:!0,state:We()},an={list:Object(Y.createAsyncAction)("@LOCATIONS/LIST_FETCH_REQUEST","@LOCATIONS/LIST_FETCH_SUCCESS","@LOCATIONS/LIST_FETCH_FAILED")()},nn=ze(tn,an);function rn(e){var t=e[en];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function cn(e){return{getLocations:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/locations",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getCountries:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/locations/countries",{params:a}).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getStates:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/locations/states",{params:a}).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getCities:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/locations/cities",{params:a}).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var ln=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(an.list.request()),t.abrupt("return",cn(c).getLocations(e).then(function(e){return a(an.list.success(e)),e.data}).catch(function(e){return a(an.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function un(){var e=J();return Object(y.useCallback)(function(t){return e(ln(t))},[e])}function on(){return Object(M.a)({},Object(w.c)(function(e){var t=rn(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,locations:t.get()})}),{fetchLocations:un()})}function sn(e){var t=on(),a=t.locations,n=t.total,r=t.from,c=t.to,l=t.isFetching,i=t.currentPage,u=t.lastPage,o=t.fetchLocations,s=st(),m=Object(_e.a)(s,2),d=m[0],f=m[1];return Object(y.useEffect)(function(){o({page:i})},[o]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Locations")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ft,{onSearch:function(e){f(e),o(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:n,from:r,to:c,currentPage:i,lastPage:u,isFetching:l,onChange:function(e){return o(Object(M.a)({},d,{page:e}))}}))),j.a.createElement(ot,{total:n,isFetching:l},j.a.createElement(P.l,{striped:!0,bordered:!0,headers:["Name","Latitude","Longitude"],responsive:!0,rows:a.map(function(e){return[e.name,e.latitude,e.longitude]})})))}var mn=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return cn(t).getLocations({q:e}).then(function(e){return e.data})}}))}),dn=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return cn(t).getCountries({q:e})}}))}),fn=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return cn(t).getStates({q:e})}}))}),En=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return cn(t).getCities({q:e})}}))}),pn=D.object().shape({country:D.object().required("Country field is required"),latitue:D.string(),longitude:D.string()}),hn={city:void 0,state:void 0,country:void 0,latitude:"",longitude:""};var bn=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"New Location")),j.a.createElement(I.e,{initialValues:hn,validationSchema:pn,onSubmit:function(e,n){n.setStatus();var r=e.country,c=e.state,l=e.city,i=e.latitude,u=e.longitude;t.post("/locations",{country:r?r.id:void 0,state:c?c.name:void 0,city:l?l.name:void 0,latitude:i,longitude:u}).then(function(){a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status,n=(e.values,e.setFieldValue);return j.a.createElement(I.d,{noValidate:!0},a?j.a.createElement("div",null,a):null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Add New Location"),j.a.createElement(le,{name:"country",render:function(e){var t=e.field;return j.a.createElement(dn,Object.assign({},t,{multiple:!1,label:"Country",placeholder:"Type to search.. (e.g. India)",onChange:function(e,t){n(t,e)}}))}}),j.a.createElement(le,{name:"state",render:function(e){var t=e.field;return j.a.createElement(fn,Object.assign({},t,{multiple:!1,label:"State",onChange:function(e,t){return n(t,e)},placeholder:"Type to search.. (e.g. Rajasthan)",creatable:!0}))}}),j.a.createElement(le,{name:"city",render:function(e){var t=e.field;return j.a.createElement(En,Object.assign({},t,{multiple:!1,label:"City",onChange:function(e,t){return n(t,e)},placeholder:"Type to search.. (e.g. Jaipur)",creatable:!0}))}}),j.a.createElement(ie,{name:"latitude",label:"Latitude",placeholder:"27\xb0 2' 9.6252'' N"}),j.a.createElement(ie,{name:"longitude",label:"Longitude",placeholder:"88\xb0 15' 45.6192'' E"}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))});function gn(e){return j.a.createElement(te,null,j.a.createElement(k.a,{to:"new",className:"float-right btn"},"New Location"),j.a.createElement("h2",null,"Locations"),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(bn,{path:"/new"}),j.a.createElement(sn,{path:"/"})))}var vn="HOTEL_PAYMENT_PREFERENCES_STATE",_n={isFetching:!0,state:We()},Sn={list:Object(Y.createAsyncAction)("@HOTEL_PAYMENT_PREFERENCES/LIST_FETCH_REQUEST","@HOTEL_PAYMENT_PREFERENCES/LIST_FETCH_SUCCESS","@HOTEL_PAYMENT_PREFERENCES/LIST_FETCH_FAILED")()},yn=ze(_n,Sn);function jn(e){var t=e[vn];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function On(e){return{getHotelPaymentPreferences:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/hotel-payment-preferences",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getHotelPaymentReferences:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/hotel-payment-preferences/references",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Tn=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Sn.list.request()),t.abrupt("return",On(c).getHotelPaymentPreferences(e).then(function(e){return a(Sn.list.success(e)),e.data}).catch(function(e){return a(Sn.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function wn(){var e=J();return Object(y.useCallback)(function(t){return e(Tn(t))},[e])}function Cn(){return Object(M.a)({},Object(w.c)(function(e){var t=jn(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,hotelPaymentPreferences:t.get()})}),{fetchHotelPaymentPreferences:wn()})}function xn(e){var t=st(),a=Object(_e.a)(t,2),n=a[0],r=a[1],c=Cn(),l=c.hotelPaymentPreferences,i=c.fetchHotelPaymentPreferences,u=c.total,o=c.from,s=c.to,m=c.isFetching,d=c.currentPage,f=c.lastPage;return Object(y.useEffect)(function(){i({page:d})},[i]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Hotel Payment Preferences List")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ft,{onSearch:function(e){r(e),i(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:u,from:o,to:s,currentPage:d,lastPage:f,isFetching:m,onChange:function(e){return i(Object(M.a)({},n,{page:e}))}}))),j.a.createElement(ot,{total:u,isFetching:m},j.a.createElement(P.l,{headers:["Description"],bordered:!0,striped:!0,rows:l.map(function(e){return[e.name]})})))}var Nn=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return On(t).getHotelPaymentPreferences({q:e}).then(function(e){return e.data})}}))}),kn=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return On(t).getHotelPaymentReferences({q:e}).then(function(e){return e.data})}}))}),Pn=D.object().shape({breakdowns:D.array().of(D.object().shape({reference:D.object().required("Reference field is required"),day_offset:D.number().integer().required("Day offset field is required"),amount_share:D.number().integer().positive("Amount share should be positive integer").max(100,"Amount share can not be greater then 100").required("Amount share field is required")})).min(1,"Atleast on breakdown is required.")}),Fn={breakdowns:[{reference:void 0,day_offset:0,amount_share:100}]};var qn=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"New Trip Stage")),j.a.createElement(I.e,{initialValues:Fn,validationSchema:Pn,onSubmit:function(e,n){n.setStatus();var r=e.breakdowns.reduce(function(e,t){return e+t.amount_share},0);return 100!==r?(n.setStatus("Total amount share(".concat(r,") should be 100%")),void n.setSubmitting(!1)):t.post("/hotel-payment-preferences",{breakdowns:e.breakdowns.map(function(e){return Object(M.a)({},e,{reference:e.reference?e.reference.id:null})})}).then(function(e){e.data,a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status,n=e.values,r=e.setFieldValue;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Add new Hotel Payment Preferences"),j.a.createElement(I.c,{name:"breakdowns",render:function(e){var t=e.name,a=e.push,c=e.remove;return j.a.createElement("ul",{className:"list"},n.breakdowns.map(function(e,a,n){return j.a.createElement(He,{as:"li",key:a},j.a.createElement(Le,{md:3},j.a.createElement(le,{name:"".concat(t,".").concat(a,".reference"),render:function(e){var t=e.field;return j.a.createElement(kn,Object.assign({},t,{label:"Reference Event",required:!0,fetchOnMount:!0,multiple:!1,onChange:function(e,t){return r(t,e)}}))}})),j.a.createElement(Le,{md:3},j.a.createElement(ie,{label:"Day offset from reference",name:"".concat(t,".").concat(a,".day_offset"),required:!0,type:"number"})),j.a.createElement(Le,{md:3},j.a.createElement(ie,{label:j.a.createElement("span",{className:"whitespace-pre"},"Amount share from total amount"),name:"".concat(t,".").concat(a,".amount_share"),required:!0,type:"number",min:1,max:100})),j.a.createElement(Le,{md:3,className:"d-flex align-items-center"},n.length>1?j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){return c(a)}},"\xd7 Remove"):null))}),j.a.createElement("li",{key:"add_more"},j.a.createElement(P.d,{onClick:function(){return a({amount_share:100-n.breakdowns[0].amount_share})}},"+ Add More")))}}),a?j.a.createElement("div",{className:"text--error"},a):null,j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))});function An(e){return j.a.createElement(te,null,j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement("h2",{className:"white-space-pre"},"Hotel Payment Preferences")),j.a.createElement(Le,{className:"d-flex align-items-center justify-content-end"},j.a.createElement(k.a,{to:"new",className:"btn"},"New Hotel Payment Preference"))),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(qn,{path:"/new"}),j.a.createElement(xn,{path:"/"})))}var In=D.object().shape({name:D.string().required("Name field is required"),stars:D.number().positive("Star rating field should a positive integer.").integer("Star rating field should be positive integer").required("Stars rating field is required"),extra_bed_child_age_start:D.number().positive("Child start age should be a positive number").integer("Child start age should be an integer").required("Child start age is required"),extra_bed_child_age_end:D.number().positive("Child end age should be a positive number").integer("Child end age should be an integer").required("Child end age is required"),meal_plans:D.array().min(1,"Please select atleast one meal plan"),room_types:D.array().of(D.object().shape({room_types:D.array().min(1,"Please select atleast one room type").required("Please select a room type"),allowed_extra_beds:D.number().typeError("Allowed extra bed must be a number").integer("Allowed extra beds should be an integer").min(0,"Allowed extra beds should not be negative").required("Allowed extra beds field is required")})).min(1,"Please select atleast one room type"),location:D.object().required("Location field is required")}),Dn={name:"",stars:1,extra_bed_child_age_start:6,extra_bed_child_age_end:12,meal_plans:[],room_types:[{room_types:[],allowed_extra_beds:1}],location:void 0};var Mn=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"New Hotel")),j.a.createElement(I.e,{initialValues:Dn,validationSchema:In,onSubmit:function(e,n){n.setStatus(),t.post("/hotels",Object(M.a)({},e,{meal_plans:e.meal_plans.map(function(e){return e.id}),room_types:e.room_types.reduce(function(e,t){var a=t.room_types,n=t.allowed_extra_beds;return e.concat(a.map(function(e){return{room_type_id:e.id,allowed_extra_beds:n}}))},[]),location_id:e.location?e.location.id:void 0,payment_preference_id:e.payment_preference?e.payment_preference.id:void 0})).then(function(e){var t=e.data.data;a&&a("../".concat(t.id)),n.setSubmitting(!1)}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,a=e.setFieldValue,n=e.values,r=e.status;return j.a.createElement(I.d,{noValidate:!0},r?j.a.createElement("div",null,r):null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Add Hotel"),j.a.createElement(He,null,j.a.createElement(Le,{lg:!0,md:4,sm:6,xs:12},j.a.createElement(ie,{label:"Name",name:"name",placeholder:"Taj Hotel",required:!0})),j.a.createElement(Le,{lg:!0,md:4,sm:6,xs:12},j.a.createElement(le,{name:"location",render:function(e){var t=e.field;return j.a.createElement(mn,Object.assign({},t,{label:"Location",multiple:!1,onChange:function(e,t){return a(t,e)}}))}})),j.a.createElement(Le,{lg:!0,md:4,sm:6},j.a.createElement(le,{name:"payment_preference",render:function(e){var t=e.field;return j.a.createElement(Nn,Object.assign({},t,{label:"Payment Preference",multiple:!1,onChange:function(e,t){return a(t,e)},fetchOnMount:!0}))}})),j.a.createElement(Le,{lg:!0,md:4,sm:4,xs:8},j.a.createElement(le,{name:"meal_plans",render:function(e){var t=e.field;return j.a.createElement(ja,Object.assign({},t,{label:"Meal Plan(s) served",onChange:function(e,t){return a(t,e)},fetchOnMount:!0}))}})),j.a.createElement(Le,{lg:1,md:4,sm:2,xs:4},j.a.createElement(ie,{label:"Stars",name:"stars",type:"number",required:!0,max:5,min:1}))),j.a.createElement(I.c,{name:"room_types",render:function(e){var t=e.name,r=e.push,c=e.remove;return j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Room Type(s) Available"),j.a.createElement("ul",{className:"list"},n.room_types.map(function(e,n,r){return j.a.createElement("li",{key:n},j.a.createElement(He,null,j.a.createElement(Le,{xs:"auto"},j.a.createElement(le,{name:"".concat(t,".").concat(n,".room_types"),render:function(e){var t=e.field;return j.a.createElement(Ma,Object.assign({},t,{label:"Room Types",fetchOnMount:!0,onChange:function(e,t){return a(t,e)}}))}})),j.a.createElement(Le,{xs:"auto"},j.a.createElement(ie,{label:"Allowed extra bed(s)",type:"number",name:"".concat(t,".").concat(n,".allowed_extra_beds"),value:e.allowed_extra_beds,min:0})),j.a.createElement(Le,{xs:"auto",className:"d-flex align-items-center"},r.length>1?j.a.createElement(P.d,{onClick:function(e){return c(n)},className:"btn--secondary"},"\xd7 Remove"):null)))}),j.a.createElement("li",null,j.a.createElement(P.d,{onClick:function(e){return r(n.room_types[0])}},"+ Add More Room Types"))))}}),j.a.createElement(He,null,j.a.createElement(Le,{sm:"auto"},j.a.createElement(ie,{label:"Extra bed child start age",name:"extra_bed_child_age_start",required:!0,type:"number",min:1})),j.a.createElement(Le,{sm:"auto"},j.a.createElement(ie,{label:"Extra bed child end age",name:"extra_bed_child_age_end",required:!0,type:"number",min:1}))),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))});var Yn=D.object().shape({hotels:D.array().of(D.object().shape({start_date:D.string().required("Start Date field is required."),no_of_nights:D.number().required("Number of nights field is required").integer("Number of nights should be an integer").positive("Number of nights should be a positive number"),hotel:D.object().required("Hotel field is required"),meal_plan:D.object().required("Meal Plan field is required"),room_details:D.array().of(D.object().shape({room_type:D.object().required("Room type field is required"),adults_with_extra_bed:D.number().integer("Adult with extra bed should be an interger").required("Adult with extra bed is required"),children_with_extra_bed:D.number().integer("Child with extra bed should be an integer").required("Child with extra bed is required"),children_without_extra_bed:D.number().integer("Child without extra bed should be an integer").required("Child without extra bed is required"),no_of_rooms:D.number().positive("Number of rooms should be a positive number").integer("Number of room should be an integer").required("Number of rooms is required")})).min(1)}))}),Rn={hotels:[{start_date:"",no_of_nights:1,hotel:void 0,meal_plan:void 0,room_details:[{room_type:void 0,adults_with_extra_bed:0,children_with_extra_bed:0,children_without_extra_bed:0,no_of_rooms:1}],calculated_price:void 0,given_price:0,comments:""}]},Hn=xe(function(e){var t=e.initialValues,a=void 0===t?Rn:t,n=e.xhr,r=e.onChange,c=e.bookingFrom,l=e.bookingTo;function i(e){r&&r(e.hotels.reduce(function(e,t){return e+parseFloat((t.given_price?t.given_price:0).toString())},0),e.hotels.map(function(e){var t=e.start_date,a=e.no_of_nights,n=e.room_details,r=e.hotel,c=e.meal_plan,l=Object(ne.a)(e,["start_date","no_of_nights","room_details","hotel","meal_plan"]),i=n&&n.length>0?n[0]:{room_type:void 0},u=i.room_type,o=Object(ne.a)(i,["room_type"]);return Object(M.a)({},l,{checkin:ye()(t).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),checkout:ye()(t).add(a-1,"days").hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),hotel_id:r&&r.id,meal_plan_id:c&&c.id},o,{room_type_id:u&&u.id})}))}Object(P.n)(function(){i(a)});var u=Object(y.useMemo)(function(){for(var e=[],t=ye()(l).diff(ye()(c),"days"),a=0;a<=t;a++)e.push({id:a,name:ye()(c).add(a,"day").format("YYYY-MM-DD")});return e},[c,l]);return j.a.createElement(I.e,{initialValues:a,validationSchema:Yn,onSubmit:function(e,t){t.setStatus();var a=[],r={hotels:[]};e.hotels.forEach(function(e){var t=e.start_date,n=e.no_of_nights,c=e.hotel,l=e.meal_plan,i=e.room_details;c&&t&&n&&l&&i&&i.length>0&&i.forEach(function(i){if(i.room_type){var u=i.room_type,o=i.adults_with_extra_bed,s=i.children_with_extra_bed,m=i.children_without_extra_bed,d=i.no_of_rooms;r.hotels.push(Object(M.a)({},e,{start_date:ye()(t).format("YYYY-MM-DD"),no_of_nights:n,room_details:[i]})),a.push({checkin:ye()(t).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),checkout:ye()(t).add(n-1,"days").hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),hotel_id:c.id,meal_plan_id:l.id,room_type_id:u.id,adults_with_extra_bed:o,children_with_extra_bed:s,children_without_extra_bed:m,no_of_rooms:d})}})}),function(e){return{getPrice:function(t){return e.get("/prices",{params:{hotels:t}}).then(function(e){return e.data})}}}(n).getPrice(a).then(function(e){r.hotels=r.hotels.map(function(t,a){return Object(M.a)({},t,{calculated_price:e.hotels[a].price,given_price:e.hotels[a].price,no_price_for_dates:e.hotels[a].no_price_for_dates})}),t.setValues(r),t.setSubmitting(!1),i(r)}).catch(function(e){t.setStatus(e.message),e.formikErrors&&t.setErrors(e.formikErrors),t.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,n=e.values,r=e.setFieldValue;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement(I.c,{name:"hotels",render:function(e){var o=e.name,s=e.push,m=e.remove;return j.a.createElement("div",null,n.hotels.map(function(e,d){return j.a.createElement("fieldset",{key:d},j.a.createElement(He,null,j.a.createElement(Le,{md:3,sm:6},c&&l?j.a.createElement(le,{name:"".concat(o,".").concat(d,".start_date"),render:function(t){var a=t.field;return j.a.createElement(P.k,Object.assign({},a,{label:"Checkin Date",options:u,searchable:!1,placeholder:"Select a date...",required:!0,onQuery:function(){},value:u.find(function(t){return t.name===e.start_date}),onChange:function(e,t){r(t,e.name)}}))}}):j.a.createElement(Ua,{label:"Checkin Date",name:"".concat(o,".").concat(d,".start_date"),required:!0})),j.a.createElement(Le,{md:3,sm:6},j.a.createElement(ie,{label:"Number of nights",name:"".concat(o,".").concat(d,".no_of_nights"),type:"number",min:1,max:1e3})),j.a.createElement(Le,{md:3,sm:6},j.a.createElement(le,{name:"".concat(o,".").concat(d,".hotel"),render:function(e){var t=e.field;return j.a.createElement(oa,Object.assign({},t,{label:"Hotel",multiple:!1,onChange:function(e,t){return r(t,e)}}))}})),j.a.createElement(Le,{md:3,sm:6},j.a.createElement(le,{name:"".concat(o,".").concat(d,".meal_plan"),render:function(t){var a=t.field;return j.a.createElement(ja,Object.assign({},a,{label:"Meal Plan",multiple:!1,searchable:!1,options:e.hotel?e.hotel.meal_plans:[],onChange:function(e,t){return r(t,e)}}))}}))),j.a.createElement("div",null,j.a.createElement(I.c,{name:"".concat(o,".").concat(d,".room_details"),render:function(t){var n=t.name,c=t.push,l=t.remove;return j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Room Details"),j.a.createElement("ol",{className:"list"},e.room_details.map(function(t,a){return j.a.createElement("li",{key:a},j.a.createElement(He,{key:a,style:{marginTop:"15px"}},j.a.createElement(Le,{md:"auto",sm:6},j.a.createElement(le,{name:"".concat(n,".").concat(a,".room_type"),render:function(t){var c=t.field;return j.a.createElement(Ma,Object.assign({},c,{label:"Room Type",options:e.hotel?e.hotel.room_types:[],searchable:!1,multiple:!1,onChange:function(e,t){r(t,e),e&&e.allowed_extra_beds||(r("".concat(n,".").concat(a,".adults_with_extra_bed"),0),r("".concat(n,".").concat(a,".children_with_extra_bed"),0))}}))}})),j.a.createElement(Le,{md:"auto",sm:6},j.a.createElement(ie,{name:"".concat(n,".").concat(a,".no_of_rooms"),label:"Number of rooms",type:"number",min:1,max:1e3})),j.a.createElement(Le,null,j.a.createElement(ie,{name:"".concat(n,".").concat(a,".adults_with_extra_bed"),label:"Adults with extra bed",type:"number",min:0,max:10,disabled:!t.room_type||!t.room_type.allowed_extra_beds})),j.a.createElement(Le,null,j.a.createElement(ie,{name:"".concat(n,".").concat(a,".children_with_extra_bed"),label:"Children with extra bed",type:"number",min:0,max:10,disabled:!t.room_type||!t.room_type.allowed_extra_beds})),j.a.createElement(Le,null,j.a.createElement(ie,{name:"".concat(n,".").concat(a,".children_without_extra_bed"),label:"Children without extra bed",min:0,max:10,type:"number"})),j.a.createElement(Le,{sm:12},j.a.createElement("div",{className:"button-group"},j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){return c(e.room_details[a])}},"+ Duplicate"),e.room_details.length>1?j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){return l(a)}},"\xd7 Remove"):null))))}),j.a.createElement("hr",null),j.a.createElement(P.d,{className:"btn--secondary",onClick:function(e){return c(a.hotels[0].room_details[0])}},"+ Add More Room Types")))}})),j.a.createElement(P.g,null,j.a.createElement("b",null,"Get the price for the above hotel query"),j.a.createElement("br",null),j.a.createElement("br",null),j.a.createElement("div",{className:"button-group"},j.a.createElement(P.d,{disabled:t,type:"submit"},"Get Price")," ",void 0!==e.calculated_price?j.a.createElement("span",{className:"btn"},e.calculated_price):null),e.no_price_for_dates&&e.no_price_for_dates.length?j.a.createElement("p",{className:"text-yellow-800"},"No prices available for"," ",e.no_price_for_dates.map(function(e){return ye.a.utc(e).local().format("Do MMM")}).join(", ")):null),j.a.createElement(He,null,j.a.createElement(Le,{sm:"auto"},j.a.createElement(P.g,null,j.a.createElement("label",null,"Given Price"),j.a.createElement(ce,{name:"".concat(o,".").concat(d,".given_price"),type:"number",value:e.given_price,onChange:function(e){var t=parseInt(e.target.value,10);isNaN(t)&&(t=void 0),i({hotels:n.hotels.map(function(e,a){return a!==d?e:Object(M.a)({},e,{given_price:t})})}),r(e.target.name,t)},min:0}))),j.a.createElement(Le,null,j.a.createElement(P.g,null,j.a.createElement("label",null,"Comments"),j.a.createElement(ce,{name:"".concat(o,".").concat(d,".comments"),as:"textarea",maxLength:191,value:e.comments,placeholder:"Regarding pricing difference or any other",onChange:function(e){var t=e.target.value;i({hotels:n.hotels.map(function(e,a){return a!==d?e:Object(M.a)({},e,{comments:t})})}),r(e.target.name,t)}})))),j.a.createElement("hr",null),j.a.createElement("div",{className:"button-group form-group"},j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){return s(e)}},"+ Duplicate This Query"),n.hotels.length>1?j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){return m(d)}},"\xd7 Remove This Query"):null))}),j.a.createElement("div",null,j.a.createElement(P.d,{onClick:function(){return s(a.hotels[0])}},"+ Add More Night and Hotels")))}}))}})});function Ln(e){var t=Object(y.useState)(0),a=Object(_e.a)(t,2),n=a[0],r=a[1];return j.a.createElement("div",null,j.a.createElement("div",{className:"flex align-items-center mb-8"},j.a.createElement(k.a,{to:"..",className:"mr-4 text-blue-600 hover:text-blue-800 text-lg px-2 border rounded-full"},j.a.createElement(P.h.ChevronDownIcon,{className:"rotate-90"})),j.a.createElement("h3",{className:"m-0"},"Calculate Hotel Prices")),j.a.createElement("p",null,"Please enter the desired hotel configuration query and press get price to get the prices."),j.a.createElement(Hn,{onChange:function(e){return r(e)}}),j.a.createElement("footer",{className:"mt-8 pb-8"},j.a.createElement("h4",null,j.a.createElement("mark",null,"Total Cost Price: ",n))))}function Un(e){return j.a.createElement(te,null,j.a.createElement("div",{className:"float-right button-group"},j.a.createElement(k.a,{to:"new",className:"btn"},"New Hotel"),j.a.createElement(k.a,{to:"calculate-price",className:"btn"},"Calculate Price")),j.a.createElement("h2",null,"Hotels"),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(Mn,{path:"new"}),j.a.createElement(Za,{path:":hotelId/*"}),j.a.createElement(ua,{path:"/"}),j.a.createElement(Ln,{path:"calculate-price"})))}var Vn="CAB_TYPES_STATE",Bn={isFetching:!0,state:We()},Qn={list:Object(Y.createAsyncAction)("@CAB_TYPES/LIST_FETCH_REQUEST","@CAB_TYPES/LIST_FETCH_SUCCESS","@CAB_TYPES/LIST_FETCH_FAILED")()},Gn=ze(Bn,Qn);function Kn(e){var t=e[Vn];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function Wn(e){return{getCabTypes:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/cab-types",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Jn=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Qn.list.request()),t.abrupt("return",Wn(c).getCabTypes(e).then(function(e){var t=e.data,n=e.meta;return a(Qn.list.success({data:t,meta:n})),t}).catch(function(e){return a(Qn.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function zn(){var e=J();return Object(y.useCallback)(function(t){return e(Jn(t))},[e])}function $n(){return Object(M.a)({},Object(w.c)(function(e){var t=Kn(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,cabTypes:t.get()})}),{fetchCabTypes:zn()})}function Xn(e){var t=$n(),a=t.cabTypes,n=t.isFetching,r=t.total,c=t.currentPage,l=t.lastPage,i=t.from,u=t.to,o=t.fetchCabTypes,s=st(),m=Object(_e.a)(s,2),d=m[0],f=m[1];return Object(y.useEffect)(function(){o({page:c})},[o]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Cab Types")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ft,{onSearch:function(e){f(e),o(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:r,from:i,to:u,currentPage:c,lastPage:l,isFetching:n,onChange:function(e){return o(Object(M.a)({},d,{page:e}))}}))),j.a.createElement(ot,{isFetching:n,total:r},j.a.createElement(P.l,{headers:["Name","Capacity"],alignCols:{1:"right"},bordered:!0,striped:!0,rows:a.map(function(e){return[e.name,e.capacity]})})))}var Zn=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return Wn(t).getCabTypes({q:e}).then(function(e){return e.data})}}))}),er=D.object().shape({name:D.string().required("Name field is required"),capacity:D.number().positive("Capacity should be a positive integer").integer("Capacity should be a positive integer").required("Capacity field is required")}),tr={name:"",capacity:4};var ar=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"New Cab Type")),j.a.createElement(I.e,{initialValues:tr,validationSchema:er,onSubmit:function(e,n){n.setStatus(),t.post("/cab-types",e).then(function(){a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status;return j.a.createElement(I.d,{noValidate:!0},a?j.a.createElement("div",null,a):null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Add Cab Type"),j.a.createElement(ie,{label:"Name",name:"name",placeholder:"Medium",required:!0}),j.a.createElement(ie,{label:"Capacity",name:"capacity",required:!0,type:"number",min:1}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))});function nr(e){return j.a.createElement(te,null,j.a.createElement(k.a,{to:"new",className:"btn float-right"},"New Cab Type"),j.a.createElement("h2",null,"Cab Types"),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(ar,{path:"/new"}),j.a.createElement(Xn,{path:"/"})))}var rr="CAB_LIST_STATE",cr={isFetching:!0,state:We()},lr={list:Object(Y.createAsyncAction)("@CABS/LIST_FETCH_REQUEST","@CABS/LIST_FETCH_SUCCESS","@CABS/LIST_FETCH_FAILED")(),item:Object(Y.createAsyncAction)("@CABS/ITEM_FETCH_REQUEST","@CABS/ITEM_FETCH_SUCCESS","@CABS/ITEM_FETCH_FAILED")()},ir=ze(cr,lr);function ur(e){var t=e[rr];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function or(e){return{getCab:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/cabs/".concat(a)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var sr=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(lr.item.request()),t.abrupt("return",or(c).getCab(e).then(function(e){return a(lr.item.success(e)),e}).catch(function(e){return a(lr.item.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function mr(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(e){return Object(w.c)(function(t){var a=ur(t);return{isFetching:a.isFetching,cab:a.getItem(e)}})}(e),n=function(){var e=J();return Object(y.useCallback)(function(t){return e(sr(t))},[e])}();return Object(y.useEffect)(function(){t&&e&&n(e)},[e,t,n]),Object(M.a)({},a,{fetchCab:n})}function dr(e){var t=e.cabId,a=e.navigate,n=mr(t,!0),r=n.cab,c=n.isFetching;return t?j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,r?r.number_plate:""," Cab")),j.a.createElement(k.a,{to:".."},"Back to list"),c?"Loading...":r?j.a.createElement("div",null,r.name," - ",r.cab_type.name," - ",r.number_plate,j.a.createElement("br",null),"Created at:"," ",ye.a.utc(r.created_at).local().toLocaleString(),j.a.createElement("br",null)):j.a.createElement(k.d,{noThrow:!0,to:"/cabs"})):(a&&a("/cabs"),null)}function fr(e){return{getCabs:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/cabs",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Er=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(lr.list.request()),t.abrupt("return",fr(c).getCabs(e).then(function(e){var t=e.data,n=e.meta;return a(lr.list.success({data:t,meta:n})),t}).catch(function(e){return a(lr.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function pr(){var e=Object(w.b)();return Object(y.useCallback)(function(t){return e(Er(t))},[e])}function hr(){return Object(M.a)({},Object(w.c)(function(e){var t=ur(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,cabs:t.get()})}),{fetchCabs:pr()})}function br(e){var t=hr(),a=t.cabs,n=t.total,r=t.from,c=t.to,l=t.currentPage,i=t.lastPage,u=t.isFetching,o=t.fetchCabs,s=st(),m=Object(_e.a)(s,2),d=m[0],f=m[1];return Object(y.useEffect)(function(){o({page:l})},[o]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Cabs")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(dt,{onSearch:function(e){f(e),o(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:n,from:r,to:c,currentPage:l,lastPage:i,isFetching:u,onChange:function(e){return o(Object(M.a)({},d,{page:e}))}}))),j.a.createElement(ut,{isFetching:u,total:n},j.a.createElement(P.l,{headers:["Name","Number Plate"],striped:!0,bordered:!0,rows:a.map(function(e){return[j.a.createElement(k.a,{to:e.id.toString()},e.name),e.number_plate]})})))}xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0,fetch:function(e){return fr(t).getCabs({q:e}).then(function(e){return e.data})}},a))});var gr=D.object().shape({name:D.string().required("Name for the cab is required."),number_plate:D.string().required("Number Plate is required").max(299,"Maximum 299 characters allowed"),cab_type:D.object().required("Cab type is required")}),vr={name:"",number_plate:"",cab_type:void 0};var _r=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement("div",null,j.a.createElement(I.e,{initialValues:vr,validationSchema:gr,onSubmit:function(e,n){var r=e.number_plate,c=e.cab_type,l=e.name;if(r&&c&&l)return n.setStatus(),t.post("/cabs",{name:l,number_plate:r,cab_type_id:c.id}).then(function(e){var t=e.data.data;a&&a("../".concat(t.id)),n.setSubmitting(!1)}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)});n.setStatus("Please fill the required fields")},render:function(e){var t=e.isSubmitting,a=e.status,n=e.setFieldValue;return j.a.createElement(I.d,{noValidate:!0},a?j.a.createElement("div",null,a):null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Add New Cab"),j.a.createElement(ie,{label:"Name",name:"name",required:!0,placeholder:"Suzuki Wagon R"}),j.a.createElement(le,{name:"cab_type",render:function(e){var t=e.field;return j.a.createElement(Zn,Object.assign({},t,{label:"Cab Type",multiple:!1,placeholder:"Type to search... (e.g. Wagon)",onChange:function(e,t){return n(t,e)}}))}}),j.a.createElement(ie,{label:"Number Plate",name:"number_plate",required:!0,placeholder:"RJ18 CC 7838"}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Submit"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))});function Sr(e){return j.a.createElement(te,null,j.a.createElement(k.a,{to:"new",className:"btn float-right"},"Add New Cab"),j.a.createElement("h2",null,"Cabs"),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(_r,{path:"/new"}),j.a.createElement(dr,{path:":cabId"}),j.a.createElement(br,{path:"/"})))}var yr="TRIP_LIST_STATE",jr={isFetching:!0,state:We()},Or={list:Object(Y.createAsyncAction)("@TRIPS/LIST_FETCH_REQUEST","@TRIPS/LIST_FETCH_SUCCESS","@TRIPS/LIST_FETCH_FAILED")(),item:Object(Y.createAsyncAction)("@TRIPS/ITEM_FETCH_REQUEST","@TRIPS/ITEM_FETCH_SUCCESS","@TRIPS/ITEM_FETCH_FAILED")()},Tr=ze(jr,Or);function wr(e){var t=e[yr];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function Cr(e){return{getTrips:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/trips",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var xr=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Or.list.request()),t.abrupt("return",Cr(c).getTrips(e).then(function(e){return a(Or.list.success(e)),e.data}).catch(function(e){return a(Or.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Nr(){var e=J();return Object(y.useCallback)(function(t){return e(xr(t))},[e])}function kr(){return Object(M.a)({},Object(w.c)(function(e){var t=wr(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,trips:t.get()})}),{fetchTrips:Nr()})}function Pr(e){Object(it.a)(e);var t=st(),a=Object(_e.a)(t,2),n=a[0],r=a[1],c=kr(),l=c.trips,i=c.fetchTrips,u=c.total,o=c.from,s=c.to,m=c.currentPage,d=c.lastPage,f=c.isFetching;return Object(y.useEffect)(function(){i({page:m})},[i]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"List of trips")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ft,{onSearch:function(e){r(e),i(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:u,from:o,to:s,currentPage:m,lastPage:d,isFetching:f,onChange:function(e){return i(Object(M.a)({},n,{page:e}))}}))),j.a.createElement(ot,{total:u,isFetching:f},j.a.createElement(P.l,{striped:!0,bordered:!0,responsive:!0,headers:["ID","Dates","Stages","Destinations","Traveler","Pax"],rows:l.map(function(e){var t=e.id,a=e.trip_source,n=e.trip_id,r=e.start_date,c=e.end_date,l=e.locations,i=e.no_of_adults,u=e.children,o=e.contact,s=e.latest_stage;return[j.a.createElement(k.a,{to:t.toString()},a.short_name,"-",n||t),"".concat(ye.a.utc(r).local().format("DD/MM/YYYY")," to ").concat(ye.a.utc(c).local().format("DD/MM/YYYY")),s?s.name:"Initiated",l.map(function(e){return e.short_name}).join(" \u2022\xa0"),o?j.a.createElement("div",null,o.name,j.a.createElement("br",null),j.a.createElement("a",{href:"tel:".concat(o.phone_number),className:"btn--icon"},j.a.createElement(P.h.PhoneIcon,{title:"Call to ".concat(o.name," on ").concat(o.phone_number)})),j.a.createElement("a",{href:"mailto:".concat(o.email),className:"btn--icon"},j.a.createElement(P.h.MailIcon,{title:"Send Email to ".concat(o.name," at ").concat(o.email)}))):null,"".concat(i," Adults").concat(u?" with "+u:"")]})})))}var Fr="HOTEL_BOOKING_STAGES_STATE",qr={isFetching:!0,state:We()},Ar={list:Object(Y.createAsyncAction)("@HOTEL_BOOKING_STAGES/LIST_FETCH_REQUEST","@HOTEL_BOOKING_STAGES/LIST_FETCH_SUCCESS","@HOTEL_BOOKING_STAGES/LIST_FETCH_FAILED")()},Ir=ze(qr,Ar);function Dr(e){var t=e[Fr];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function Mr(e){return{getHotelBookingStages:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/hotel-booking-stages",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Yr=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Ar.list.request()),t.abrupt("return",Mr(c).getHotelBookingStages(e).then(function(e){var t=e.data,n=e.meta;return a(Ar.list.success({data:t,meta:n})),t}).catch(function(e){return a(Ar.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Rr(){var e=J();return Object(y.useCallback)(function(t){return e(Yr(t))},[e])}function Hr(){return Object(M.a)({},Object(w.c)(function(e){var t=Dr(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,hotelBookingStages:t.get()})}),{fetchHotelBookingStages:Rr()})}function Lr(e){var t=Hr(),a=t.hotelBookingStages,n=t.total,r=t.from,c=t.to,l=t.isFetching,i=t.currentPage,u=t.lastPage,o=t.fetchHotelBookingStages,s=st(),m=Object(_e.a)(s,2),d=m[0],f=m[1];return Object(y.useEffect)(function(){o({page:i})},[o]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Hotel Booking Stages")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ft,{onSearch:function(e){f(e),o(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:n,from:r,to:c,currentPage:i,lastPage:u,isFetching:l,onChange:function(e){return o(Object(M.a)({},d,{page:e}))}}))),j.a.createElement(ot,{total:n,isFetching:l},j.a.createElement(P.l,{bordered:!0,striped:!0,headers:["Name","Description"],rows:a.map(function(e){return[e.name,e.description]})})))}var Ur=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return Mr(t).getHotelBookingStages({q:e}).then(function(e){return e.data})}}))}),Vr=D.object().shape({name:D.string().required("Name field is required"),description:D.string().required("Description field is required")}),Br={name:"",description:""};var Qr=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"New Hotel Booking Stage")),j.a.createElement(I.e,{initialValues:Br,validationSchema:Vr,onSubmit:function(e,n){n.setStatus(),t.post("/hotel-booking-stages",e).then(function(){a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status;return j.a.createElement(I.d,{noValidate:!0},a?j.a.createElement("div",null,a):null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Add New Hotel Booking Stage"),j.a.createElement(ie,{label:"Name",name:"name",placeholder:"Booked",required:!0}),j.a.createElement(ie,{label:"Description",name:"description",placeholder:"Hotel Booked",required:!0}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))});function Gr(e){return j.a.createElement(te,null,j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement("h2",{className:"white-space-pre"},"Hotel Booking Stages")),j.a.createElement(Le,{className:"d-flex align-items-center justify-content-end"},j.a.createElement(k.a,{to:"new",className:"btn"},"New Hotel Booking Stage"))),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(Qr,{path:"/new"}),j.a.createElement(Lr,{path:"/"})))}function Kr(e){return{getQuotes:function(t,a){return e.get("/trips/".concat(t,"/quotes"),{params:a}).then(function(e){return e.data.data})},giveQuote:function(t){return e.post("/given-quotes",t).then(function(e){return e.data.data})},getInstalments:function(t){return e.get("/quote-instalments/".concat(t)).then(function(e){return e.data})},changeHotelBookingStage:function(t,a){return e.patch("/quote-hotel-booking-stages",{items:[t],stage:a})}}}var Wr=xe(function(e){var t=e.xhr,a=e.quoteHotel,n=a.id,r=a.latest_booking_stage,c=Object(y.useState)(!1),l=Object(_e.a)(c,2),i=l[0],u=l[1];return i?j.a.createElement("span",null,j.a.createElement(I.e,{initialValues:{stage:r},validationSchema:D.object().shape({stage:D.object().required("Stage field is required")}),onSubmit:function(e,a){e.stage?Kr(t).changeHotelBookingStage(n,e.stage.id).then(function(){window.location=window.location}):a.setSubmitting(!1)},render:function(e){var t=e.isSubmitting,a=e.setFieldValue;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Change Booking Stage"),j.a.createElement(le,{name:"stage",render:function(e){var t=e.field;return j.a.createElement(Ur,Object.assign({},t,{label:"Select the booking stage",multiple:!1,fetchOnMount:!0,onChange:function(e,t){return a(t,e)}}))}}),j.a.createElement("footer",null,j.a.createElement(P.d,{disabled:t,type:"submit"},"Save"),j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){return u(!1)}},"Cancel"))))}})):j.a.createElement("span",null,r?r.name:null,j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){return u(!0)}},"\u270e"))}),Jr=D.object().shape({given_price:D.number().positive("Given price should a positive number").required("Give price field is required"),comments:D.string()}).required("Quote data is required"),zr=xe(function(e){var t=e.quote,a=e.xhr,n=e.readOnly,r=void 0!==n&&n,c=e.navigate,l=e.showHotelBookingStatus,i=t.id,u=t.total_price,o=t.hotels,s=t.cabs,m=t.comments,d=t.created_by,f=t.created_at,E=t.trip_id,p=Object(P.m)(),h=Object(_e.a)(p,3),b=h[0],g=h[1],v=h[2],_=Object(P.o)(function(){return Kr(a).getInstalments(i).then(function(e){return e.data})}),S=Object(_e.a)(_,3),y=S[0],O=S[1],T=S[2].isFetching;return j.a.createElement("div",null,j.a.createElement("header",{className:"mb-4"},j.a.createElement("h6",null,"Cost Price: ",j.a.createElement(P.h.RupeeIcon,null)," ",W(u)," /-"),j.a.createElement("blockquote",null,m?j.a.createElement("p",null,m):null,j.a.createElement("em",null,"on"," ",ye.a.utc(f).local().format("DD MMM, YYYY [at] hh:mm A")," ","by ",d.name,"<",d.email,">"))),j.a.createElement("section",null,j.a.createElement("h6",null,j.a.createElement("span",{className:"inline-flex w-8 h-8 align-items-center justify-content-center bg-primary-100 rounded-full mr-2"},j.a.createElement(P.h.BedIcon,null)),"Accommodation"),j.a.createElement(P.l,{striped:!0,bordered:!0,caption:"Bellow are the details of daywise hotel accomodation and their prices",responsive:!0,headers:["Date","Hotels","Meal Plan","Rooms","Price"].concat(l?["Booking Stage"]:[]),alignCols:{4:"right",5:"center"},rows:o.map(function(e){var t=e.hotel,a=e.checkin,n=e.checkout,r=e.meal_plan,c=e.room_type,i=e.no_of_rooms,u=e.comments,o=e.given_price;return[j.a.createElement("span",{className:"whitespace-pre"},ye.a.utc(a).local().format("DD MMM YYYY"),j.a.createElement("br",null),j.a.createElement("small",null,ye.a.utc(n).diff(ye.a.utc(a),"days")+1," ","Nights")),j.a.createElement("div",null,j.a.createElement("b",null,t.name),j.a.createElement("br",null),j.a.createElement("small",null,t.location.short_name,", ",t.stars," Star"),u?j.a.createElement("blockquote",null,u):null),r.name,j.a.createElement("div",null,c.name,j.a.createElement("br",null),j.a.createElement("small",null,i," Rooms")),W(o)].concat(l?[j.a.createElement(Wr,{quoteHotel:e})]:[])})})),j.a.createElement("section",null,j.a.createElement("h6",null,j.a.createElement("span",{className:"inline-flex w-8 h-8 align-items-center justify-content-center bg-primary-100 rounded-full mr-2"},j.a.createElement(P.h.BusIcon,null)),"Transportation"),j.a.createElement(P.l,{striped:!0,bordered:!0,caption:"Bellow are the details for the daywise transportation and their prices",responsive:!0,headers:["Date","Service","Cabs","Price"],alignCols:{3:"right"},rows:s.map(function(e){var t=e.from_date,a=e.to_date,n=e.cab_type,r=e.transport_service,c=e.no_of_cabs,l=e.comments,i=e.given_price;return[j.a.createElement("span",{className:"whitespace-pre"},ye.a.utc(t).local().format("DD MMM YYYY")," ",j.a.createElement("br",null),j.a.createElement("small",null,ye.a.utc(a).diff(ye.a.utc(t),"days")+1," ","Days")),j.a.createElement("div",null,r.name,l?j.a.createElement("blockquote",null,l):null),j.a.createElement("div",null,n.name,j.a.createElement("br",null),j.a.createElement("small",null,c," cabs")),W(i)]})})),r?null:j.a.createElement("footer",null,j.a.createElement("div",{className:"button-group"},j.a.createElement(P.d,{onClick:g},"Give this quote"),j.a.createElement(P.e,{open:b,onClose:v},j.a.createElement(P.e.Header,null,j.a.createElement(P.e.Title,{as:"h4"},"Give this quote (price: ",t.total_price,")")),j.a.createElement(P.e.Body,null,j.a.createElement(I.e,{initialValues:{comments:"",factor:1.1,given_price:Math.ceil(1.1*t.total_price)},validationSchema:Jr,onSubmit:function(e,t){var n,r,l;window.confirm("Are you sure you want to give this quote to the customer?")?(n=i,r=e.given_price,l=e.comments,Kr(a).giveQuote({given_price:r,quote_id:n,comments:l})).then(v).then(function(){c&&c("../given-quotes")}):t.setSubmitting(!1)},render:function(e){var a=e.isSubmitting,n=e.values,r=e.setFieldValue;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement(P.g,null,j.a.createElement("label",null,"Multiplication Factor"),j.a.createElement("select",{name:"factor",value:n.factor,onChange:function(e){r("given_price",Math.ceil(t.total_price*parseFloat(e.target.value))),r(e.target.name,e.target.value)}},j.a.createElement("option",{value:1.1},"1.1"),j.a.createElement("option",{value:1.2},"1.2"),j.a.createElement("option",{value:1.3},"1.3"),j.a.createElement("option",{value:1.4},"1.4"),j.a.createElement("option",{value:1.5},"1.5"))),j.a.createElement(ie,{name:"given_price",label:"Given Price",type:"number"}),j.a.createElement(ie,{name:"comments",as:"textarea",label:"Any Comments",placeholder:"Write comments regarding prices or anything else..."}),j.a.createElement(P.e.Footer,null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:a},"Give Quote"),j.a.createElement(P.d,{onClick:v,className:"btn--secondary"},"Cancel")))}}))),j.a.createElement(P.d,{onClick:O},"Get Instalments for Hotels and Cabs"," ",T?j.a.createElement(at,null):null),j.a.createElement(k.a,{to:"/trips/".concat(E,"/new-quote"),state:{quote:t},className:"btn"},"Edit")),y?j.a.createElement(P.l,{striped:!0,bordered:!0,headers:["Amount","Due Date"],alignCols:{0:"right"},autoWidth:!0,rows:y.map(function(e){return[e.amount.toFixed(2),ye.a.utc(e.due_date).local().format("DD/MM/YYYY")]})}):null))});var $r=xe(function(e){var t=e.xhr,a=e.trip,n=e.navigate,r=Object(y.useState)([]),c=Object(_e.a)(r,2),l=c[0],i=c[1];return Object(y.useEffect)(function(){Kr(t).getQuotes(a.id).then(i)},[]),j.a.createElement(y.Fragment,null,j.a.createElement("h4",{className:"my-4"},"All Quotes"),0===l.length?j.a.createElement("p",{className:"text-center"},"No quote created for this trip"):j.a.createElement("ol",{className:"list list--bordered"},l.map(function(e){return j.a.createElement("li",{key:e.id},j.a.createElement(zr,{quote:e,navigate:n,readOnly:!!a.converted_at}))})))});function Xr(e){return{getGivenQuotes:function(t){return e.get("/given-quotes",{params:t}).then(function(e){return e.data.data})},getInstalments:function(t){return e.get("/given-quote-instalments/".concat(t)).then(function(e){return e.data})}}}var Zr=xe(function(e){var t=e.givenQuote,a=e.xhr,n=e.readOnly,r=e.showHotelBookingStatus,c=t.id,l=t.given_price,i=t.quote,u=t.comments,o=t.created_by,s=t.created_at,m=Object(P.o)(function(){return Xr(a).getInstalments(c).then(function(e){return e.data})}),d=Object(_e.a)(m,3),f=d[0],E=d[1],p=d[2].isFetching;return j.a.createElement("div",null,j.a.createElement("header",{className:"mb-8"},j.a.createElement("h5",null,"Given Price:"," ",j.a.createElement("mark",null,j.a.createElement(P.h.RupeeIcon,null)," ",W(l)," /-")),j.a.createElement("blockquote",null,u?j.a.createElement("p",null,u):null,j.a.createElement("em",null,"on"," ",ye.a.utc(s).local().format("DD MMM, YYYY [at] hh:mm A")," ","by ",o.name,"<",o.email,">"))),j.a.createElement(zr,{quote:i,readOnly:!0,showHotelBookingStatus:r}),n?null:j.a.createElement(P.d,{onClick:E},"Get Instalments for Customer"," ",p?j.a.createElement(at,null):null),f?j.a.createElement(P.l,{striped:!0,bordered:!0,headers:["Amount","Due Date"],alignCols:{0:"right"},autoWidth:!0,rows:f.map(function(e){return[e.amount.toFixed(2),ye.a.utc(e.due_date).local().format("DD/MM/YYYY")]})}):null)});var ec=xe(function(e){var t=e.xhr,a=e.trip,n=Object(y.useState)([]),r=Object(_e.a)(n,2),c=r[0],l=r[1];return Object(y.useEffect)(function(){Xr(t).getGivenQuotes({trip_id:a.id}).then(l)},[]),j.a.createElement(y.Fragment,null,j.a.createElement("h4",null,"Given Quotes"),0===c.length?j.a.createElement("p",{className:"text-center"},"No quote given yet"):j.a.createElement("ol",{className:"list list--bordered"},c.map(function(e){return j.a.createElement("li",{key:e.id},j.a.createElement(Zr,{givenQuote:e}))})))}),tc="TRANSPORT_SERVICE_PRICES_STATE",ac={isFetching:!0,state:We()},nc={list:Object(Y.createAsyncAction)("@TRANSPORT_SERVICE_PRICES/LIST_FETCH_REQUEST","@TRANSPORT_SERVICE_PRICES/LIST_FETCH_SUCCESS","@TRANSPORT_SERVICE_PRICES/LIST_FETCH_FAILED")()},rc=ze(ac,nc);function cc(e){var t=e[tc];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function lc(e){return{getTransportServicePrices:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/cab-prices",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var ic=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(nc.list.request()),t.abrupt("return",lc(c).getTransportServicePrices(e).then(function(e){var t=e.data,n=e.meta;return a(nc.list.success({data:t,meta:n})),t}).catch(function(e){return a(nc.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function uc(){var e=Object(w.c)(function(e){var t=cc(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,transportServicePrices:t.get()})}),t=function(){var e=J();return Object(y.useCallback)(function(t){return e(ic(t))},[e])}();return Object(M.a)({},e,{fetchTransportServicePrices:t})}function oc(e){var t=uc(),a=t.fetchTransportServicePrices,n=t.transportServicePrices,r=t.total,c=t.from,l=t.to,i=t.currentPage,u=t.lastPage,o=t.isFetching,s=st(),m=Object(_e.a)(s,2),d=m[0],f=m[1];return Object(y.useEffect)(function(){a({page:i})},[a]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Transport Service Prices Listing")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ft,{onSearch:function(e){f(e),a(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:r,from:c,to:l,currentPage:i,lastPage:u,isFetching:o,onChange:function(e){a(Object(M.a)({},d,{page:e}))}}))),j.a.createElement(ot,{total:r,isFetching:o},j.a.createElement(P.l,{bordered:!0,striped:!0,responsive:!0,headers:["Start Date","End Date","Cab Type","Service","Price","/km","Toll","Parking","Night","Min Km/Day"],rows:n.map(function(e){var t=e.start_date,a=e.end_date,n=e.cab_type,r=e.transport_service,c=e.price,l=e.per_km_charges,i=e.minimum_km_per_day,u=e.night_charges,o=e.parking_charges,s=e.toll_charges;return[ye.a.utc(t).local().format("DD/MM/YYYY"),ye.a.utc(a).local().format("DD/MM/YYYY"),n.name,r.name,c,l,s,o,u,i]}),alignCols:{4:"right",5:"right",6:"right",7:"right",8:"right",9:"right"}})))}var sc="TRANSPORT_SERVICES_STATE",mc={isFetching:!0,state:We()},dc={list:Object(Y.createAsyncAction)("@TRANSPORT_SERVICES/LIST_FETCH_REQUEST","@TRANSPORT_SERVICES/LIST_FETCH_SUCCESS","@TRANSPORT_SERVICES/LIST_FETCH_FAILED")()},fc=ze(mc,dc);function Ec(e){var t=e[sc];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function pc(e){return{getTransportServices:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/transport-services",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var hc=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(dc.list.request()),t.abrupt("return",pc(c).getTransportServices(e).then(function(e){return a(dc.list.success(e)),e.data}).catch(function(e){return a(dc.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function bc(){var e=Object(w.c)(function(e){var t=Ec(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,transportServices:t.get()})}),t=function(){var e=J();return Object(y.useCallback)(function(t){return e(hc(t))},[e])}();return Object(M.a)({},e,{fetchTransportServices:t})}function gc(e){Object(it.a)(e);var t=bc(),a=t.fetchTransportServices,n=t.transportServices,r=t.total,c=t.from,l=t.to,i=t.currentPage,u=t.lastPage,o=t.isFetching,s=st(),m=Object(_e.a)(s,2),d=m[0],f=m[1];return Object(y.useEffect)(function(){a({page:i})},[a]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Transport Services List")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ft,{onSearch:function(e){f(e),a(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:r,from:c,to:l,isFetching:o,currentPage:i,lastPage:u,onChange:function(e){return a(Object(M.a)({},d,{page:e}))}}))),j.a.createElement(ot,{total:r,isFetching:o},j.a.createElement(P.l,{responsive:!0,striped:!0,bordered:!0,headers:["Destinations","Distance (kms)"],alignCols:{1:"right"},rows:n.map(function(e){return[e.name,e.distance]})})))}var vc=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return pc(t).getTransportServices({q:e}).then(function(e){return e.data})}}))}),_c=D.object().shape({via:D.array().of(D.object().required("Destination is required")).min(1,"Atleast one locations required").required("Via field is required"),is_sightseeing:D.boolean(),distance:D.number().positive("Distance should be a positive number").integer("Distance should be an integer").required("Distance field is required")}),Sc={via:[void 0],is_sightseeing:!1,distance:0};var yc=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Add New Transport Service")),j.a.createElement(I.e,{initialValues:Sc,validationSchema:_c,onSubmit:function(e,n){n.setStatus();var r=e.distance,c=e.via,l=e.is_sightseeing;return t.post("/transport-services",{distance:r,via:c.map(function(e){return e.id}),is_sightseeing:+!!l}).then(function(){a&&a(".."),n.setSubmitting(!1)}).catch(function(e){return n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1),Promise.reject(e)})},render:function(e){var t=e.isSubmitting,a=e.values,n=e.status,r=e.setFieldValue;return j.a.createElement(I.d,{noValidate:!0},n?j.a.createElement("div",null,n):null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Add New Transport Service"),j.a.createElement(I.c,{name:"via",render:function(e){var t=e.name,n=e.remove,c=e.push;return j.a.createElement("div",{className:"form-group"},j.a.createElement("p",null,"Add destinations for the transportation"),j.a.createElement(He,null,a.via.map(function(e,a,c){return j.a.createElement(Le,{md:3,key:a,style:{marginBottom:"10px"}},j.a.createElement(le,{name:"".concat(t,".").concat(a),render:function(e){var t=e.field;return j.a.createElement(mn,Object.assign({},t,{label:"Destination",multiple:!1,onChange:function(e,t){return r(t,e)}}))}}),c.length>1?j.a.createElement(P.d,{onClick:function(e){return n(a)}},"\xd7 Remove"):null)})),j.a.createElement("hr",null),j.a.createElement(P.d,{onClick:function(e){return c(void 0)}},"+ Add More Destinations"))}}),j.a.createElement(ie,{name:"distance",type:"number",label:"Total distance for the transportation (in kms)",placeholder:"420",required:!0}),j.a.createElement(ie,{name:"is_sightseeing",type:"checkbox",label:"Includes sightseeing"}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))});function jc(e){return j.a.createElement(te,null,j.a.createElement(k.a,{to:"new",className:"btn float-right"},"New Transport Service"),j.a.createElement("h2",null,"Transport Services"),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(yc,{path:"/new"}),j.a.createElement(gc,{path:"/"})))}var Oc=D.object().shape({prices:D.array().of(D.object().shape({start_date:D.string().required("Start date is required"),end_date:D.string().required("End date is required"),cab_type:D.object().required("Cab type is required"),transport_service:D.object().required("Transport service is required"),price:D.number(),per_km_charges:D.number(),minimum_km_per_day:D.number(),night_charges:D.number(),toll_charges:D.number(),parking_charges:D.number()}))}),Tc={prices:[{start_date:"",end_date:"",cab_type:void 0,transport_service:void 0,price:void 0,per_km_charges:void 0,minimum_km_per_day:void 0,toll_charges:0,night_charges:0,parking_charges:0}]};var wc=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement(I.e,{initialValues:Tc,validationSchema:Oc,onSubmit:function(e,n){n.setStatus();var r=[];e.prices.forEach(function(e){var t=e.cab_type,a=e.transport_service,n=e.start_date,c=e.end_date,l=Object(ne.a)(e,["cab_type","transport_service","start_date","end_date"]);t&&a&&r.push(Object(M.a)({},l,{start_date:ye()(n).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),end_date:ye()(c).hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),cab_type_id:t.id,transport_service_id:a.id}))}),function(e){return{storePrice:function(t){return e.post("/cab-prices",t).then(function(e){return e.data.cab_price})}}}(t).storePrice({prices:r}).then(function(){n.setSubmitting(!1),a&&a("..")}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})},render:function(e){var t=e.status,a=e.isSubmitting,n=e.values,r=e.setFieldValue;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",{style:{minInlineSize:"auto"}},j.a.createElement("legend",null,"Add Transport Service Price"),j.a.createElement(I.c,{name:"prices",render:function(e){var t=e.name,a=e.push,c=e.remove;return j.a.createElement("ol",{className:"list"},n.prices.map(function(e,n,l){return j.a.createElement("li",{key:n},j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(Ua,{label:"Start Date",name:"".concat(t,".").concat(n,".start_date"),required:!0})),j.a.createElement(Le,null,j.a.createElement(Ua,{label:"End Date",name:"".concat(t,".").concat(n,".end_date"),required:!0})),j.a.createElement(Le,null,j.a.createElement(le,{name:"".concat(t,".").concat(n,".cab_type"),render:function(e){var t=e.field;return j.a.createElement(Zn,Object.assign({},t,{label:"Cab Type",multiple:!1,required:!0,fetchOnMount:!0,onChange:function(e,t){return r(t,e)}}))}})),j.a.createElement(Le,null,j.a.createElement(le,{name:"".concat(t,".").concat(n,".transport_service"),render:function(e){var t=e.field;return j.a.createElement(vc,Object.assign({},t,{label:"Transport Service",multiple:!1,required:!0,fetchOnMount:!0,onChange:function(e,t){return r(t,e)}}))}}))),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ie,{label:"Price (fixed)",name:"".concat(t,".").concat(n,".price"),type:"number",min:0})),j.a.createElement(Le,null,j.a.createElement(ie,{label:"Charges per Km",name:"".concat(t,".").concat(n,".per_km_charges"),type:"number",min:0})),j.a.createElement(Le,null,j.a.createElement(ie,{label:"Minimum Kms per Day",name:"".concat(t,".").concat(n,".minimum_km_per_day"),type:"number",min:0})),j.a.createElement(Le,null,j.a.createElement(ie,{label:"Toll charges per Km",name:"".concat(t,".").concat(n,".toll_charges"),type:"number",min:0})),j.a.createElement(Le,null,j.a.createElement(ie,{label:"Night Charges per Km",name:"".concat(t,".").concat(n,".night_charges"),type:"number",min:0})),j.a.createElement(Le,null,j.a.createElement(ie,{label:"Parking Charges per km",name:"".concat(t,".").concat(n,".parking_charges"),type:"number",min:0}))),j.a.createElement("div",{className:"button-group"},j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){return a(e)}},"+ Duplicate"),l.length>1?j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){return c(n)}},"\xd7 Remove"):null))}),j.a.createElement("div",{className:"form-group"},j.a.createElement("hr",null),j.a.createElement(P.d,{onClick:function(){return a(Tc.prices[0])}},"+ Add More Transport Prices")))}}),t?j.a.createElement("div",null,t):null,j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:a},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}})});var Cc=D.object().shape({cabs:D.array().of(D.object().shape({start_date:D.string().required("Start date field is required"),no_of_days:D.number().positive("Number of days should be a positive integer").integer("Number of days should be a positive integer").required("Number of days is required."),cab_type:D.object().required("Cab type field is required"),transport_service:D.object().required("Service is required"),no_of_cabs:D.number().positive("Number of cabs should be a positive integer").integer("Number of cabs should be a positive integer.").required("Number of cabs is required")}))}),xc={cabs:[{start_date:"",no_of_days:1,cab_type:void 0,transport_service:void 0,no_of_cabs:1,calculated_price:void 0,given_price:0,comments:""}]},Nc=xe(function(e){var t=e.initialValues,a=void 0===t?xc:t,n=e.xhr,r=e.onChange,c=e.bookingFrom,l=e.bookingTo;function i(e){r&&r(e.cabs.reduce(function(e,t){return e+parseFloat((t.given_price?t.given_price:0).toString())},0),e.cabs.map(function(e){var t=e.start_date,a=e.no_of_days,n=e.cab_type,r=e.transport_service,c=Object(ne.a)(e,["start_date","no_of_days","cab_type","transport_service"]);return Object(M.a)({},c,{from_date:ye()(t).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),to_date:ye()(t).add(a-1,"days").hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),cab_type_id:n&&n.id,transport_service_id:r&&r.id})}))}Object(P.n)(function(){i(a)});var u=Object(y.useMemo)(function(){for(var e=[],t=ye()(l).diff(ye()(c),"days"),a=0;a<=t;a++)e.push({id:a,name:ye()(c).add(a,"day").format("YYYY-MM-DD")});return e},[c,l]);return j.a.createElement(I.e,{initialValues:a,validationSchema:Cc,onSubmit:function(e,t){t.setStatus();var a=[],r={cabs:[]};e.cabs.forEach(function(e){var t=e.start_date,n=e.no_of_days,c=e.cab_type,l=e.transport_service,i=e.no_of_cabs;t&&n&&c&&l&&i&&(r.cabs.push(Object(M.a)({},e,{start_date:ye()(t).format("YYYY-MM-DD"),no_of_days:n})),a.push({from_date:ye()(t).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),to_date:ye()(t).add(n-1,"days").hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),cab_type_id:c.id,transport_service_id:l.id,no_of_cabs:i}))}),function(e){return{getPrice:function(t){return e.get("/prices",{params:{cabs:t}}).then(function(e){return e.data})}}}(n).getPrice(a).then(function(e){r.cabs=r.cabs.map(function(t,a){return Object(M.a)({},t,{calculated_price:e.cabs[a].price,given_price:e.cabs[a].price,no_price_for_dates:e.cabs[a].no_price_for_dates})}),t.setValues(r),t.setSubmitting(!1),i(r)}).catch(function(e){t.setStatus(e.message),e.formikErrors&&t.setErrors(e.formikErrors),t.setSubmitting(!1)})},render:function(e){var t=e.isSubmitting,n=e.values,r=e.status,o=e.setFieldValue;return j.a.createElement(I.d,{noValidate:!0},r?j.a.createElement("div",null,r):null,j.a.createElement(I.c,{name:"cabs",render:function(e){var r=e.name,s=e.push,m=e.remove;return j.a.createElement("div",null,n.cabs.map(function(e,a){return j.a.createElement("fieldset",{key:a},j.a.createElement(He,null,j.a.createElement(Le,null,c&&l?j.a.createElement(le,{name:"".concat(r,".").concat(a,".start_date"),render:function(t){var a=t.field;return j.a.createElement(P.k,Object.assign({},a,{label:"Start Date",options:u,searchable:!1,onQuery:function(){},value:u.find(function(t){return t.name===e.start_date}),placeholder:"Select a date...",required:!0,onChange:function(e,t){o(t,e.name)}}))}}):j.a.createElement(Ua,{label:"Start Date",name:"".concat(r,".").concat(a,".start_date"),required:!0})),j.a.createElement(Le,null,j.a.createElement(ie,{label:"No of days",name:"".concat(r,".").concat(a,".no_of_days"),type:"number",required:!0,min:1,max:1e4})),j.a.createElement(Le,null,j.a.createElement(le,{name:"".concat(r,".").concat(a,".cab_type"),render:function(e){var t=e.field;return j.a.createElement(Zn,Object.assign({},t,{label:"Cab Type",multiple:!1,fetchOnMount:!0,onChange:function(e,t){return o(t,e)}}))}})),j.a.createElement(Le,null,j.a.createElement(le,{name:"".concat(r,".").concat(a,".transport_service"),render:function(e){var t=e.field;return j.a.createElement(vc,Object.assign({},t,{label:"Transport Service",multiple:!1,onChange:function(e,t){return o(t,e)}}))}})),j.a.createElement(Le,null,j.a.createElement(ie,{label:"No of cabs",name:"".concat(r,".").concat(a,".no_of_cabs"),type:"number",required:!0}))),j.a.createElement(P.g,null,j.a.createElement("p",null,j.a.createElement("b",null,"Get the price for this query")),j.a.createElement("div",{className:"button-group"},j.a.createElement(P.d,{type:"submit",disabled:t},"Get Prices"),void 0!==e.calculated_price?j.a.createElement("span",{className:"btn"},e.calculated_price):null),e.no_price_for_dates&&e.no_price_for_dates.length?j.a.createElement("p",{className:"text-yellow-800"},"No prices available for"," ",e.no_price_for_dates.map(function(e){return ye.a.utc(e).local().format("Do MMM")}).join(", ")):null),j.a.createElement(He,null,j.a.createElement(Le,{sm:"auto"},j.a.createElement(P.g,null,j.a.createElement("label",null,"Give Price"),j.a.createElement(ce,{name:"".concat(r,".").concat(a,".given_price"),type:"number",value:e.given_price,onChange:function(e){var t=parseInt(e.target.value,10);isNaN(t)&&(t=void 0),i({cabs:n.cabs.map(function(e,n){return n!==a?e:Object(M.a)({},e,{given_price:t})})}),o(e.target.name,t)},min:0}))),j.a.createElement(Le,null,j.a.createElement(P.g,null,j.a.createElement("label",null,"Comments"),j.a.createElement(ce,{name:"".concat(r,".").concat(a,".comments"),as:"textarea",maxLength:191,value:e.comments,placeholder:"Regarding pricing difference or any other",onChange:function(e){var t=e.target.value;i({cabs:n.cabs.map(function(e,n){return n!==a?e:Object(M.a)({},e,{comments:t})})}),o(e.target.name,t)}})))),j.a.createElement("hr",null),j.a.createElement("div",null,j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){return s(e)}},"+ Duplicate"),n.cabs.length>1?j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){return m(a)}},"\xd7 Remove"):null))}),j.a.createElement("div",null,j.a.createElement("div",null,j.a.createElement(P.d,{onClick:function(){return s(a.cabs[0])}},"+ Add More Price Queries"))))}}))}})});function kc(e){var t=Object(y.useState)(0),a=Object(_e.a)(t,2),n=a[0],r=a[1];return j.a.createElement("div",null,j.a.createElement("div",{className:"flex align-items-center mb-8"},j.a.createElement(k.a,{to:"..",className:"mr-4 text-blue-600 hover:text-blue-800 text-lg px-2 border rounded-full"},j.a.createElement(P.h.ChevronDownIcon,{className:"rotate-90"})),j.a.createElement("h3",{className:"m-0"},"Calculate Transportation Prices")),j.a.createElement("p",null,"Please enter your transportation query and press get price to get the prices."),j.a.createElement(Nc,{onChange:function(e){return r(e)}}),j.a.createElement("footer",{className:"mt-8 pb-8"},j.a.createElement("h4",null,j.a.createElement("mark",null,"Total Cost Price: ",n))))}function Pc(e){return j.a.createElement(te,null,j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement("h2",{className:"white-space-pre"},"Transport Service Prices")),j.a.createElement(Le,{className:"text-right d-flex align-items-center justify-content-end"},j.a.createElement("div",{className:"button-group"},j.a.createElement(k.a,{to:"new",className:"btn"},"Add Price"),j.a.createElement(k.a,{to:"calculate-price",className:"btn"},"Calculate Price")))),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(wc,{path:"/new"}),j.a.createElement(kc,{path:"/calculate-price"}),j.a.createElement(oc,{path:"/"})))}var Fc=xe(function(e){var t=e.xhr,a=e.navigate,n=e.trip,r=e.location,c=r&&r.state&&r.state.quote,l=Object(y.useState)(0),i=Object(_e.a)(l,2),u=i[0],o=i[1],s=Object(y.useState)(0),m=Object(_e.a)(s,2),d=m[0],f=m[1],E=Object(y.useState)([]),p=Object(_e.a)(E,2),h=p[0],b=p[1],g=Object(y.useState)([]),v=Object(_e.a)(g,2),_=v[0],S=v[1],O=Object(y.useState)(c?c.comments:""),T=Object(_e.a)(O,2),w=T[0],C=T[1],x=ye.a.utc(n.start_date).local().format("YYYY-MM-DD HH:mm:ss"),N=ye.a.utc(n.end_date).local().format("YYYY-MM-DD HH:mm:ss");return j.a.createElement("div",{className:"pb-8"},j.a.createElement("h3",{className:"mb-8"},"Create a new quote"),j.a.createElement("section",{className:"mb-16"},j.a.createElement(He,null,j.a.createElement(Le,{lg:2},j.a.createElement("h5",null,"Calculate Prices for hotels"),j.a.createElement("p",null,"Please fill hotel details and then click on get price to get the respective prices. Update the given price if necessary.")),j.a.createElement(Le,null,j.a.createElement(Hn,{bookingFrom:x,bookingTo:N,initialValues:c?{hotels:c.hotels.map(function(e){var t=e.checkin,a=e.checkout,n=e.room_type,r=e.adults_with_extra_bed,c=e.children_with_extra_bed,l=e.children_without_extra_bed,i=e.no_of_rooms,u=Object(ne.a)(e,["checkin","checkout","room_type","adults_with_extra_bed","children_with_extra_bed","children_without_extra_bed","no_of_rooms"]);return Object(M.a)({},u,{start_date:ye.a.utc(t).local().format("YYYY-MM-DD"),no_of_nights:ye.a.utc(a).diff(ye.a.utc(t),"days")+1,room_details:[{room_type:n,adults_with_extra_bed:r,children_with_extra_bed:c,children_without_extra_bed:l,no_of_rooms:i}]})})}:void 0,onChange:function(e,t){o(e),b(t)}}),j.a.createElement("footer",{className:"mt-4"},j.a.createElement("mark",null,"Total price for Accommodation: ",W(u)))))),j.a.createElement("section",{className:"mb-16"},j.a.createElement(He,null,j.a.createElement(Le,{lg:2},j.a.createElement("h5",null,"Calculate Prices for Cabs"),j.a.createElement("p",null,"Please fill the transportation details and click on get price to get the corresponding prices. Update given prices if necessary.")),j.a.createElement(Le,null,j.a.createElement(Nc,{bookingFrom:x,bookingTo:N,initialValues:c?{cabs:c.cabs.map(function(e){var t=e.from_date,a=e.to_date,n=Object(ne.a)(e,["from_date","to_date"]);return Object(M.a)({start_date:ye.a.utc(t).local().format("YYYY-MM-DD"),no_of_days:ye.a.utc(a).diff(ye.a.utc(t),"days")+1},n)})}:void 0,onChange:function(e,t){f(e),S(t)}}),j.a.createElement("footer",{className:"mt-4"},j.a.createElement("mark",null,"Total price for Transportation: ",W(d)))))),j.a.createElement("hr",null),j.a.createElement("h3",null,j.a.createElement("mark",null,"Total Cost Price: ",W(u+d))),j.a.createElement(P.g,null,j.a.createElement("label",null,"Any Comment"),j.a.createElement(ce,{name:"comments",as:"textarea",value:w,onChange:function(e){return C(e.target.value)},placeholder:"Any comments regarding other services or anything else...",maxLength:191})),j.a.createElement(P.d,{primary:!0,onClick:function(){(function(e){return{saveQuote:function(t,a){return e.post("/trips/".concat(t,"/quotes"),a).then(function(e){return e.data.quote})}}})(t).saveQuote(n.id,{total_price:u+d,hotels:h,cabs:_,comments:w}).then(function(){a&&a("../quotes")})}},"Save Quote"))});function qc(e){var t=e.initialState,a=e.render,n=e.children,r=Object(y.useState)(t),c=Object(_e.a)(r,2),l={state:c[0],setState:c[1]};return a?a(l):"function"===typeof n?n(l):n||null}function Ac(e,t){return{getTags:function(){var a=Object(A.a)(q.a.mark(function a(n){return q.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",e.get("/".concat(t,"-tags"),{params:n}).then(function(e){return e.data}));case 1:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}(),storeTags:function(){var a=Object(A.a)(q.a.mark(function a(n,r){return q.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",e.post("/".concat(t,"-tags"),{items:n,tags:r}).then(function(e){return e.data}));case 1:case"end":return a.stop()}},a)}));return function(e,t){return a.apply(this,arguments)}}()}}var Ic=xe(function(e){var t=e.xhr,a=e.type,n=Object(ne.a)(e,["xhr","type"]);return j.a.createElement(P.a,Object.assign({multiple:!0,creatable:!0},n,{fetch:function(e){return Ac(t,a).getTags({q:e}).then(function(e){return e.data})}}))}),Dc=xe(function(e){var t=e.type,a=e.itemId,n=e.xhr,r=e.tags,c=void 0===r?[]:r,l=e.onCancel,i=e.onSuccess;return j.a.createElement(I.e,{initialValues:{items:[a],tags:c},onSubmit:function(e,a){a.setStatus(),Ac(n,t).storeTags(e.items,e.tags.map(function(e){return e.name})).then(function(){a.setSubmitting(!1),i()}).catch(function(e){a.setStatus(e.message),e.formikErrors&&a.setErrors(e.formikErrors),a.setSubmitting(!1)})},render:function(e){var a=e.setFieldValue,n=e.isSubmitting,r=e.status;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Edit Tags"),r?j.a.createElement("p",{className:"error-message"},r):null,j.a.createElement(le,{name:"tags",render:function(e){var n=e.field;return j.a.createElement(Ic,Object.assign({},n,{type:t,onChange:function(e,t){a(t,e)}}))}}),j.a.createElement("footer",null,j.a.createElement(P.d,{type:"submit",primary:!0,disabled:n},"Save"),j.a.createElement(P.d,{disabled:n,onClick:function(){l()}},"Cancel"))))}})});function Mc(e){return{getTrip:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/trips/".concat(a)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),convertTrip:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/converted-trips",a).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),logTransaction:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/payment-transactions",a).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Yc=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Or.item.request()),t.abrupt("return",Mc(c).getTrip(e).then(function(e){return a(Or.item.success(e)),e}).catch(function(e){return a(Or.item.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()},Rc=xe(function(e){var t=e.instalment,a=e.xhr,n=Object(P.m)(),r=Object(_e.a)(n,3),c=r[0],l=r[1],i=r[2];return j.a.createElement(j.a.Fragment,null,j.a.createElement(P.d,{onClick:l},"Add"),j.a.createElement(P.e,{open:c,onClose:i,closeButton:!0},j.a.createElement(P.e.Header,null,j.a.createElement(P.e.Title,null,"Log Transaction")),j.a.createElement(P.e.Body,null,j.a.createElement("p",null,j.a.createElement("mark",null,"INR ",W(t.due_amount))," is due by",j.a.createElement("mark",null,ye.a.utc(t.due_date).local().format("DD MMM, YYYY"))),j.a.createElement(I.e,{initialValues:{amount:t.due_amount,payment_mode:"netbanking",comments:""},onSubmit:function(e,n){var r=e.amount,c=e.comments,l=e.payment_mode;n.setStatus(),Mc(a).logTransaction({instalment_id:t.id,amount:r,payment_mode:l,comments:c}).then(function(){n.setSubmitting(!1),window.location=window.location}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setStatus(!1)})},render:function(e){var t=e.isSubmitting,a=e.status;return j.a.createElement(I.d,{noValidate:!0},a?j.a.createElement("p",{className:"error"},a):null,j.a.createElement(ie,{name:"amount",label:"Paid Amount (INR)",required:!0}),j.a.createElement(ie,{as:"select",name:"payment_mode",label:"Payment Mode",required:!0},j.a.createElement("option",{value:"cash"},"Cash"),j.a.createElement("option",{value:"netbanking"},"Netbanking"),j.a.createElement("option",{value:"upi"},"UPI"),j.a.createElement("option",{value:"others"},"Others")),j.a.createElement(ie,{name:"comments",as:"textarea",label:"Comments",placeholder:"Any comments consisting reference id or payment details"}),j.a.createElement(P.e.Footer,null,j.a.createElement(P.d,{primary:!0,disabled:t,type:"submit"},"Update"),j.a.createElement(P.d,{onClick:i},"Cancel")))}}))))});function Hc(e){var t=e.instalment;return j.a.createElement("div",null,t.transactions&&t.transactions.length?j.a.createElement("div",null,t.transactions.map(function(e){return j.a.createElement("div",{key:e.id},ye.a.utc(e.date).local().format("DD MMM, YYYY [at] hh:mm A")," - ",W(e.amount)," /-",e.comments?j.a.createElement("blockquote",null,e.comments):null)})):j.a.createElement("p",null,"Nothing yet"),t.due_amount>0?j.a.createElement(Rc,{instalment:t}):null)}function Lc(e){var t=e.dueAmount,a=e.dueDate,n="Due";if(t<=0)n="Paid";else{var r=ye.a.utc(a).local(),c=ye()();r.isBefore(c)&&(n="Overdue")}return"Due"==n?null:j.a.createElement(P.b,{className:be()("Paid"===n&&"bg-green-300","Overdue"===n&&"bg-red-300","Due"===n&&"bg-yellow-300")},n)}function Uc(e){var t=e.date;return j.a.createElement("span",null,ye.a.utc(t).local().format("DD MMM, YYYY"))}function Vc(e){var t=e.amount;return j.a.createElement("span",null,W(t))}function Bc(e){var t=e.date,a=e.amount;return j.a.createElement("div",null,j.a.createElement(Vc,{amount:a}),j.a.createElement("br",null),j.a.createElement(Lc,{dueAmount:a,dueDate:t}))}function Qc(e){var t=e.payments;return t&&t.length?j.a.createElement(P.l,{autoWidth:!0,caption:"Payments towards customer",headers:["Due Date","Due","Total","Paid","Transactions"],alignCols:{2:"right",3:"right"},bordered:!0,rows:t.reduce(function(e,t){return e.concat(t.instalments)},[]).map(function(e){return[j.a.createElement(Uc,{date:e.due_date}),j.a.createElement(Bc,{date:e.due_date,amount:e.due_amount}),j.a.createElement(Vc,{amount:e.amount}),j.a.createElement(Vc,{amount:e.paid_amount}),j.a.createElement(Hc,{instalment:e})]})}):null}function Gc(e){var t=e.payments;return t&&t.length?j.a.createElement(P.l,{caption:"Payments for accomodation",headers:["Hotel","Due Date","Due Amount","Total Amount","Paid Amount","Transactions"],striped:!1,bordered:!0,autoWidth:!0},j.a.createElement("tbody",null,t.map(function(e){var t=e.paymentable.hotel;return j.a.createElement(y.Fragment,{key:e.id},e.instalments.map(function(e,a,n){return j.a.createElement("tr",{key:e.id},0===a?j.a.createElement("td",{rowSpan:n.length,className:"vertical-align-middle"},j.a.createElement("b",null,t.name),j.a.createElement("br",null),j.a.createElement("small",null,t.location.short_name,", ",t.stars," Star")):null,j.a.createElement("td",null,j.a.createElement(Uc,{date:e.due_date})),j.a.createElement("td",null,j.a.createElement(Bc,{date:e.due_date,amount:e.due_amount})),j.a.createElement("td",null,j.a.createElement(Vc,{amount:e.amount})),j.a.createElement("td",null,j.a.createElement(Vc,{amount:e.amount})),j.a.createElement("td",null,j.a.createElement(Hc,{instalment:e})))}))}))):null}function Kc(e){var t=e.payments;return t&&t.length?j.a.createElement(P.l,{caption:"Payments for Transportation",headers:["Transportation","Due Date","Due","Total","Paid","Transactions"],striped:!1,bordered:!0,autoWidth:!0},j.a.createElement("tbody",null,t.map(function(e){var t=e.paymentable.cab_type,a=e.paymentable.transport_service;return j.a.createElement(y.Fragment,{key:e.id},e.instalments.map(function(e,n,r){return j.a.createElement("tr",{key:e.id},0===n?j.a.createElement("td",{rowSpan:r.length,className:"vertical-align-middle"},j.a.createElement("b",null,a.name),j.a.createElement("br",null),j.a.createElement("small",null,t.name)):null,j.a.createElement("td",null,j.a.createElement(Bc,{date:e.due_date,amount:e.due_amount})),j.a.createElement("td",null,j.a.createElement(Vc,{amount:e.due_amount})),j.a.createElement("td",null,j.a.createElement(Vc,{amount:e.amount})),j.a.createElement("td",null,j.a.createElement(Vc,{amount:e.paid_amount})),j.a.createElement("td",null,j.a.createElement(Hc,{instalment:e})))}))}))):null}function Wc(e){var t=e.trip,a=t.id,n=t.start_date,r=t.end_date,c=t.locations,l=t.no_of_adults,i=t.children,u=t.trip_source,o=t.trip_id,s=t.contacts,m=t.tags;return j.a.createElement("div",null,j.a.createElement("h3",null,c.map(function(e){return e.short_name}).join(" \u2022 "),j.a.createElement("small",null,"(",u.short_name,"-",o||a,")")),j.a.createElement("dl",null,j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement("dt",null,"Dates"),j.a.createElement("dd",{className:"white-space-pre"},ye.a.utc(n).local().format("DD MMM, YYYY")," ","to"," ",ye.a.utc(r).local().format("DD MMM, YYYY"))),j.a.createElement(Le,null,j.a.createElement("dt",null,j.a.createElement(P.h.UsersIcon,null)," Pax"),j.a.createElement("dd",null,l," Adults",j.a.createElement("br",null),i?j.a.createElement("span",null,j.a.createElement(P.h.ChildIcon,null),i," Children"):"")),j.a.createElement(Le,null,j.a.createElement("dt",null,j.a.createElement(P.h.TagsIcon,null)," Tags"),j.a.createElement("dd",null,j.a.createElement(qc,{initialState:!1},function(e){var a=e.state,n=e.setState;return a?j.a.createElement(Dc,{type:"trip",tags:m,itemId:t.id,onSuccess:function(){n(!1)},onCancel:function(){n(!1)}}):j.a.createElement("div",null,m&&m.length?j.a.createElement(P.c,null,m.map(function(e){return j.a.createElement(P.b,{key:e.id},e.name)})):null,j.a.createElement(P.d,{onClick:function(){n(!0)},className:"p-0 w-8 h-8 ml-2 rounded-full"},j.a.createElement("span",{className:"rotate-90 inline-block"},"\u270e")))}))),j.a.createElement(Le,null,j.a.createElement("dt",null,"Travelers"),j.a.createElement("dd",null,j.a.createElement("ul",{className:"list"},s.map(function(e){return j.a.createElement("li",{key:e.id},j.a.createElement("b",null,e.name),j.a.createElement("br",null),j.a.createElement("span",null,j.a.createElement("a",{href:"tel:".concat(e.phone_number)},e.phone_number),e.email?j.a.createElement("span",null," ","\u2022\xa0",j.a.createElement("a",{href:"mailto:".concat(e.email)},e.email)):null))})))))))}var Jc=xe(function(e){var t=e.trip,a=e.xhr,n=Object(P.m)(),r=Object(_e.a)(n,3),c=r[0],l=r[1],i=r[2],u=t.latest_given_quote,o=t.converted_at;return u?j.a.createElement("fieldset",null,j.a.createElement("legend",null,j.a.createElement("h4",null,o?"Quote used for conversion":"Latest Given Quote")),j.a.createElement(Zr,{givenQuote:u,readOnly:!!o,showHotelBookingStatus:!!o}),j.a.createElement(el,{trip:t,isConvertVisible:c,hideConvert:i,onConvert:function(e){return Mc(a).convertTrip(e)}}),o?null:j.a.createElement("footer",null,j.a.createElement(P.d,{onClick:l,primary:!0},"Mark as converted"))):null});function zc(e){var t=e.trip,a=t.id,n=t.locations,r=t.trip_source,c=t.trip_id,l=t.customer_payments,i=t.cab_payments,u=t.hotel_payments;return j.a.createElement("div",null,j.a.createElement(N.a,null,j.a.createElement("title",null,n.map(function(e){return e.short_name}).join(" \u2022 ")," (",r.short_name,"-",c||a.toString(),")")),j.a.createElement(Wc,{trip:t}),l?j.a.createElement(Qc,{payments:l}):null,u?j.a.createElement(Gc,{payments:u}):null,i?j.a.createElement(Kc,{payments:i}):null,j.a.createElement(Jc,{trip:t}))}function $c(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(e){return Object(w.c)(function(t){var a=wr(t);return{isFetching:a.isFetching,trip:a.getItem(e)}})}(e),n=function(){var e=J();return Object(y.useCallback)(function(t){return e(Yc(t))},[e])}();return Object(y.useEffect)(function(){t&&e&&n(e)},[t,e,n]),Object(M.a)({},a,{fetchTrip:n})}function Xc(e){var t=e.tripId,a=e.navigate,n=$c(t,!0),r=n.trip,c=n.isFetching;return t?c?j.a.createElement("div",{className:"text-center"},j.a.createElement(at,null)):r?j.a.createElement("div",null,j.a.createElement("ul",{className:"border-b flex mb-4 tabs"},j.a.createElement(ve,{to:"..",className:"border"},j.a.createElement(P.h.ChevronDownIcon,{className:"rotate-90"})),j.a.createElement(ve,{to:"",className:"border"},"Trip Details"),j.a.createElement(ve,{to:"given-quotes",className:"border"},"Given Quotes"),j.a.createElement(ve,{to:"quotes",className:"border"},"Quotes"),j.a.createElement(ve,{to:"new-quote",className:"border"},"New Quote")),j.a.createElement(k.e,null,j.a.createElement(zc,{path:"/",trip:r}),j.a.createElement(ec,{path:"given-quotes",trip:r}),j.a.createElement($r,{path:"quotes",trip:r}),j.a.createElement(Fc,{path:"new-quote",trip:r}))):null:(a&&a(".."),null)}var Zc=D.object().shape({instalments:D.array().of(D.object().shape({due_date:D.string().required("Instalment due date is required"),amount:D.number().positive("Instalment amount should a positive number").required("Instalment amount is required"),percentage:D.number().positive("Percentage should be a positive number").required("Percentage field is required")})).min(1,"Atleast one instalment should is required"),comments:D.string(),details_verified:D.boolean().required("Please verify the details before conversion")}).required("Conversion fields are required"),el=xe(function(e){var t=e.trip,a=e.isConvertVisible,n=e.hideConvert,r=e.onConvert,c=e.xhr,l=t.id,i=t.locations,u=t.latest_given_quote,o=t.start_date,s=t.end_date,m=t.no_of_adults,d=t.children,f=Object(P.o)(Object(A.a)(q.a.mark(function e(){return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=2;break}return e.abrupt("return",Promise.reject("No given quote for the trip"));case 2:return e.abrupt("return",Xr(c).getInstalments(u.id).then(function(e){return e.data}));case 3:case"end":return e.stop()}},e)})),{isFetching:!0}),E=Object(_e.a)(f,3),p=E[0],h=E[1],b=E[2].isFetching;return Object(y.useEffect)(function(){a&&h()},[a]),u?j.a.createElement(P.e,{open:a,onClose:n},j.a.createElement(P.e.Header,null,j.a.createElement(P.e.Title,null,"Trip Conversion")),j.a.createElement(P.e.Body,null,b?j.a.createElement(at,null):j.a.createElement(I.e,{initialValues:{comments:"",details_verified:!1,instalments:(p||[]).map(function(e){var t=e.amount,a=e.due_date;return{amount:parseFloat(t.toFixed(2)),due_date:ye.a.utc(a).local().format("YYYY-MM-DD"),percentage:parseFloat((100*t/u.given_price).toFixed(2))}})},validationSchema:Zc,onSubmit:function(e,t){var a=e.details_verified,c=e.instalments,i=e.comments,o=u.given_price;if(t.setStatus(),!a)return t.setStatus("Please verify the details and select the checkbox when done."),void t.setSubmitting(!1);var s=c.reduce(function(e,t){return e+t.amount},0);if(s<o)return t.setStatus("Instalments doesn't sumup(Rs: ".concat(s," /-) with given quote's price (Rs: ").concat(o,") /-")),void t.setSubmitting(!1);window.confirm("".concat(s>o?"Total instalment is greater then given quote's amount. ":"","Are you sure you want to mark this trip as converted ?"))?r({instalments:c.map(function(e){e.percentage;return Object(ne.a)(e,["percentage"])}),comments:i,trip_id:l}).then(function(){t.setSubmitting(!1),n()}).catch(function(e){return t.setStatus(e.message),e.formikErrors&&t.setErrors(e.formikErrors),Promise.reject(e)}):t.setSubmitting(!1)},render:function(e){var t=e.isSubmitting,a=e.values,r=e.setFieldValue,c=e.status;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",null,j.a.createElement("legend",null,j.a.createElement("b",null,"Please verify following details with the customer")),j.a.createElement("p",null,j.a.createElement("b",null,"Trip to"," ",j.a.createElement("mark",null,i.map(function(e){return e.short_name}).join(", "))," ","from"," ",j.a.createElement("mark",null,ye.a.utc(o).local().format("DD MMM, YYYY"))," ","to"," ",j.a.createElement("mark",null,ye.a.utc(s).local().format("DD MMM, YYYY"))," ","with"," ",j.a.createElement("mark",null,m," Adults",d?" and ".concat(d," children"):"")," ","where the package cost is"," ",j.a.createElement("mark",null,j.a.createElement(P.h.RupeeIcon,null)," ",W(u.given_price)," /-"),".")),j.a.createElement("h5",null,"Quote Details"),j.a.createElement("hr",null),j.a.createElement(zr,{quote:u.quote,readOnly:!0})),j.a.createElement("hr",null),j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Customer Instalments"),j.a.createElement(I.c,{name:"instalments",render:function(e){var t=e.name,n=e.push,c=e.remove;return j.a.createElement(j.a.Fragment,null,j.a.createElement("ul",{className:"list"},a.instalments.map(function(e,a,l){return j.a.createElement("li",{key:a},j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ie,{name:"".concat(t,".").concat(a,".due_date"),label:"Date",type:"date"})),j.a.createElement(Le,null,j.a.createElement(P.g,null,j.a.createElement("label",{htmlFor:"".concat(t,".").concat(a,".percentage")},"Percentage"),j.a.createElement(I.b,{name:"".concat(t,".").concat(a,".percentage"),render:function(e){var n=e.field;return j.a.createElement(ce,Object.assign({},n,{onChange:function(e){r("".concat(t,".").concat(a,".amount"),u.given_price*parseFloat(e.target.value||"0")/100),n.onChange(e)},type:"number"}))}}))),j.a.createElement(Le,null,j.a.createElement(P.g,null,j.a.createElement("label",{htmlFor:"".concat(t,".").concat(a,".amount")},"Amount"),j.a.createElement(I.b,{name:"".concat(t,".").concat(a,".amount"),render:function(e){var n=e.field;return j.a.createElement(ce,Object.assign({},n,{onChange:function(e){r("".concat(t,".").concat(a,".percentage"),100*parseFloat(e.target.value||"0")/u.given_price),n.onChange(e)},type:"number"}))}}))),j.a.createElement(Le,{className:"d-flex align-items-center"},j.a.createElement("div",{className:"button-group"},j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){return n(e)}},"+ Duplicate"),l.length>1?j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){return c(a)}},"\xd7 Remove"):null))))})),j.a.createElement("footer",null,j.a.createElement(P.d,{className:"btn--secondary",onClick:function(){var e=Math.max(100-a.instalments.reduce(function(e,t){return e+t.percentage},0),0);n({due_date:"",amount:u.given_price*e/100,percentage:e})}},"+ Add More Instalments")))}})),j.a.createElement(ie,{name:"comments",label:"Comments",as:"textarea",placeholder:"Any comments regarding verification or prices etc.."}),j.a.createElement(ie,{name:"details_verified",type:"checkbox",label:"Verified travel details with customer ?"}),c?j.a.createElement("p",{className:"error"},c):null,j.a.createElement(P.e.Footer,null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Mark as converted"),j.a.createElement(P.d,{onClick:n},"Cancel")))}}))):null}),tl="TRIP_SOURCES_STATE",al={isFetching:!0,state:We()},nl={list:Object(Y.createAsyncAction)("@TRIP_SOURCES/LIST_FETCH_REQUEST","@TRIP_SOURCES/LIST_FETCH_SUCCESS","@TRIP_SOURCES/LIST_FETCH_FAILED")()},rl=ze(al,nl);function cl(e){var t=e[tl];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function ll(e){return{getTripSources:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/trip-sources",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var il=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(nl.list.request()),t.abrupt("return",ll(c).getTripSources(e).then(function(e){return a(nl.list.success(e)),e.data}).catch(function(e){return a(nl.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function ul(){var e=J();return Object(y.useCallback)(function(t){e(il(t))},[e])}function ol(){return Object(M.a)({},Object(w.c)(function(e){var t=cl(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,tripSources:t.get()})}),{fetchTripSources:ul()})}function sl(e){Object(it.a)(e);var t=ol(),a=t.fetchTripSources,n=t.tripSources,r=t.total,c=t.from,l=t.to,i=t.currentPage,u=t.lastPage,o=t.isFetching,s=st(),m=Object(_e.a)(s,2),d=m[0],f=m[1];return Object(y.useEffect)(function(){a({page:i})},[a]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Trip Sources List")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ft,{onSearch:function(e){f(e),a(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:r,from:c,to:l,lastPage:u,currentPage:i,isFetching:o,onChange:function(e){return a(Object(M.a)({},d,{page:e}))}}))),j.a.createElement(ot,{total:r,isFetching:o},j.a.createElement(P.l,{striped:!0,bordered:!0,headers:["Name","Short Name"],rows:n.map(function(e){return[e.name,e.short_name]})})))}var ml=xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return ll(t).getTripSources({q:e}).then(function(e){return e.data})}}))}),dl=D.object().shape({name:D.string().required("Name field is required"),short_name:D.string().required("Short name field is required")}),fl={name:"",short_name:""};var El=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"New Trip Source")),j.a.createElement(I.e,{initialValues:fl,validationSchema:dl,onSubmit:function(e,n){return n.setStatus(),t.post("/trip-sources",e).then(function(e){e.data,a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status;return j.a.createElement(I.d,{noValidate:!0},a?j.a.createElement("div",null,a):null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Add New Source of Trips"),j.a.createElement(ie,{label:"Name",name:"name",placeholder:"Travel Triangle",required:!0}),j.a.createElement(ie,{label:"Short name",name:"short_name",placeholder:"TT",required:!0}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))});function pl(e){return j.a.createElement(te,null,j.a.createElement(k.a,{to:"new",className:"float-right btn"},"New Trip Source"),j.a.createElement("h2",null,"Trip Sources"),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(El,{path:"/new"}),j.a.createElement(sl,{path:"/"})))}var hl=D.object().shape({trip_id:D.string(),start_date:D.string().required("Start date is required"),no_of_nights:z().positive("Number of nights should be a positive integer").integer("Number of nights should be a positive integer").required("Number of nights is required"),destinations:D.array().min(1,"Please select atleast one destination"),no_of_adults:z().positive("Number of adults should be a positive integer").integer("Number of adults should be a positive integer").required("Number of adults field is required"),children:D.array().of(D.object().shape({count:z().positive("Number of children should be positive integer").integer("Number of children should be positive integer").required("Number of children field is required"),age:z().positive("Child age should a positive number").required("Child age is required")})),trip_source:D.object().required("Trip Source Type is required"),contact:D.object().shape({name:D.string().required("Contact name is required."),email:D.string().email("Contact email address in invalid"),phone_number:z().typeError("Phone number is invalid").positive("Phone number should be an positive integer")}).required()}),bl={trip_id:"",start_date:"",no_of_nights:1,destinations:[],no_of_adults:1,children:[],trip_source:void 0,contact:{name:"",email:"",phone_number:void 0,country:void 0}};var gl=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement(I.e,{initialValues:bl,validationSchema:hl,onSubmit:function(e,n){n.setStatus();var r=e.start_date,c=e.no_of_adults,l=e.no_of_nights,i=e.children,u=void 0===i?[]:i,o=e.destinations,s=e.trip_source,m=e.trip_id,d=e.contact;if(r&&l&&c&&o&&o.length){var f={start_date:ye()(r).hours(0).minutes(0).seconds(0).utc().format("YYYY-MM-DD HH:mm:ss"),end_date:ye()(r).add(l,"day").hours(23).minutes(59).seconds(59).utc().format("YYYY-MM-DD HH:mm:ss"),no_of_adults:c,children:u.map(function(e){var t=e.count,a=e.age;return"".concat(t,"-").concat(a,"yo")}).join(","),locations:o.map(function(e){return e.id}),trip_id:m,trip_source_id:s?s.id:void 0,contact:{name:d.name,email:d.email||void 0,phone_number:d.phone_number||void 0,country_id:d.country?d.country.id:void 0}};t.post("/trips",f).then(function(e){var t=e.data.data;a&&a("../".concat(t.id)),n.setSubmitting(!1)}).catch(function(e){n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors),n.setSubmitting(!1)})}else n.setStatus("Please fill the required attributes"),n.setSubmitting(!1)},render:function(e){var t=e.isSubmitting,a=e.status,n=e.values,r=e.setFieldValue;return j.a.createElement(I.d,{noValidate:!0},j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Add New Trip"),a?j.a.createElement("p",{className:"text-red-700"},a):null,j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(le,{name:"destinations",render:function(e){var t=e.field;return j.a.createElement(mn,Object.assign({},t,{label:"Destinations",onChange:function(e,t){return r(t,e)}}))}})),j.a.createElement(Le,null,j.a.createElement(Ua,{name:"start_date",label:"Start Date",required:!0})),j.a.createElement(Le,null,j.a.createElement(ie,{name:"no_of_nights",label:"Number of nights",type:"number",min:1,required:!0})),j.a.createElement(Le,null,j.a.createElement(le,{name:"trip_source",render:function(e){var t=e.field;return j.a.createElement(ml,Object.assign({},t,{label:"Trip Source",required:!0,fetchOnMount:!0,onChange:function(e,t){return r(t,e)},multiple:!1}))}})),j.a.createElement(Le,null,j.a.createElement(ie,{name:"trip_id",label:"Trip ID",placeholder:"1231231"}))),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Pax Details"),j.a.createElement(ie,{name:"no_of_adults",label:"Number of adults",type:"number",min:1,required:!0}),j.a.createElement(I.c,{name:"children",render:function(e){var t=e.name,a=e.remove,r=e.push;return j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Children"),j.a.createElement("ul",{className:"list"},n.children.map(function(e,n){return j.a.createElement(He,{as:"li",key:n},j.a.createElement(Le,{xs:"auto"},j.a.createElement(ie,{label:"Age",name:"".concat(t,".").concat(n,".age"),type:"number",min:1,max:20,required:!0})),j.a.createElement(Le,{xs:"auto"},j.a.createElement(ie,{label:"Count",name:"".concat(t,".").concat(n,".count"),type:"number",min:1,max:1e4,required:!0})),j.a.createElement(Le,{xs:"auto",className:"d-flex align-items-center"},j.a.createElement(P.d,{className:"btn--secondary",onClick:function(e){return a(n)}},"\xd7 Remove")))}),j.a.createElement(P.d,{onClick:function(e){return r({count:1,age:6})}},"+ Add Children Details")))}}))),j.a.createElement(Le,{sm:6},j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Contact Details"),j.a.createElement(I.c,{name:"contact",render:function(e){var t=e.name;return j.a.createElement(He,null,j.a.createElement(Le,{sm:"auto"},j.a.createElement(ie,{name:"".concat(t,".name"),label:"Contact Name",required:!0,placeholder:"Anoop Rai"})),j.a.createElement(Le,{sm:"auto"},j.a.createElement(ie,{name:"".concat(t,".email"),label:"Email",required:!0,type:"email",placeholder:"user@domain.com"})),j.a.createElement(Le,null,j.a.createElement(ie,{name:"".concat(t,".phone_number"),label:"Phone Number",type:"number",required:!0,placeholder:"9779212232"})))}})))),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}})});function vl(e){return j.a.createElement(te,null,j.a.createElement(k.a,{to:"new",className:"float-right btn"},"Add New Trip"),j.a.createElement("h2",null,"Trips"),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(Pr,{path:"/"}),j.a.createElement(gl,{path:"/new"}),j.a.createElement(Xc,{path:":tripId/*"})))}var _l="TRIP_STAGES_STATE",Sl={isFetching:!0,state:We()},yl={list:Object(Y.createAsyncAction)("@TRIP_STAGES/LIST_FETCH_REQUEST","@TRIP_STAGES/LIST_FETCH_SUCCESS","@TRIP_STAGES/LIST_FETCH_FAILED")()},jl=ze(Sl,yl);function Ol(e){var t=e[_l];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function Tl(e){return{getTripStages:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/trip-stages",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var wl=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(yl.list.request()),t.abrupt("return",Tl(c).getTripStages(e).then(function(e){return a(yl.list.success(e)),e.data}).catch(function(e){return a(yl.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Cl(){var e=J();return Object(y.useCallback)(function(t){return e(wl(t))},[e])}function xl(){return Object(M.a)({},Object(w.c)(function(e){var t=Ol(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,tripStages:t.get()})}),{fetchTripStages:Cl()})}function Nl(e){Object(it.a)(e);var t=st(),a=Object(_e.a)(t,2),n=a[0],r=a[1],c=xl(),l=c.fetchTripStages,i=c.tripStages,u=c.total,o=c.from,s=c.to,m=c.currentPage,d=c.lastPage,f=c.isFetching;return Object(y.useEffect)(function(){l({page:m})},[l]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Trip Stages")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(ft,{onSearch:function(e){r(e),l(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:u,from:o,to:s,currentPage:m,lastPage:d,isFetching:f,onChange:function(e){return l(Object(M.a)({},n,{page:e}))}}))),j.a.createElement(ot,{total:u,isFetching:f},j.a.createElement(P.l,{striped:!0,bordered:!0,headers:["Name","Description"],rows:i.map(function(e){return[e.name,e.description]})})))}xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0},a,{fetch:function(e){return Tl(t).getTripStages({q:e}).then(function(e){return e.data})}}))});var kl=D.object().shape({name:D.string().required("Name field is required"),description:D.string().required("Description field is required")}),Pl={name:"",description:""};var Fl=xe(function(e){var t=e.xhr,a=e.navigate;return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"New Trip Stage")),j.a.createElement(I.e,{initialValues:Pl,validationSchema:kl,onSubmit:function(e,n){return n.setStatus(),t.post("/trip-stages",e).then(function(e){e.data,a&&a(".."),n.setSubmitting(!1)}).catch(function(e){n.setSubmitting(!1),n.setStatus(e.message),e.formikErrors&&n.setErrors(e.formikErrors)})},render:function(e){var t=e.isSubmitting,a=e.status;return j.a.createElement(I.d,{noValidate:!0},a?j.a.createElement("div",null,a):null,j.a.createElement("fieldset",null,j.a.createElement("legend",null,"Add new Trip Stage"),j.a.createElement(ie,{label:"Name",name:"name",placeholder:"Converted",required:!0}),j.a.createElement(ie,{label:"Description",name:"description",placeholder:"Trip Converted",required:!0}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Save"),j.a.createElement(k.a,{to:"..",className:"btn"},"Cancel"))))}}))});function ql(e){return j.a.createElement(te,null,j.a.createElement(k.a,{to:"new",className:"float-right btn"},"New Trip Stage"),j.a.createElement("h2",null,"Trip Stages"),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(Fl,{path:"/new"}),j.a.createElement(Nl,{path:"/"})))}var Al="TRIP_PLAN_REQUEST_LIST_STATE",Il={isFetching:!0,state:We()},Dl={list:Object(Y.createAsyncAction)("@TRIP_PLAN_REQUESTS/LIST_FETCH_REQUEST","@TRIP_PLAN_REQUESTS/LIST_FETCH_SUCCESS","@TRIP_PLAN_REQUESTS/LIST_FETCH_FAILED")(),item:Object(Y.createAsyncAction)("@TRIP_PLAN_REQUESTS/ITEM_FETCH_REQUEST","@TRIP_PLAN_REQUESTS/ITEM_FETCH_SUCCESS","@TRIP_PLAN_REQUESTS/ITEM_FETCH_FAILED")()},Ml=ze(Il,Dl);function Yl(e){var t=e[Al];return Object(M.a)({},Je(t.state),{get state(){return t},get isFetching(){return this.state.isFetching}})}function Rl(e){return{getTripPlanRequest:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/trip-plan-requests/".concat(a)).then(function(e){return e.data.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}var Hl=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Dl.item.request()),t.abrupt("return",Rl(c).getTripPlanRequest(e).then(function(e){return a(Dl.item.success(e)),e}).catch(function(e){return a(Dl.item.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Ll(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=function(e){return Object(w.c)(function(t){var a=Yl(t);return{isFetching:a.isFetching,item:a.getItem(e)}})}(e),n=function(){var e=J();return Object(y.useCallback)(function(t){return e(Hl(t))},[e])}();return Object(y.useEffect)(function(){t&&e&&n(e)},[e,t,n]),Object(M.a)({},a,{fetch:n})}function Ul(e){var t=e.cabId,a=e.navigate,n=Ll(t,!0),r=n.item,c=n.isFetching;return t?j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Request from ",r?r.name:""," ",r?r.phone_number:"")),j.a.createElement(k.a,{to:".."},"Back to list"),c?"Loading...":r?j.a.createElement("div",null,r.name," - ",r.phone_number," - ",r.destination,j.a.createElement("br",null),"Created at:"," ",ye.a.utc(r.created_at).local().toLocaleString(),j.a.createElement("br",null)):j.a.createElement(k.d,{noThrow:!0,to:"/trip-plan-requests"})):(a&&a("/trip-plan-requests"),null)}function Vl(e){return{getTripPlanRequests:function(){var t=Object(A.a)(q.a.mark(function t(a){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.get("/trip-plan-requests",{params:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),assignTripRequestsOwner:function(){var t=Object(A.a)(q.a.mark(function t(a,n){return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.post("/trip-plan-request-owners",{items:n,owner_id:a}).then(function(e){return e.data}));case 1:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()}}var Bl=xe(function(e){var t=e.xhr,a=e.request,n=e.onUpdate,r=a.owner,c=a.assigned_at,l=Object(y.useState)(!1),i=Object(_e.a)(l,2),u=i[0],o=i[1];return j.a.createElement("span",null,r?j.a.createElement("span",null,j.a.createElement(k.a,{to:"/users/".concat(r.id)},r.name)," on"," ",ye.a.utc(c).format("Do MMM, YYYY")):j.a.createElement("span",null,"Not Set"),u?j.a.createElement(I.e,{initialValues:{owner:r},onSubmit:function(e,r){r.setStatus();var c=e.owner;if(!c)return null;Vl(t).assignTripRequestsOwner(c.id,[a.id]).then(function(e){return r.setSubmitting(!1),o(!1),n&&n(),e}).catch(function(e){return r.setStatus(e.message),e.formikErrors&&r.setErrors(e.formikErrors),r.setSubmitting(!1),Promise.reject(e)})},render:function(e){var t=e.isSubmitting,a=e.setFieldValue,n=e.status;return j.a.createElement(I.d,null,j.a.createElement("fieldset",null,n?j.a.createElement("p",{className:"text-red-700 my-2"},n):null,j.a.createElement(le,{name:"owner",render:function(e){var t=e.field;return j.a.createElement(_t,Object.assign({},t,{multiple:!1,label:"Select Owner",onChange:function(e,t){return a(t,e)}}))}}),j.a.createElement("footer",null,j.a.createElement(P.d,{primary:!0,type:"submit",disabled:t},"Assign"),j.a.createElement(P.d,{type:"button",disabled:t,onClick:function(){return o(!1)}},"Cancel"))))}}):j.a.createElement(P.d,{title:"Edit",onClick:function(){return o(!0)}},"\u270e"))}),Ql=function(e){return function(){var t=Object(A.a)(q.a.mark(function t(a,n,r){var c;return q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.xhr,a(Dl.list.request()),t.abrupt("return",Vl(c).getTripPlanRequests(e).then(function(e){var t=e.data,n=e.meta;return a(Dl.list.success({data:t,meta:n})),t}).catch(function(e){return a(Dl.list.failure(e)),Promise.reject(e)}));case 3:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}()};function Gl(){var e=Object(w.b)();return Object(y.useCallback)(function(t){return e(Ql(t))},[e])}function Kl(){return Object(M.a)({},Object(w.c)(function(e){var t=Yl(e);return Object(M.a)({},t.meta,{isFetching:t.isFetching,items:t.get()})}),{fetch:Gl()})}function Wl(e){var t=Kl(),a=t.items,n=t.total,r=t.from,c=t.to,l=t.currentPage,i=t.lastPage,u=t.isFetching,o=t.fetch,s=st(),m=Object(_e.a)(s,2),d=m[0],f=m[1];return Object(y.useEffect)(function(){o({page:l})},[o]),j.a.createElement(y.Fragment,null,j.a.createElement(N.a,null,j.a.createElement("title",null,"Trip Plan Requests")),j.a.createElement(He,null,j.a.createElement(Le,null,j.a.createElement(dt,{onSearch:function(e){f(e),o(Object(M.a)({},e,{page:1}))}})),j.a.createElement(Le,{className:"text-right"},j.a.createElement(P.j,{total:n,from:r,to:c,currentPage:l,lastPage:i,isFetching:u,onChange:function(e){return o(Object(M.a)({},d,{page:e}))}}))),j.a.createElement(ut,{isFetching:u,total:n},j.a.createElement(P.l,{headers:["Guest","Destination","Pax","Actions"],striped:!0,bordered:!0,rows:a.map(function(e){return[j.a.createElement("span",null,j.a.createElement("h4",null,e.name),e.phone_number," \u2022 ",e.email),j.a.createElement("span",null,j.a.createElement("h4",null,e.destination),j.a.createElement("span",null,e.start_date?ye.a.utc(e.start_date).local().format("Do MMM, YYYY"):null," ","\u2022 ",e.no_of_days," Days")),j.a.createElement("span",null,e.no_of_adults," Adults with ",e.no_of_children," Children"),j.a.createElement("span",null,e.trip_id?j.a.createElement(k.a,{to:"/trips/".concat(e.trip_id)},"View Associated Trip"):null,j.a.createElement("br",null),"Owner:"," ",j.a.createElement(Bl,{request:e,onUpdate:function(){o(Object(M.a)({page:l},d))}})," ",j.a.createElement("br",null),"Created at: ",ye.a.utc(e.created_at).format("Do MMM, YYYY"))]})})))}xe(function(e){var t=e.xhr,a=Object(ne.a)(e,["xhr"]);return j.a.createElement(Et.a,Object.assign({multiple:!0,fetch:function(e){return Vl(t).getTripPlanRequests({q:e}).then(function(e){return e.data})}},a))});function Jl(e){return j.a.createElement(te,null,j.a.createElement("h2",null,"Trip Plan Requests"),j.a.createElement("hr",null),j.a.createElement(k.e,null,j.a.createElement(Ul,{path:":cabId"}),j.a.createElement(Wl,{path:"/"})))}var zl=function(e){return j.a.createElement("div",{className:"pt-20"},j.a.createElement("div",{className:"max-w-xl mx-auto text-center text-xl border rounded-lg py-20 px-4"},j.a.createElement("div",null,j.a.createElement("div",{className:"text-center mb-10"},j.a.createElement("div",{className:"text-5xl w-20 h-20 rounded-full bg-green-400 inline-block text-white"},j.a.createElement(P.h.OkIcon,{className:"align-middle"}))),j.a.createElement("h1",null,"Your Email Verified Successfully."),j.a.createElement("p",null,"You can now"," ",j.a.createElement(k.a,{to:"/",className:"text-blue-600 hover:text-blue-800"},"login")," ","to the Tourepedia Admin Dashboard."))))};a(315);function $l(e){var t=e.as,a=void 0===t?"div":t,n=e.className,r=e.alignRight,c=void 0!==r&&r,l=Object(ne.a)(e,["as","className","alignRight"]);return j.a.createElement(a,Object.assign({className:be()("drop-down",{"align-right":c},n)},l))}a(316),a(317);var Xl=function(){var e=ee().user;if(!e)return null;var t=e.name;return j.a.createElement("header",{className:"mb-4 border-b text-base"},j.a.createElement("nav",{className:"flex h-16 items-stretch md:justify-between"},j.a.createElement(k.a,{to:"/",className:"inline-flex px-2 mr-4 sm:mr-auto"},j.a.createElement("div",{className:"flex items-center"},j.a.createElement("img",{alt:"Tourepedia Logo",src:"/logo.png",className:"inline-block align-middle rounded-full shadow h-8 w-8 mr-2"}),j.a.createElement("h1",{className:"font-normal text-base m-0 hidden md:block"},"Tourepedia Dashboard"))),j.a.createElement("ul",{className:"flex w-full md:w-auto md:px-4 items-center justify-between md:justify-end"},j.a.createElement($l,{as:"li",className:"inline-block"},j.a.createElement(k.a,{to:"/trips",className:"inline-block"},"Trips"),j.a.createElement("ul",null,j.a.createElement(ge,{to:"/trips"},"Trips"),j.a.createElement(ge,{to:"/trip-plan-requests"},"Trip Plan Requests"),j.a.createElement(ge,{to:"/trip-sources"},"Trip Sources"),j.a.createElement(ge,{to:"/trip-stages"},"Trip Stages"))),j.a.createElement($l,{as:"li",className:"inline-block"},j.a.createElement(k.a,{to:"/hotels"},"Hotels"),j.a.createElement("ul",null,j.a.createElement(ge,{to:"/hotels"},"Hotels"),j.a.createElement(ge,{to:"/meal-plans"},"Meal Plans"),j.a.createElement(ge,{to:"/room-types"},"Room Types"),j.a.createElement(ge,{to:"/hotel-payment-preferences"},"Payment Preferences"),j.a.createElement(ge,{to:"/hotel-booking-stages"},"Booking Stages"))),j.a.createElement($l,{as:"li",className:"inline-block",alignRight:!0},j.a.createElement(k.a,{to:"/transport-services"},j.a.createElement(P.h.BusIcon,{title:"Transport Services"})),j.a.createElement("ul",null,j.a.createElement(ge,{to:"/transport-services"},"Transport Services"),j.a.createElement(ge,{to:"/cab-types"},"Cab Types"),j.a.createElement(ge,{to:"/transport-service-prices"},"Transport Service Prices"),j.a.createElement(ge,{to:"/locations"},"Locations"),j.a.createElement(ge,{to:"/cabs"},"Cabs"))),j.a.createElement($l,{as:"li",className:"inline-block",alignRight:!0},j.a.createElement(k.a,{to:"/users"},j.a.createElement(P.h.UsersIcon,{title:"Users"})),j.a.createElement("ul",{className:"menu"},j.a.createElement(ge,{to:"/users"},"Users"),j.a.createElement(ge,{to:"/roles"},"Roles"))),j.a.createElement($l,{as:"li",className:"inline-block",alignRight:!0},j.a.createElement("a",{className:"toggler",href:"#profile-and-settings"},j.a.createElement(P.h.CogAltIcon,{title:"Hi ".concat(t)})),j.a.createElement("ul",{className:"menu"},j.a.createElement(ge,{to:"/settings"},j.a.createElement(P.h.CogAltIcon,null)," Settings"),j.a.createElement(k.b,null,function(e){var t=e.location;return j.a.createElement(ge,{to:"/logout?from=".concat(t.pathname)},j.a.createElement(P.h.OffIcon,null)," Logout")}))))))};function Zl(){return j.a.createElement("footer",{className:"border-t mt-8"},j.a.createElement(Re,{fluid:!0},j.a.createElement("div",{className:"py-4"},j.a.createElement("span",null,"\xa9 2019 Tourepedia. All rights reserved")," \u2022 ",j.a.createElement("span",null,"v","1.9.0"))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ei=a(146),ti=a(147);var ai,ni=function(e,t){var a=t.initialState,n=t.thunkExtraAgrs,r=[ti.a.withExtraArgument(n)],c=[C.applyMiddleware.apply(void 0,r)];return Object(C.createStore)(e,a,ei.composeWithDevTools.apply(void 0,c))}(Object(C.combineReducers)((ai={},Object(S.a)(ai,n.key,n.reducer),Object(S.a)(ai,c.key,c.reducer),Object(S.a)(ai,r.key,r.reducer),Object(S.a)(ai,i.key,i.reducer),Object(S.a)(ai,u.key,u.reducer),Object(S.a)(ai,o.key,o.reducer),Object(S.a)(ai,l.key,l.reducer),Object(S.a)(ai,m.key,m.reducer),Object(S.a)(ai,d.key,d.reducer),Object(S.a)(ai,f.key,f.reducer),Object(S.a)(ai,b.key,b.reducer),Object(S.a)(ai,g.key,g.reducer),Object(S.a)(ai,h.key,h.reducer),Object(S.a)(ai,p.key,p.reducer),Object(S.a)(ai,s.key,s.reducer),Object(S.a)(ai,E.key,E.reducer),Object(S.a)(ai,v.key,v.reducer),ai)),{thunkExtraAgrs:{xhr:Ne}}),ri=j.a.createElement(w.a,{store:ni},j.a.createElement(x.HelmetProvider,null,j.a.createElement(Ce.Provider,{value:Ne},j.a.createElement(function(e){var t=e.children,a=void 0===t?null:t,n=ee(),r=n.user,c=n.wait,l=n.isAuthenticating,i=n.fetchUser;return Object(y.useEffect)(function(){r||l||i()},[i]),j.a.createElement(y.Fragment,null,"function"===typeof a?a({wait:c,user:r}):a)},null,j.a.createElement(function(){return j.a.createElement(y.Fragment,null,j.a.createElement(N.a,{titleTemplate:"%s | Tourepedia",defaultTitle:"Tourepedia"}),j.a.createElement(Xl,null),j.a.createElement(Re,{fluid:!0},j.a.createElement(k.e,null,j.a.createElement(de,{path:"/login"}),j.a.createElement(Be,{path:"/forgot-password"}),j.a.createElement(Ge,{path:"/reset-password"}),j.a.createElement(Ae,{path:"/"}),j.a.createElement(pe,{path:"/logout"}),j.a.createElement(Ue,{path:"/settings/*"}),j.a.createElement(zt,{path:"/users/*"}),j.a.createElement(Wt,{path:"/roles/*"}),j.a.createElement(Un,{path:"/hotels/*"}),j.a.createElement(Ca,{path:"/meal-plans/*"}),j.a.createElement(La,{path:"/room-types/*"}),j.a.createElement(gn,{path:"/locations/*"}),j.a.createElement(nr,{path:"/cab-types/*"}),j.a.createElement(Sr,{path:"/cabs/*"}),j.a.createElement(vl,{path:"/trips/*"}),j.a.createElement(pl,{path:"/trip-sources/*"}),j.a.createElement(ql,{path:"/trip-stages/*"}),j.a.createElement(jc,{path:"/transport-services/*"}),j.a.createElement(Pc,{path:"/transport-service-prices/*"}),j.a.createElement(An,{path:"/hotel-payment-preferences/*"}),j.a.createElement(Gr,{path:"/hotel-booking-stages/*"}),j.a.createElement(Jl,{path:"/trip-plan-requests/*"}),j.a.createElement(zl,{path:"email-verified"}),j.a.createElement(Ie,{default:!0}))),j.a.createElement(Zl,null))},null)))));T.a.render(ri,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[149,1,2]]]);
//# sourceMappingURL=main.ae2366e8.chunk.js.map